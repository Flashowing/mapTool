(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~cc32c0a8"],{1331:function(t,e,i){"use strict";var a=i("77af"),n=i("2f63"),s=i("7d62"),o=i("e42d"),r=i("ac3b"),c=i("6ef5"),h=i("6dc0"),l=i("6c84"),u=i("a913"),_=i("3664");function d(){this._colorTexture=void 0,this._drawCommand=void 0}function f(t,e,i){const n=e.createViewportQuadCommand(_["a"],{framebuffer:i,renderState:h["a"].fromCache({viewport:new a["a"](0,0,256,256)})});t._drawCommand=n}Object.defineProperties(d.prototype,{colorTexture:{get:function(){return this._colorTexture}}}),d.prototype.update=function(t){if(!Object(n["a"])(this._colorTexture)){const e=t.context,i=new u["a"]({context:e,width:256,height:256,pixelFormat:o["a"].RGBA,pixelDatatype:c["a"].UNSIGNED_BYTE,sampler:l["a"].NEAREST});this._colorTexture=i;const a=new r["a"]({context:e,colorTextures:[i],destroyAttachments:!1});f(this,e,a),this._drawCommand.execute(e),a.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),Object(s["a"])(this)},e["a"]=d},"141c":function(t,e,i){"use strict";const a={OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};e["a"]=Object.freeze(a)},"1e82":function(t,e,i){"use strict";const a={AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",AERIAL_WITH_LABELS_ON_DEMAND:"AerialWithLabelsOnDemand",ROAD:"Road",ROAD_ON_DEMAND:"RoadOnDemand",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"};e["a"]=Object.freeze(a)},"2cc3":function(t,e,i){"use strict";var a=i("670c"),n=i("be18"),s=i("a561"),o=i("2bb9"),r=i("abab"),c=i("2f63"),h=i("7d62"),l=i("e42d"),u=i("b997"),_=i("6ef5"),d=i("6c84"),f=i("a913");function p(t,e,i){if(this._attributes=e,this._numberOfInstances=i,0===e.length)return;const n=b(e),o=t.floatingPointTexture,r=n===_["a"].FLOAT&&!o,c=g(e,r),h=y(c,e,r),l=Math.floor(u["a"].maximumTextureSize/h),d=Math.min(i,l),f=h*d,p=Math.ceil(i/d),m=1/f,O=.5*m,T=1/p,A=.5*T;this._textureDimensions=new a["a"](f,p),this._textureStep=new s["a"](m,O,T,A),this._pixelDatatype=r?_["a"].UNSIGNED_BYTE:n,this._packFloats=r,this._offsets=c,this._stride=h,this._texture=void 0;const x=4*f*p;this._batchValues=n!==_["a"].FLOAT||r?new Uint8Array(x):new Float32Array(x),this._batchValuesDirty=!1}function b(t){let e=!1;const i=t.length;for(let a=0;a<i;++a)if(t[a].componentDatatype!==r["a"].UNSIGNED_BYTE){e=!0;break}return e?_["a"].FLOAT:_["a"].UNSIGNED_BYTE}function m(t,e){const i=t[e].componentsPerAttribute;return 2===i?a["a"]:3===i?n["a"]:4===i?s["a"]:Number}function g(t,e){const i=new Array(t.length);let a=0;const n=t.length;for(let s=0;s<n;++s){const n=t[s],o=n.componentDatatype;i[s]=a,o!==r["a"].UNSIGNED_BYTE&&e?a+=4:++a}return i}function y(t,e,i){const a=t.length,n=t[a-1],s=e[a-1],o=s.componentDatatype;return o!==r["a"].UNSIGNED_BYTE&&i?n+4:n+1}Object.defineProperties(p.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});const O=new s["a"];function T(t,e,i){let a=s["a"].unpack(t,e,O);const n=s["a"].unpackFloat(a);a=s["a"].unpack(t,e+4,O);const o=s["a"].unpackFloat(a);a=s["a"].unpack(t,e+8,O);const r=s["a"].unpackFloat(a);a=s["a"].unpack(t,e+12,O);const c=s["a"].unpackFloat(a);return s["a"].fromElements(n,o,r,c,i)}function A(t,e,i){let a=s["a"].packFloat(t.x,O);s["a"].pack(a,e,i),a=s["a"].packFloat(t.y,a),s["a"].pack(a,e,i+4),a=s["a"].packFloat(t.z,a),s["a"].pack(a,e,i+8),a=s["a"].packFloat(t.w,a),s["a"].pack(a,e,i+12)}const x=new s["a"];p.prototype.getBatchedAttribute=function(t,e,i){const a=this._attributes,n=this._offsets[e],o=this._stride,r=4*o*t+4*n;let h;h=this._packFloats&&a[e].componentDatatype!==_["a"].UNSIGNED_BYTE?T(this._batchValues,r,x):s["a"].unpack(this._batchValues,r,x);const l=m(a,e);return Object(c["a"])(l.fromCartesian4)?l.fromCartesian4(h,i):Object(c["a"])(l.clone)?l.clone(h,i):h.x};const D=[void 0,void 0,new a["a"],new n["a"],new s["a"]],S=new s["a"];function C(t,e){const i=t._textureDimensions;t._texture=new f["a"]({context:e,pixelFormat:l["a"].RGBA,pixelDatatype:t._pixelDatatype,width:i.x,height:i.y,sampler:d["a"].NEAREST,flipY:!1})}function E(t){const e=t._textureDimensions;t._texture.copyFrom({source:{width:e.x,height:e.y,arrayBufferView:t._batchValues}})}function I(t){const e=t._stride;return 1===t._textureDimensions.y?`uniform vec4 batchTextureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float numberOfAttributes = float(${e}); \n    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n} \n`:`uniform vec4 batchTextureStep; \nuniform vec2 batchTextureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float stepY = batchTextureStep.z; \n    float centerY = batchTextureStep.w; \n    float numberOfAttributes = float(${e}); \n    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); \n} \n`}function N(t){return 1===t?"float":"vec"+t}function v(t){return 1===t?".x":2===t?".xy":3===t?".xyz":""}function L(t,e){const i=t._attributes,a=i[e],n=a.componentsPerAttribute,s=a.functionName,o=N(n),c=v(n),h=t._offsets[e];let l=`${o} ${s}(float batchId) \n{ \n    vec2 st = computeSt(batchId); \n    st.x += batchTextureStep.x * float(${h}); \n`;return t._packFloats&&a.componentDatatype!==_["a"].UNSIGNED_BYTE?l+="vec4 textureValue; \ntextureValue.x = czm_unpackFloat(texture2D(batchTexture, st)); \ntextureValue.y = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); \ntextureValue.z = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); \ntextureValue.w = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); \n":l+="    vec4 textureValue = texture2D(batchTexture, st); \n",l+=`    ${o} value = textureValue${c}; \n`,t._pixelDatatype!==_["a"].UNSIGNED_BYTE||a.componentDatatype!==r["a"].UNSIGNED_BYTE||a.normalize?t._pixelDatatype===_["a"].FLOAT&&a.componentDatatype===r["a"].UNSIGNED_BYTE&&a.normalize&&(l+="value /= 255.0; \n"):l+="value *= 255.0; \n",l+="    return value; \n} \n",l}p.prototype.setBatchedAttribute=function(t,e,i){const a=this._attributes,n=D[a[e].componentsPerAttribute],o=this.getBatchedAttribute(t,e,n),r=m(this._attributes,e),h=Object(c["a"])(r.equals)?r.equals(o,i):o===i;if(h)return;const l=S;l.x=Object(c["a"])(i.x)?i.x:i,l.y=Object(c["a"])(i.y)?i.y:0,l.z=Object(c["a"])(i.z)?i.z:0,l.w=Object(c["a"])(i.w)?i.w:0;const u=this._offsets[e],d=this._stride,f=4*d*t+4*u;this._packFloats&&a[e].componentDatatype!==_["a"].UNSIGNED_BYTE?A(l,this._batchValues,f):s["a"].pack(l,this._batchValues,f),this._batchValuesDirty=!0},p.prototype.update=function(t){Object(c["a"])(this._texture)&&!this._batchValuesDirty||0===this._attributes.length||(this._batchValuesDirty=!1,Object(c["a"])(this._texture)||C(this,t.context),E(this))},p.prototype.getUniformMapCallback=function(){const t=this;return function(e){if(0===t._attributes.length)return e;const i={batchTexture:function(){return t._texture},batchTextureDimensions:function(){return t._textureDimensions},batchTextureStep:function(){return t._textureStep}};return Object(o["a"])(e,i)}},p.prototype.getVertexShaderCallback=function(){const t=this._attributes;if(0===t.length)return function(t){return t};let e="uniform highp sampler2D batchTexture; \n";e+=I(this)+"\n";const i=t.length;for(let a=0;a<i;++a)e+=L(this,a);return function(t){const i=t.indexOf("void main"),a=t.substring(0,i),n=t.substring(i);return`${a}\n${e}\n${n}`}},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),Object(h["a"])(this)},e["a"]=p},"30d2":function(t,e,i){"use strict";var a=i("daa2");const n={ZERO:a["a"].ZERO,ONE:a["a"].ONE,SOURCE_COLOR:a["a"].SRC_COLOR,ONE_MINUS_SOURCE_COLOR:a["a"].ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:a["a"].DST_COLOR,ONE_MINUS_DESTINATION_COLOR:a["a"].ONE_MINUS_DST_COLOR,SOURCE_ALPHA:a["a"].SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:a["a"].ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:a["a"].DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:a["a"].ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:a["a"].CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:a["a"].ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:a["a"].CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:a["a"].ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:a["a"].SRC_ALPHA_SATURATE};e["a"]=Object.freeze(n)},"3e44":function(t,e,i){"use strict";var a=i("77af"),n=i("670c"),s=i("be18"),o=i("a561"),r=i("bef8"),c=i("bd8d"),h=i("71ce"),l=i("535a"),u=i("2f63"),_=i("aee6"),d=i("52f0"),f=i("6dfc"),p=i("d4ed"),b=i("2d75"),m=i("f61d"),g=i("a307"),y=i("0c80"),O=i("05e5");function T(t,e){t=Object(l["a"])(t,l["a"].EMPTY_OBJECT);let i=t.translucencyByDistance,a=t.pixelOffsetScaleByDistance,o=t.scaleByDistance,r=t.distanceDisplayCondition;Object(u["a"])(i)&&(i=f["a"].clone(i)),Object(u["a"])(a)&&(a=f["a"].clone(a)),Object(u["a"])(o)&&(o=f["a"].clone(o)),Object(u["a"])(r)&&(r=_["a"].clone(r)),this._show=Object(l["a"])(t.show,!0),this._position=s["a"].clone(Object(l["a"])(t.position,s["a"].ZERO)),this._actualPosition=s["a"].clone(this._position),this._pixelOffset=n["a"].clone(Object(l["a"])(t.pixelOffset,n["a"].ZERO)),this._translate=new n["a"](0,0),this._eyeOffset=s["a"].clone(Object(l["a"])(t.eyeOffset,s["a"].ZERO)),this._heightReference=Object(l["a"])(t.heightReference,b["a"].NONE),this._verticalOrigin=Object(l["a"])(t.verticalOrigin,O["a"].CENTER),this._horizontalOrigin=Object(l["a"])(t.horizontalOrigin,m["a"].CENTER),this._scale=Object(l["a"])(t.scale,1),this._color=c["a"].clone(Object(l["a"])(t.color,c["a"].WHITE)),this._rotation=Object(l["a"])(t.rotation,0),this._alignedAxis=s["a"].clone(Object(l["a"])(t.alignedAxis,s["a"].ZERO)),this._width=t.width,this._height=t.height,this._scaleByDistance=o,this._translucencyByDistance=i,this._pixelOffsetScaleByDistance=a,this._sizeInMeters=Object(l["a"])(t.sizeInMeters,!1),this._distanceDisplayCondition=r,this._disableDepthTestDistance=t.disableDepthTestDistance,this._id=t.id,this._collection=Object(l["a"])(t.collection,e),this._pickId=void 0,this._pickPrimitive=Object(l["a"])(t._pickPrimitive,this),this._billboardCollection=e,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0;const d=t.image;let p=t.imageId;Object(u["a"])(d)&&(Object(u["a"])(p)||(p="string"===typeof d?d:Object(u["a"])(d.src)?d.src:Object(h["a"])()),this._imageId=p,this._image=d),Object(u["a"])(t.imageSubRegion)&&(this._imageId=p,this._imageSubRegion=t.imageSubRegion),Object(u["a"])(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=g["a"].SCENE3D,this._clusterShow=!0,this._outlineColor=c["a"].clone(Object(l["a"])(t.outlineColor,c["a"].BLACK)),this._outlineWidth=Object(l["a"])(t.outlineWidth,0),this._updateClamping()}const A=T.SHOW_INDEX=0,x=T.POSITION_INDEX=1,D=T.PIXEL_OFFSET_INDEX=2,S=T.EYE_OFFSET_INDEX=3,C=T.HORIZONTAL_ORIGIN_INDEX=4,E=T.VERTICAL_ORIGIN_INDEX=5,I=T.SCALE_INDEX=6,N=T.IMAGE_INDEX_INDEX=7,v=T.COLOR_INDEX=8,L=T.ROTATION_INDEX=9,j=T.ALIGNED_AXIS_INDEX=10,P=T.SCALE_BY_DISTANCE_INDEX=11,B=T.TRANSLUCENCY_BY_DISTANCE_INDEX=12,R=T.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,w=T.DISTANCE_DISPLAY_CONDITION=14,U=T.DISABLE_DEPTH_DISTANCE=15;T.TEXTURE_COORDINATE_BOUNDS=16;const M=T.SDF_INDEX=17;function k(t,e){const i=t._billboardCollection;Object(u["a"])(i)&&(i._updateBillboard(t,e),t._dirty=!0)}T.NUMBER_OF_PROPERTIES=18,Object.defineProperties(T.prototype,{show:{get:function(){return this._show},set:function(t){this._show!==t&&(this._show=t,k(this,A))}},position:{get:function(){return this._position},set:function(t){const e=this._position;s["a"].equals(e,t)||(s["a"].clone(t,e),s["a"].clone(t,this._actualPosition),this._updateClamping(),k(this,x))}},heightReference:{get:function(){return this._heightReference},set:function(t){const e=this._heightReference;t!==e&&(this._heightReference=t,this._updateClamping(),k(this,x))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(t){const e=this._pixelOffset;n["a"].equals(e,t)||(n["a"].clone(t,e),k(this,D))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(t){const e=this._scaleByDistance;f["a"].equals(e,t)||(this._scaleByDistance=f["a"].clone(t,e),k(this,P))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(t){const e=this._translucencyByDistance;f["a"].equals(e,t)||(this._translucencyByDistance=f["a"].clone(t,e),k(this,B))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(t){const e=this._pixelOffsetScaleByDistance;f["a"].equals(e,t)||(this._pixelOffsetScaleByDistance=f["a"].clone(t,e),k(this,R))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(t){const e=this._eyeOffset;s["a"].equals(e,t)||(s["a"].clone(t,e),k(this,S))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(t){this._horizontalOrigin!==t&&(this._horizontalOrigin=t,k(this,C))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(t){this._verticalOrigin!==t&&(this._verticalOrigin=t,k(this,E))}},scale:{get:function(){return this._scale},set:function(t){this._scale!==t&&(this._scale=t,k(this,I))}},color:{get:function(){return this._color},set:function(t){const e=this._color;c["a"].equals(e,t)||(c["a"].clone(t,e),k(this,v))}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,k(this,L))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(t){const e=this._alignedAxis;s["a"].equals(e,t)||(s["a"].clone(t,e),k(this,j))}},width:{get:function(){return Object(l["a"])(this._width,this._imageWidth)},set:function(t){this._width!==t&&(this._width=t,k(this,N))}},height:{get:function(){return Object(l["a"])(this._height,this._imageHeight)},set:function(t){this._height!==t&&(this._height=t,k(this,N))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(t){this._sizeInMeters!==t&&(this._sizeInMeters=t,k(this,v))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){_["a"].equals(t,this._distanceDisplayCondition)||(this._distanceDisplayCondition=_["a"].clone(t,this._distanceDisplayCondition),k(this,w))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(t){this._disableDepthTestDistance!==t&&(this._disableDepthTestDistance=t,k(this,U))}},id:{get:function(){return this._id},set:function(t){this._id=t,Object(u["a"])(this._pickId)&&(this._pickId.object.id=t)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(t){this._pickPrimitive=t,Object(u["a"])(this._pickId)&&(this._pickId.object.primitive=t)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(t){Object(u["a"])(t)?"string"===typeof t?this.setImage(t,t):t instanceof p["a"]?this.setImage(t.url,t):Object(u["a"])(t.src)?this.setImage(t.src,t):this.setImage(Object(h["a"])(),t):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,k(this,N))}},ready:{get:function(){return-1!==this._imageIndex}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(t){this._actualClampedPosition=s["a"].clone(t,this._actualClampedPosition),k(this,x)}},clusterShow:{get:function(){return this._clusterShow},set:function(t){this._clusterShow!==t&&(this._clusterShow=t,k(this,A))}},outlineColor:{get:function(){return this._outlineColor},set:function(t){const e=this._outlineColor;c["a"].equals(e,t)||(c["a"].clone(t,e),k(this,M))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,k(this,M))}}}),T.prototype.getPickId=function(t){return Object(u["a"])(this._pickId)||(this._pickId=t.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId},T.prototype._updateClamping=function(){T._updateClamping(this._billboardCollection,this)};const F=new r["a"],V=new s["a"];T._updateClamping=function(t,e){const i=t._scene;if(!Object(u["a"])(i)||!Object(u["a"])(i.globe))return;const a=i.globe,n=a.ellipsoid,o=a._surface,c=i.frameState.mode,h=c!==e._mode;if(e._mode=c,(e._heightReference===b["a"].NONE||h)&&Object(u["a"])(e._removeCallbackFunc)&&(e._removeCallbackFunc(),e._removeCallbackFunc=void 0,e._clampedPosition=void 0),e._heightReference===b["a"].NONE||!Object(u["a"])(e._position))return;const l=n.cartesianToCartographic(e._position);if(!Object(u["a"])(l))return void(e._actualClampedPosition=void 0);function _(t){if(e._heightReference===b["a"].RELATIVE_TO_GROUND)if(e._mode===g["a"].SCENE3D){const e=n.cartesianToCartographic(t,F);e.height+=l.height,n.cartographicToCartesian(e,t)}else t.x+=l.height;e._clampedPosition=s["a"].clone(t,e._clampedPosition)}Object(u["a"])(e._removeCallbackFunc)&&e._removeCallbackFunc(),e._removeCallbackFunc=o.updateHeight(l,_),r["a"].clone(l,F);const d=a.getHeight(l);Object(u["a"])(d)&&(F.height=d),n.cartographicToCartesian(F,V),_(V)},T.prototype._loadImage=function(){const t=this._billboardCollection._textureAtlas,e=this._imageId,i=this._image,n=this._imageSubRegion;let s;const o=this;function r(s){if(o._imageId!==e||o._image!==i||!a["a"].equals(o._imageSubRegion,n))return;const r=t.textureCoordinates[s];o._imageWidth=t.texture.width*r.width,o._imageHeight=t.texture.height*r.height,o._imageIndex=s,o._ready=!0,o._image=void 0,o._imageIndexPromise=void 0,k(o,N)}if(Object(u["a"])(i)){const a=t.getImageIndex(e);if(Object(u["a"])(a))return void r(a);s=t.addImage(e,i)}Object(u["a"])(n)&&(s=t.addSubRegion(e,n)),this._imageIndexPromise=s,Object(u["a"])(s)&&s.then(r).catch((function(t){console.error("Error loading image for billboard: "+t),o._imageIndexPromise=void 0}))},T.prototype.setImage=function(t,e){this._imageId!==t&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=t,this._image=e,Object(u["a"])(this._billboardCollection._textureAtlas)&&this._loadImage())},T.prototype.setImageSubRegion=function(t,e){this._imageId===t&&a["a"].equals(this._imageSubRegion,e)||(this._imageIndex=-1,this._imageId=t,this._imageSubRegion=a["a"].clone(e),Object(u["a"])(this._billboardCollection._textureAtlas)&&this._loadImage())},T.prototype._setTranslate=function(t){const e=this._translate;n["a"].equals(e,t)||(n["a"].clone(t,e),k(this,D))},T.prototype._getActualPosition=function(){return Object(u["a"])(this._clampedPosition)?this._clampedPosition:this._actualPosition},T.prototype._setActualPosition=function(t){Object(u["a"])(this._clampedPosition)||s["a"].clone(t,this._actualPosition),k(this,x)};const H=new o["a"];T._computeActualPosition=function(t,e,i,a){return Object(u["a"])(t._clampedPosition)?(i.mode!==t._mode&&t._updateClamping(),t._clampedPosition):i.mode===g["a"].SCENE3D?e:(d["a"].multiplyByPoint(a,e,H),y["a"].computeActualWgs84Position(i,H))};const z=new s["a"];T._computeScreenSpacePosition=function(t,e,i,a,s,o){const r=d["a"].multiplyByPoint(t,e,z),c=y["a"].wgs84WithEyeOffsetToWindowCoordinates(s,r,i,o);if(Object(u["a"])(c))return n["a"].add(c,a,c),c};const G=new n["a"](0,0);T.prototype.computeScreenSpacePosition=function(t,e){const i=this._billboardCollection;Object(u["a"])(e)||(e=new n["a"]),n["a"].clone(this._pixelOffset,G),n["a"].add(G,this._translate,G);let a=i.modelMatrix,s=this._position;if(Object(u["a"])(this._clampedPosition)&&(s=this._clampedPosition,t.mode!==g["a"].SCENE3D)){const e=t.mapProjection,i=e.ellipsoid,n=e.unproject(s,F);s=i.cartographicToCartesian(n,z),a=d["a"].IDENTITY}const o=T._computeScreenSpacePosition(a,s,this._eyeOffset,G,t,e);return o},T.getScreenSpaceBoundingBox=function(t,e,i){let n=t.width,s=t.height;const o=t.scale;n*=o,s*=o;let r=e.x;t.horizontalOrigin===m["a"].RIGHT?r-=n:t.horizontalOrigin===m["a"].CENTER&&(r-=.5*n);let c=e.y;return t.verticalOrigin===O["a"].BOTTOM||t.verticalOrigin===O["a"].BASELINE?c-=s:t.verticalOrigin===O["a"].CENTER&&(c-=.5*s),Object(u["a"])(i)||(i=new a["a"]),i.x=r,i.y=c,i.width=n,i.height=s,i},T.prototype.equals=function(t){return this===t||Object(u["a"])(t)&&this._id===t._id&&s["a"].equals(this._position,t._position)&&this._imageId===t._imageId&&this._show===t._show&&this._scale===t._scale&&this._verticalOrigin===t._verticalOrigin&&this._horizontalOrigin===t._horizontalOrigin&&this._heightReference===t._heightReference&&a["a"].equals(this._imageSubRegion,t._imageSubRegion)&&c["a"].equals(this._color,t._color)&&n["a"].equals(this._pixelOffset,t._pixelOffset)&&n["a"].equals(this._translate,t._translate)&&s["a"].equals(this._eyeOffset,t._eyeOffset)&&f["a"].equals(this._scaleByDistance,t._scaleByDistance)&&f["a"].equals(this._translucencyByDistance,t._translucencyByDistance)&&f["a"].equals(this._pixelOffsetScaleByDistance,t._pixelOffsetScaleByDistance)&&_["a"].equals(this._distanceDisplayCondition,t._distanceDisplayCondition)&&this._disableDepthTestDistance===t._disableDepthTestDistance},T.prototype._destroy=function(){Object(u["a"])(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),Object(u["a"])(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0},e["a"]=T},"420f":function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var a=i("2c34"),n=i("670c"),s=i("a561"),o=i("bd8d"),r=i("2f63"),c=i("7d62"),h=(i("4f04"),i("e42d")),l=i("b997"),u=i("6ef5"),_=i("6c84"),d=i("a913");function f(t){const e=t.featuresLength;let i,a;if(this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[],e>0){const t=Math.min(e,l["a"].maximumTextureSize),o=Math.ceil(e/l["a"].maximumTextureSize),r=1/t,c=.5*r,h=1/o,u=.5*h;i=new n["a"](t,o),a=new s["a"](r,c,h,u)}this._translucentFeaturesLength=0,this._featuresLength=e,this._textureDimensions=i,this._textureStep=a,this._owner=t.owner,this._statistics=t.statistics,this._colorChangedCallback=t.colorChangedCallback}function p(t){const e=t._textureDimensions;return e.x*e.y*4}function b(t){if(!Object(r["a"])(t._batchValues)){const e=p(t),i=new Uint8Array(e);Object(a["a"])(i,255),t._batchValues=i}return t._batchValues}function m(t){if(!Object(r["a"])(t._showAlphaProperties)){const e=2*t._featuresLength,i=new Uint8Array(e);Object(a["a"])(i,255),t._showAlphaProperties=i}return t._showAlphaProperties}Object.defineProperties(f.prototype,{translucentFeaturesLength:{get:function(){return this._translucentFeaturesLength}},memorySizeInBytes:{get:function(){let t=0;return Object(r["a"])(this._pickTexture)&&(t+=this._pickTexture.sizeInBytes),Object(r["a"])(this._batchTexture)&&(t+=this._batchTexture.sizeInBytes),t}},textureDimensions:{get:function(){return this._textureDimensions}},textureStep:{get:function(){return this._textureStep}},batchTexture:{get:function(){return this._batchTexture}},defaultTexture:{get:function(){return this._defaultTexture}},pickTexture:{get:function(){return this._pickTexture}}}),f.DEFAULT_COLOR_VALUE=o["a"].WHITE,f.DEFAULT_SHOW_VALUE=!0,f.prototype.setShow=function(t,e){if(e&&!Object(r["a"])(this._showAlphaProperties))return;const i=m(this),a=2*t,n=e?255:0;if(i[a]!==n){i[a]=n;const s=b(this),o=4*t+3;s[o]=e?i[a+1]:0,this._batchValuesDirty=!0}},f.prototype.setAllShow=function(t){const e=this._featuresLength;for(let i=0;i<e;++i)this.setShow(i,t)},f.prototype.getShow=function(t){if(!Object(r["a"])(this._showAlphaProperties))return!0;const e=2*t;return 255===this._showAlphaProperties[e]};const g=new Array(4);function y(t,e,i){const a=t._textureDimensions;return new d["a"]({context:e,pixelFormat:h["a"].RGBA,pixelDatatype:u["a"].UNSIGNED_BYTE,source:{width:a.x,height:a.y,arrayBufferView:i},flipY:!1,sampler:_["a"].NEAREST})}function O(t,e){const i=t._featuresLength;if(!Object(r["a"])(t._pickTexture)&&i>0){const a=t._pickIds,n=p(t),s=new Uint8Array(n),c=t._owner,h=t._statistics;for(let t=0;t<i;++t){const i=e.createPickId(c.getFeature(t));a.push(i);const n=i.color,r=4*t;s[r]=o["a"].floatToByte(n.red),s[r+1]=o["a"].floatToByte(n.green),s[r+2]=o["a"].floatToByte(n.blue),s[r+3]=o["a"].floatToByte(n.alpha)}t._pickTexture=y(t,e,s),Object(r["a"])(h)&&(h.batchTableByteLength+=t._pickTexture.sizeInBytes)}}function T(t){const e=t._textureDimensions;t._batchTexture.copyFrom({source:{width:e.x,height:e.y,arrayBufferView:t._batchValues}})}f.prototype.setColor=function(t,e){if(o["a"].equals(e,f.DEFAULT_COLOR_VALUE)&&!Object(r["a"])(this._batchValues))return;const i=e.toBytes(g),a=i[3],n=b(this),s=4*t,c=m(this),h=2*t;if(n[s]!==i[0]||n[s+1]!==i[1]||n[s+2]!==i[2]||c[h+1]!==a){n[s]=i[0],n[s+1]=i[1],n[s+2]=i[2];const o=255!==c[h+1],l=0!==c[h];n[s+3]=l?a:0,c[h+1]=a;const u=255!==a;u&&!o?++this._translucentFeaturesLength:!u&&o&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,Object(r["a"])(this._colorChangedCallback)&&this._colorChangedCallback(t,e)}},f.prototype.setAllColor=function(t){const e=this._featuresLength;for(let i=0;i<e;++i)this.setColor(i,t)},f.prototype.getColor=function(t,e){if(!Object(r["a"])(this._batchValues))return o["a"].clone(f.DEFAULT_COLOR_VALUE,e);const i=this._batchValues,a=4*t,n=this._showAlphaProperties,s=2*t;return o["a"].fromBytes(i[a],i[a+1],i[a+2],n[s+1],e)},f.prototype.getPickColor=function(t){return this._pickIds[t]},f.prototype.update=function(t,e){const i=e.context;this._defaultTexture=i.defaultTexture;const a=e.passes;(a.pick||a.postProcess)&&O(this,i),this._batchValuesDirty&&(this._batchValuesDirty=!1,Object(r["a"])(this._batchTexture)||(this._batchTexture=y(this,i,this._batchValues),Object(r["a"])(this._statistics)&&(this._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes)),T(this))},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();const t=this._pickIds,e=t.length;for(let i=0;i<e;++i)t[i].destroy();return Object(c["a"])(this)}},5679:function(t,e,i){"use strict";var a=i("535a"),n=i("45c5"),s=i("e856"),o=i("283e");const r={};r._deprecationWarning=n["a"];const c=Uint32Array.BYTES_PER_ELEMENT;r.parse=function(t,e){const i=Object(a["a"])(e,0);e=i;const n=new Uint8Array(t),h=new DataView(t);e+=c;const l=h.getUint32(e,!0);if(1!==l)throw new o["a"](`Only Batched 3D Model version 1 is supported.  Version ${l} is not.`);e+=c;const u=h.getUint32(e,!0);e+=c;let _=h.getUint32(e,!0);e+=c;let d=h.getUint32(e,!0);e+=c;let f=h.getUint32(e,!0);e+=c;let p,b,m=h.getUint32(e,!0);e+=c,f>=570425344?(e-=2*c,p=_,f=d,m=0,_=0,d=0,r._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.")):m>=570425344&&(e-=c,p=f,f=_,m=d,_=0,d=0,r._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.")),0===_?b={BATCH_LENGTH:Object(a["a"])(p,0)}:(b=Object(s["a"])(n,e,_),e+=_);const g=new Uint8Array(t,e,d);let y,O;e+=d,f>0&&(y=Object(s["a"])(n,e,f),e+=f,m>0&&(O=new Uint8Array(t,e,m),O=new Uint8Array(O),e+=m));const T=i+u-e;if(0===T)throw new o["a"]("glTF byte length must be greater than 0.");let A;return e%4===0?A=new Uint8Array(t,e,T):(r._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),A=new Uint8Array(n.subarray(e,e+T))),{batchLength:p,featureTableJson:b,featureTableBinary:g,batchTableJson:y,batchTableBinary:O,gltf:A}},e["a"]=r},"5d9a":function(t,e,i){"use strict";var a=i("be18"),n=i("535a"),s=i("93da");const o=new a["a"](1,1,1);function r(t){t=Object(n["a"])(t,o),this._dimensions=a["a"].clone(t)}Object.defineProperties(r.prototype,{dimensions:{get:function(){return this._dimensions},set:function(t){a["a"].clone(t,this._dimensions)}}});const c=new a["a"];r.prototype.emit=function(t){const e=this._dimensions,i=a["a"].multiplyByScalar(e,.5,c),n=s["a"].randomBetween(-i.x,i.x),o=s["a"].randomBetween(-i.y,i.y),r=s["a"].randomBetween(-i.z,i.z);t.position=a["a"].fromElements(n,o,r,t.position),t.velocity=a["a"].normalize(t.position,t.velocity)},e["a"]=r},"61aa":function(t,e,i){"use strict";var a=i("be18"),n=i("bd8d"),s=i("abab"),o=i("2f63"),r=i("45c5"),c=i("7d62"),h=i("52f0"),l=i("b82e"),u=i("d289"),_=i("b08e"),d=i("5679"),f=i("6596"),p=i("5af0"),b=i("9889"),m=i("b80d"),g=i("ce35"),y=i("8a9e"),O=i("e349");function T(t,e,i,a,n){this._tileset=t,this._tile=e,this._resource=i,this._model=void 0,this._batchTable=void 0,this._features=void 0,this._classificationType=t.vectorClassificationOnly?void 0:t.classificationType,this._metadata=void 0,this._batchIdAttributeName=void 0,this._diffuseAttributeOrUniformName={},this._rtcCenterTransform=void 0,this._contentModelMatrix=void 0,this.featurePropertiesDirty=!1,this._group=void 0,I(this,a,n)}function A(t){let e=O["a"].getAttributeOrUniformBySemantic(t,"_BATCHID");return Object(o["a"])(e)||(e=O["a"].getAttributeOrUniformBySemantic(t,"BATCHID"),Object(o["a"])(e)&&T._deprecationWarning("b3dm-legacy-batchid","The glTF in this b3dm uses the semantic `BATCHID`. Application-specific semantics should be prefixed with an underscore: `_BATCHID`.")),e}function x(t){return function(e,i){const a=t._batchTable,n=!Object(o["a"])(t._classificationType),s=t._model.gltf;Object(o["a"])(s)&&(t._batchIdAttributeName=A(s),t._diffuseAttributeOrUniformName[i]=O["a"].getDiffuseAttributeOrUniform(s,i));const r=a.getVertexShaderCallback(n,t._batchIdAttributeName,t._diffuseAttributeOrUniformName[i]);return Object(o["a"])(r)?r(e):e}}function D(t){return function(e,i){const a=t._batchTable,n=!Object(o["a"])(t._classificationType),s=t._model.gltf;Object(o["a"])(s)&&(t._diffuseAttributeOrUniformName[i]=O["a"].getDiffuseAttributeOrUniform(s,i));const r=a.getFragmentShaderCallback(n,t._diffuseAttributeOrUniformName[i],!1);return Object(o["a"])(r)?r(e):e}}function S(t){return function(){return t._batchTable.getPickId()}}function C(t){return function(e){const i=t._batchTable,a=i.getClassificationFragmentShaderCallback();return Object(o["a"])(a)?a(e):e}}function E(t){return function(e,i){t._model.updateCommands(e,i)}}function I(t,e,i){const n=t._tileset,r=t._tile,c=t._resource,p=d["a"].parse(e,i);let O=p.batchLength;const T=p.featureTableJson,A=p.featureTableBinary,I=new b["a"](T,A);O=I.getGlobalProperty("BATCH_LENGTH"),I.featuresLength=O;const N=p.batchTableJson,v=p.batchTableBinary;let L;Object(o["a"])(t._classificationType)&&(L=E(t));const j=new f["a"](t,O,N,v,L);t._batchTable=j;const P=p.gltf,B={content:t,primitive:n};t._rtcCenterTransform=h["a"].IDENTITY;const R=I.getGlobalProperty("RTC_CENTER",s["a"].FLOAT,3);Object(o["a"])(R)&&(t._rtcCenterTransform=h["a"].fromTranslation(a["a"].fromArray(R))),t._contentModelMatrix=h["a"].multiply(r.computedTransform,t._rtcCenterTransform,new h["a"]),Object(o["a"])(t._classificationType)?t._model=new m["a"]({gltf:P,cull:!1,basePath:c,requestType:l["a"].TILES3D,modelMatrix:t._contentModelMatrix,upAxis:n._gltfUpAxis,forwardAxis:_["a"].X,debugWireframe:n.debugWireframe,vertexShaderLoaded:x(t),classificationShaderLoaded:C(t),uniformMapLoaded:j.getUniformMapCallback(),pickIdLoaded:S(t),classificationType:t._classificationType,batchTable:j}):(t._model=new g["a"]({gltf:P,cull:!1,releaseGltfJson:!0,opaquePass:u["a"].CESIUM_3D_TILE,basePath:c,requestType:l["a"].TILES3D,modelMatrix:t._contentModelMatrix,upAxis:n._gltfUpAxis,forwardAxis:_["a"].X,shadows:n.shadows,debugWireframe:n.debugWireframe,incrementallyLoadTextures:!1,vertexShaderLoaded:x(t),fragmentShaderLoaded:D(t),uniformMapLoaded:j.getUniformMapCallback(),pickIdLoaded:S(t),addBatchIdToGeneratedShaders:O>0,pickObject:B,lightColor:n.lightColor,imageBasedLighting:n.imageBasedLighting,backFaceCulling:n.backFaceCulling,showOutline:n.showOutline,showCreditsOnScreen:n.showCreditsOnScreen}),t._model.readyPromise.then((function(t){t.activeAnimations.addAll({loop:y["a"].REPEAT})})))}function N(t){const e=t.featuresLength;if(!Object(o["a"])(t._features)&&e>0){const i=new Array(e);for(let a=0;a<e;++a)i[a]=new p["a"](t,a);t._features=i}}T._deprecationWarning=r["a"],Object.defineProperties(T.prototype,{featuresLength:{get:function(){return this.batchTable.featuresLength}},pointsLength:{get:function(){return this._model.pointsLength}},trianglesLength:{get:function(){return this._model.trianglesLength}},geometryByteLength:{get:function(){return this._model.geometryByteLength}},texturesByteLength:{get:function(){return this._model.texturesByteLength}},batchTableByteLength:{get:function(){return this.batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(t){this._metadata=t}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(t){this._group=t}}}),T.prototype.hasProperty=function(t,e){return this._batchTable.hasProperty(t,e)},T.prototype.getFeature=function(t){return N(this),this._features[t]},T.prototype.applyDebugSettings=function(t,e){e=t?e:n["a"].WHITE,0===this.featuresLength?this._model.color=e:this._batchTable.setAllColor(e)},T.prototype.applyStyle=function(t){if(0===this.featuresLength){const e=Object(o["a"])(t)&&Object(o["a"])(t.color),i=Object(o["a"])(t)&&Object(o["a"])(t.show);this._model.color=e?t.color.evaluateColor(void 0,this._model.color):n["a"].clone(n["a"].WHITE,this._model.color),this._model.show=!i||t.show.evaluate(void 0)}else this._batchTable.applyStyle(t)},T.prototype.update=function(t,e){const i=e.commandList.length,a=this._model,n=this._tile,s=this._batchTable;s.update(t,e),this._contentModelMatrix=h["a"].multiply(n.computedTransform,this._rtcCenterTransform,this._contentModelMatrix),a.modelMatrix=this._contentModelMatrix,a.shadows=t.shadows,a.lightColor=t.lightColor,a.imageBasedLighting=t.imageBasedLighting,a.backFaceCulling=t.backFaceCulling,a.debugWireframe=t.debugWireframe,a.showCreditsOnScreen=t.showCreditsOnScreen,a.splitDirection=t.splitDirection;const r=t.clippingPlanes;a.referenceMatrix=t.clippingPlanesOriginMatrix,Object(o["a"])(r)&&n.clippingPlanesDirty&&(a._clippingPlanes=r.enabled&&n._isClipped?r:void 0),Object(o["a"])(r)&&Object(o["a"])(a._clippingPlanes)&&a._clippingPlanes!==r&&(a._clippingPlanes=r),a.update(e);const c=e.commandList.length;i<c&&(e.passes.render||e.passes.pick)&&!Object(o["a"])(this._classificationType)&&s.addDerivedCommands(e,i)},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),Object(c["a"])(this)},e["a"]=T},"67b9":function(t,e,i){"use strict";i.d(e,"a",(function(){return _}));var a=i("2c34"),n=i("1da3"),s=i("dc1c"),o=i("2bb9"),r=i("abab"),c=i("2f63"),h=i("535a"),l=i("c13c"),u=i("283e");function _(t){this._classes=void 0,this._classIds=void 0,this._classIndexes=void 0,this._parentCounts=void 0,this._parentIndexes=void 0,this._parentIds=void 0,d(this,t.extension,t.binaryBody)}function d(t,e,i){let s,u,_;const d=e.instancesLength,p=e.classes;let b,m=e.classIds,g=e.parentCounts,y=e.parentIds,O=d;if(Object(c["a"])(m.byteOffset)&&(m.componentType=Object(h["a"])(m.componentType,r["a"].UNSIGNED_SHORT),m.type=n["a"].SCALAR,_=Object(l["a"])(m),m=_.createArrayBufferView(i.buffer,i.byteOffset+m.byteOffset,d)),Object(c["a"])(g))for(Object(c["a"])(g.byteOffset)&&(g.componentType=Object(h["a"])(g.componentType,r["a"].UNSIGNED_SHORT),g.type=n["a"].SCALAR,_=Object(l["a"])(g),g=_.createArrayBufferView(i.buffer,i.byteOffset+g.byteOffset,d)),b=new Uint16Array(d),O=0,s=0;s<d;++s)b[s]=O,O+=g[s];Object(c["a"])(y)&&Object(c["a"])(y.byteOffset)&&(y.componentType=Object(h["a"])(y.componentType,r["a"].UNSIGNED_SHORT),y.type=n["a"].SCALAR,_=Object(l["a"])(y),y=_.createArrayBufferView(i.buffer,i.byteOffset+y.byteOffset,O));const T=p.length;for(s=0;s<T;++s){const t=p[s].length,e=p[s].instances,a=f(t,e,i);p[s].instances=Object(o["a"])(a,e)}const A=Object(a["a"])(new Array(T),0),x=new Uint16Array(d);for(s=0;s<d;++s)u=m[s],x[s]=A[u],++A[u];t._classes=p,t._classIds=m,t._classIndexes=x,t._parentCounts=g,t._parentIndexes=b,t._parentIds=y}function f(t,e,i){let a;for(const n in e)if(e.hasOwnProperty(n)){const s=e[n],o=s.byteOffset;if(Object(c["a"])(o)){const e=s.componentType,r=s.type;if(!Object(c["a"])(e))throw new u["a"]("componentType is required.");if(!Object(c["a"])(r))throw new u["a"]("type is required.");if(!Object(c["a"])(i))throw new u["a"](`Property ${n} requires a batch table binary.`);const h=Object(l["a"])(s),_=h.componentsPerAttribute,d=h.classType,f=h.createArrayBufferView(i.buffer,i.byteOffset+o,t);Object(c["a"])(a)||(a={}),a[n]={typedArray:f,componentCount:_,type:d}}}return a}const p=[],b=[];let m=0;function g(t,e,i){const a=t._classIds,n=t._parentCounts,s=t._parentIds,o=t._parentIndexes,r=a.length,h=p;h.length=Math.max(h.length,r);const l=++m,u=b;u.length=0,u.push(e);while(u.length>0){if(e=u.pop(),h[e]===l)continue;h[e]=l;const a=i(t,e);if(Object(c["a"])(a))return a;const r=n[e],_=o[e];for(let t=0;t<r;++t){const i=s[_+t];i!==e&&u.push(i)}}}function y(t,e,i){let a=!0;while(a){const n=i(t,e);if(Object(c["a"])(n))return n;const s=t._parentIds[e];a=s!==e,e=s}}function O(t,e,i){const a=t._parentCounts,n=t._parentIds;return Object(c["a"])(n)?Object(c["a"])(a)?g(t,e,i):y(t,e,i):i(t,e)}function T(t,e){const i=t.typedArray,a=t.componentCount;return 1===a?i[e]:t.type.unpack(i,e*a)}function A(t,e,i){const a=t.typedArray,n=t.componentCount;1===n?a[e]=i:t.type.pack(i,a,e*n)}_.prototype.hasProperty=function(t,e){const i=O(this,t,(function(t,i){const a=t._classIds[i],n=t._classes[a].instances;if(Object(c["a"])(n[e]))return!0}));return Object(c["a"])(i)},_.prototype.propertyExists=function(t){const e=this._classes,i=e.length;for(let a=0;a<i;++a){const i=e[a].instances;if(Object(c["a"])(i[t]))return!0}return!1},_.prototype.getPropertyIds=function(t,e){return e=Object(c["a"])(e)?e:[],e.length=0,O(this,t,(function(t,i){const a=t._classIds[i],n=t._classes[a].instances;for(const s in n)n.hasOwnProperty(s)&&-1===e.indexOf(s)&&e.push(s)})),e},_.prototype.getProperty=function(t,e){return O(this,t,(function(t,i){const a=t._classIds[i],n=t._classes[a],o=t._classIndexes[i],r=n.instances[e];if(Object(c["a"])(r))return Object(c["a"])(r.typedArray)?T(r,o):Object(s["a"])(r[o],!0)}))},_.prototype.setProperty=function(t,e,i){const a=O(this,t,(function(t,a){const n=t._classIds[a],o=t._classes[n],r=t._classIndexes[a],h=o.instances[e];if(Object(c["a"])(h))return Object(c["a"])(h.typedArray)?A(h,r,i):h[r]=Object(s["a"])(i,!0),!0}));return Object(c["a"])(a)},_.prototype.isClass=function(t,e){const i=O(this,t,(function(t,i){const a=t._classIds[i],n=t._classes[a];if(n.name===e)return!0}));return Object(c["a"])(i)},_.prototype.getClassName=function(t){const e=this._classIds[t],i=this._classes[e];return i.name}},"6f00":function(t,e,i){"use strict";var a=i("daa2");const n={ADD:a["a"].FUNC_ADD,SUBTRACT:a["a"].FUNC_SUBTRACT,REVERSE_SUBTRACT:a["a"].FUNC_REVERSE_SUBTRACT,MIN:a["a"].MIN,MAX:a["a"].MAX};e["a"]=Object.freeze(n)},"8f7c":function(t,e,i){"use strict";var a=i("c8d1"),n=i("cef5"),s=i("670c"),o=i("be18"),r=i("bd8d"),c=i("abab"),h=i("535a"),l=i("2f63"),u=i("7d62"),_=i("6cbd"),d=i("0123"),f=i("93da"),p=i("52f0"),b=i("daa2"),m=i("f20a"),g=i("8b68"),y=i("b997"),O=i("a894"),T=i("d289"),A=i("6dc0"),x=i("e90c"),D=i("5770"),S=i("9d80"),C=i("6d53"),E=i("d3d4"),I=i("3e44"),N=i("b7c8"),v=i("141c"),L=i("2d75"),j=i("f61d"),P=i("a307"),B=i("d9a9"),R=i("7eb3"),w=i("05e5");const U=I["a"].SHOW_INDEX,M=I["a"].POSITION_INDEX,k=I["a"].PIXEL_OFFSET_INDEX,F=I["a"].EYE_OFFSET_INDEX,V=I["a"].HORIZONTAL_ORIGIN_INDEX,H=I["a"].VERTICAL_ORIGIN_INDEX,z=I["a"].SCALE_INDEX,G=I["a"].IMAGE_INDEX_INDEX,W=I["a"].COLOR_INDEX,X=I["a"].ROTATION_INDEX,Y=I["a"].ALIGNED_AXIS_INDEX,q=I["a"].SCALE_BY_DISTANCE_INDEX,K=I["a"].TRANSLUCENCY_BY_DISTANCE_INDEX,J=I["a"].PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,Q=I["a"].DISTANCE_DISPLAY_CONDITION,$=I["a"].DISABLE_DEPTH_DISTANCE,Z=I["a"].TEXTURE_COORDINATE_BOUNDS,tt=I["a"].SDF_INDEX,et=I["a"].NUMBER_OF_PROPERTIES;let it;const at={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10,sdf:11},nt={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11,sdf:12};function st(t){t=Object(h["a"])(t,h["a"].EMPTY_OBJECT),this._scene=t.scene,this._batchTable=t.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(et),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new n["a"],this._baseVolumeWC=new n["a"],this._baseVolume2D=new n["a"],this._boundingVolume=new n["a"],this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=Object(h["a"])(t.show,!0),this.modelMatrix=p["a"].clone(Object(h["a"])(t.modelMatrix,p["a"].IDENTITY)),this._modelMatrix=p["a"].clone(p["a"].IDENTITY),this.debugShowBoundingVolume=Object(h["a"])(t.debugShowBoundingVolume,!1),this.debugShowTextureAtlas=Object(h["a"])(t.debugShowTextureAtlas,!1),this.blendOption=Object(h["a"])(t.blendOption,v["a"].OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=P["a"].SCENE3D,this._buffersUsage=[g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW,g["a"].STATIC_DRAW],this._highlightColor=r["a"].clone(r["a"].WHITE);const e=this;this._uniforms={u_atlas:function(){return e._textureAtlas.texture},u_highlightColor:function(){return e._highlightColor}};const i=this._scene;Object(l["a"])(i)&&Object(l["a"])(i.terrainProviderChanged)&&(this._removeCallbackFunc=i.terrainProviderChanged.addEventListener((function(){const t=this._billboards,e=t.length;for(let i=0;i<e;++i)Object(l["a"])(t[i])&&t[i]._updateClamping()}),this))}function ot(t){const e=t.length;for(let i=0;i<e;++i)t[i]&&t[i]._destroy()}function rt(t){if(t._billboardsRemoved){t._billboardsRemoved=!1;const e=[],i=t._billboards,a=i.length;for(let t=0,n=0;t<a;++t){const a=i[t];Object(l["a"])(a)&&(a._index=n++,e.push(a))}t._billboards=e}}let ct;function ht(t){const e=16384;let i=t.cache.billboardCollection_indexBufferBatched;if(Object(l["a"])(i))return i;const a=6*e-6,n=new Uint16Array(a);for(let s=0,o=0;s<a;s+=6,o+=4)n[s]=o,n[s+1]=o+1,n[s+2]=o+2,n[s+3]=o+0,n[s+4]=o+2,n[s+5]=o+3;return i=m["a"].createIndexBuffer({context:t,typedArray:n,usage:g["a"].STATIC_DRAW,indexDatatype:d["a"].UNSIGNED_SHORT}),i.vertexArrayDestroyable=!1,t.cache.billboardCollection_indexBufferBatched=i,i}function lt(t){let e=t.cache.billboardCollection_indexBufferInstanced;return Object(l["a"])(e)||(e=m["a"].createIndexBuffer({context:t,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:g["a"].STATIC_DRAW,indexDatatype:d["a"].UNSIGNED_SHORT}),e.vertexArrayDestroyable=!1,t.cache.billboardCollection_indexBufferInstanced=e),e}function ut(t){let e=t.cache.billboardCollection_vertexBufferInstanced;return Object(l["a"])(e)||(e=m["a"].createVertexBuffer({context:t,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:g["a"].STATIC_DRAW}),e.vertexArrayDestroyable=!1,t.cache.billboardCollection_vertexBufferInstanced=e),e}function _t(t,e,i,a,n,s){const o=[{index:it.positionHighAndScale,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[M]},{index:it.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[M]},{index:it.compressedAttribute0,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[k]},{index:it.compressedAttribute1,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[K]},{index:it.compressedAttribute2,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[W]},{index:it.eyeOffset,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[F]},{index:it.scaleByDistance,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[q]},{index:it.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[J]},{index:it.compressedAttribute3,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[Q]},{index:it.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:c["a"].FLOAT,usage:i[Z]}];a&&o.push({index:it.direction,componentsPerAttribute:2,componentDatatype:c["a"].FLOAT,vertexBuffer:ut(t)}),Object(l["a"])(n)&&o.push({index:it.a_batchId,componentsPerAttribute:1,componentDatatype:c["a"].FLOAT,bufferUsage:g["a"].STATIC_DRAW}),s&&o.push({index:it.sdf,componentsPerAttribute:2,componentDatatype:c["a"].FLOAT,usage:i[tt]});const r=a?e:4*e;return new S["a"](t,o,r,a)}Object.defineProperties(st.prototype,{length:{get:function(){return rt(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(t){this._textureAtlas!==t&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=t,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(t){this._destroyTextureAtlas=t}}}),st.prototype.add=function(t){const e=new I["a"](t,this);return e._index=this._billboards.length,this._billboards.push(e),this._createVertexArray=!0,e},st.prototype.remove=function(t){return!!this.contains(t)&&(this._billboards[t._index]=void 0,this._billboardsRemoved=!0,this._createVertexArray=!0,t._destroy(),!0)},st.prototype.removeAll=function(){ot(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0},st.prototype._updateBillboard=function(t,e){t._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=t),++this._propertiesChanged[e]},st.prototype.contains=function(t){return Object(l["a"])(t)&&t._billboardCollection===this},st.prototype.get=function(t){return rt(this),this._billboards[t]},st.prototype.computeNewBuffersUsage=function(){const t=this._buffersUsage;let e=!1;const i=this._propertiesChanged;for(let a=0;a<et;++a){const n=0===i[a]?g["a"].STATIC_DRAW:g["a"].STREAM_DRAW;e=e||t[a]!==n,t[a]=n}return e};const dt=new _["a"];function ft(t,e,i,a,s){let o;const r=a[it.positionHighAndScale],c=a[it.positionLowAndRotation],h=s._getActualPosition();t._mode===P["a"].SCENE3D&&(n["a"].expand(t._baseVolume,h,t._baseVolume),t._boundingVolumeDirty=!0),_["a"].fromCartesian(h,dt);const l=s.scale,u=s.rotation;0!==u&&(t._shaderRotation=!0),t._maxScale=Math.max(t._maxScale,l);const d=dt.high,f=dt.low;t._instanced?(o=s._index,r(o,d.x,d.y,d.z,l),c(o,f.x,f.y,f.z,u)):(o=4*s._index,r(o+0,d.x,d.y,d.z,l),r(o+1,d.x,d.y,d.z,l),r(o+2,d.x,d.y,d.z,l),r(o+3,d.x,d.y,d.z,l),c(o+0,f.x,f.y,f.z,u),c(o+1,f.x,f.y,f.z,u),c(o+2,f.x,f.y,f.z,u),c(o+3,f.x,f.y,f.z,u))}const pt=new s["a"],bt=32768,mt=65536,gt=4096,yt=256,Ot=128,Tt=32,At=8,xt=4,Dt=1/256,St=0,Ct=2,Et=3,It=1;function Nt(t,e,i,n,s){let o;const r=n[it.compressedAttribute0],c=s.pixelOffset,h=c.x,l=c.y,u=s._translate,_=u.x,d=u.y;t._maxPixelOffset=Math.max(t._maxPixelOffset,Math.abs(h+_),Math.abs(-l+d));const p=s.horizontalOrigin;let b=s._verticalOrigin,m=s.show&&s.clusterShow;0===s.color.alpha&&(m=!1),b===w["a"].BASELINE&&(b=w["a"].BOTTOM),t._allHorizontalCenter=t._allHorizontalCenter&&p===j["a"].CENTER,t._allVerticalCenter=t._allVerticalCenter&&b===w["a"].CENTER;let g=0,y=0,O=0,T=0;const A=s._imageIndex;if(-1!==A){const t=i[A];g=t.x,y=t.y,O=t.width,T=t.height}const x=g+O,D=y+T;let S=Math.floor(f["a"].clamp(h,-bt,bt)+bt)*Ot;S+=(p+1)*Tt,S+=(b+1)*At,S+=(m?1:0)*xt;let C=Math.floor(f["a"].clamp(l,-bt,bt)+bt)*yt,E=Math.floor(f["a"].clamp(_,-bt,bt)+bt)*yt;const I=(f["a"].clamp(d,-bt,bt)+bt)*Dt,N=Math.floor(I),v=Math.floor((I-N)*yt);C+=N,E+=v,pt.x=g,pt.y=y;const L=a["a"].compressTextureCoordinates(pt);pt.x=x;const P=a["a"].compressTextureCoordinates(pt);pt.y=D;const B=a["a"].compressTextureCoordinates(pt);pt.x=g;const R=a["a"].compressTextureCoordinates(pt);t._instanced?(o=s._index,r(o,S,C,E,L)):(o=4*s._index,r(o+0,S+St,C,E,L),r(o+1,S+Ct,C,E,P),r(o+2,S+Et,C,E,B),r(o+3,S+It,C,E,R))}function vt(t,e,i,n,s){let r;const c=n[it.compressedAttribute1],u=s.alignedAxis;o["a"].equals(u,o["a"].ZERO)||(t._shaderAlignedAxis=!0);let _=0,d=1,p=1,b=1;const m=s.translucencyByDistance;Object(l["a"])(m)&&(_=m.near,d=m.nearValue,p=m.far,b=m.farValue,1===d&&1===b||(t._shaderTranslucencyByDistance=!0));let g=0;const y=s._imageIndex;if(-1!==y){const t=i[y];g=t.width}const O=t._textureAtlas.texture.width,T=Math.round(Object(h["a"])(s.width,O*g));t._maxSize=Math.max(t._maxSize,T);let A=f["a"].clamp(T,0,mt),x=0;Math.abs(o["a"].magnitudeSquared(u)-1)<f["a"].EPSILON6&&(x=a["a"].octEncodeFloat(u)),d=f["a"].clamp(d,0,1),d=1===d?255:255*d|0,A=A*yt+d,b=f["a"].clamp(b,0,1),b=1===b?255:255*b|0,x=x*yt+b,t._instanced?(r=s._index,c(r,A,x,_,p)):(r=4*s._index,c(r+0,A,x,_,p),c(r+1,A,x,_,p),c(r+2,A,x,_,p),c(r+3,A,x,_,p))}function Lt(t,e,i,a,n){let s;const c=a[it.compressedAttribute2],u=n.color,_=Object(l["a"])(t._batchTable)?r["a"].WHITE:n.getPickId(e.context).color,d=n.sizeInMeters?1:0,p=Math.abs(o["a"].magnitudeSquared(n.alignedAxis)-1)<f["a"].EPSILON6?1:0;t._allSizedInMeters=t._allSizedInMeters&&1===d;let b=0;const m=n._imageIndex;if(-1!==m){const t=i[m];b=t.height}const g=t._textureAtlas.texture.dimensions,y=Math.round(Object(h["a"])(n.height,g.y*b));t._maxSize=Math.max(t._maxSize,y);let O=Object(h["a"])(n._labelHorizontalOrigin,-2);O+=2;const T=y*xt+O;let A=r["a"].floatToByte(u.red),x=r["a"].floatToByte(u.green),D=r["a"].floatToByte(u.blue);const S=A*mt+x*yt+D;A=r["a"].floatToByte(_.red),x=r["a"].floatToByte(_.green),D=r["a"].floatToByte(_.blue);const C=A*mt+x*yt+D;let E=r["a"].floatToByte(u.alpha)*mt+r["a"].floatToByte(_.alpha)*yt;E+=2*d+p,t._instanced?(s=n._index,c(s,S,C,E,T)):(s=4*n._index,c(s+0,S,C,E,T),c(s+1,S,C,E,T),c(s+2,S,C,E,T),c(s+3,S,C,E,T))}function jt(t,e,i,n,s){let o;const r=n[it.eyeOffset],c=s.eyeOffset;let h=c.z;if(s._heightReference!==L["a"].NONE&&(h*=1.005),t._maxEyeOffset=Math.max(t._maxEyeOffset,Math.abs(c.x),Math.abs(c.y),Math.abs(h)),t._instanced){let t=0,e=0;const n=s._imageIndex;if(-1!==n){const a=i[n];t=a.width,e=a.height}pt.x=t,pt.y=e;const l=a["a"].compressTextureCoordinates(pt);o=s._index,r(o,c.x,c.y,h,l)}else o=4*s._index,r(o+0,c.x,c.y,h,0),r(o+1,c.x,c.y,h,0),r(o+2,c.x,c.y,h,0),r(o+3,c.x,c.y,h,0)}function Pt(t,e,i,a,n){let s;const o=a[it.scaleByDistance];let r=0,c=1,h=1,u=1;const _=n.scaleByDistance;Object(l["a"])(_)&&(r=_.near,c=_.nearValue,h=_.far,u=_.farValue,1===c&&1===u||(t._shaderScaleByDistance=!0)),t._instanced?(s=n._index,o(s,r,c,h,u)):(s=4*n._index,o(s+0,r,c,h,u),o(s+1,r,c,h,u),o(s+2,r,c,h,u),o(s+3,r,c,h,u))}function Bt(t,e,i,a,n){let s;const o=a[it.pixelOffsetScaleByDistance];let r=0,c=1,h=1,u=1;const _=n.pixelOffsetScaleByDistance;Object(l["a"])(_)&&(r=_.near,c=_.nearValue,h=_.far,u=_.farValue,1===c&&1===u||(t._shaderPixelOffsetScaleByDistance=!0)),t._instanced?(s=n._index,o(s,r,c,h,u)):(s=4*n._index,o(s+0,r,c,h,u),o(s+1,r,c,h,u),o(s+2,r,c,h,u),o(s+3,r,c,h,u))}function Rt(t,e,i,a,n){let s;const o=a[it.compressedAttribute3];let r=0,c=Number.MAX_VALUE;const u=n.distanceDisplayCondition;Object(l["a"])(u)&&(r=u.near,c=u.far,r*=r,c*=c,t._shaderDistanceDisplayCondition=!0);let _=n.disableDepthTestDistance;const d=n.heightReference===L["a"].CLAMP_TO_GROUND&&e.context.depthTexture;let p,b;if(Object(l["a"])(_)||(_=d?5e3:0),_*=_,(d||_>0)&&(t._shaderDisableDepthDistance=!0,_===Number.POSITIVE_INFINITY&&(_=-1)),Object(l["a"])(n._labelDimensions))b=n._labelDimensions.x,p=n._labelDimensions.y;else{let e=0,a=0;const s=n._imageIndex;if(-1!==s){const t=i[s];e=t.height,a=t.width}p=Math.round(Object(h["a"])(n.height,t._textureAtlas.texture.dimensions.y*e));const o=t._textureAtlas.texture.width;b=Math.round(Object(h["a"])(n.width,o*a))}const m=Math.floor(f["a"].clamp(b,0,gt)),g=Math.floor(f["a"].clamp(p,0,gt)),y=m*gt+g;t._instanced?(s=n._index,o(s,r,c,_,y)):(s=4*n._index,o(s+0,r,c,_,y),o(s+1,r,c,_,y),o(s+2,r,c,_,y),o(s+3,r,c,_,y))}function wt(t,e,i,a,n){if(n.heightReference===L["a"].CLAMP_TO_GROUND){const i=t._scene,a=e.context,n=e.globeTranslucencyState.translucent,s=Object(l["a"])(i.globe)&&i.globe.depthTestAgainstTerrain;t._shaderClampToGround=a.depthTexture&&!n&&s}let s;const o=a[it.textureCoordinateBoundsOrLabelTranslate];if(y["a"].maximumVertexTextureImageUnits>0){let e=0,i=0;return Object(l["a"])(n._labelTranslate)&&(e=n._labelTranslate.x,i=n._labelTranslate.y),void(t._instanced?(s=n._index,o(s,e,i,0,0)):(s=4*n._index,o(s+0,e,i,0,0),o(s+1,e,i,0,0),o(s+2,e,i,0,0),o(s+3,e,i,0,0)))}let r=0,c=0,h=0,u=0;const _=n._imageIndex;if(-1!==_){const t=i[_];r=t.x,c=t.y,h=t.width,u=t.height}const d=r+h,f=c+u;t._instanced?(s=n._index,o(s,r,c,d,f)):(s=4*n._index,o(s+0,r,c,d,f),o(s+1,r,c,d,f),o(s+2,r,c,d,f),o(s+3,r,c,d,f))}function Ut(t,e,i,a,n){if(!Object(l["a"])(t._batchTable))return;const s=a[it.a_batchId],o=n._batchIndex;let r;t._instanced?(r=n._index,s(r,o)):(r=4*n._index,s(r+0,o),s(r+1,o),s(r+2,o),s(r+3,o))}function Mt(t,e,i,a,n){if(!t._sdf)return;let s;const o=a[it.sdf],c=n.outlineColor,h=n.outlineWidth,l=r["a"].floatToByte(c.red),u=r["a"].floatToByte(c.green),_=r["a"].floatToByte(c.blue),d=l*mt+u*yt+_,f=h/B["a"].RADIUS,p=r["a"].floatToByte(c.alpha)*mt+r["a"].floatToByte(f)*yt;t._instanced?(s=n._index,o(s,d,p)):(s=4*n._index,o(s+0,d+St,p),o(s+1,d+Ct,p),o(s+2,d+Et,p),o(s+3,d+It,p))}function kt(t,e,i,a,n){ft(t,e,i,a,n),Nt(t,e,i,a,n),vt(t,e,i,a,n),Lt(t,e,i,a,n),jt(t,e,i,a,n),Pt(t,e,i,a,n),Bt(t,e,i,a,n),Rt(t,e,i,a,n),wt(t,e,i,a,n),Ut(t,e,i,a,n),Mt(t,e,i,a,n)}function Ft(t,e,i,a,s,o){let r;a.mode===P["a"].SCENE3D?(r=t._baseVolume,t._boundingVolumeDirty=!0):r=t._baseVolume2D;const c=[];for(let h=0;h<i;++h){const t=e[h],i=t.position,u=I["a"]._computeActualPosition(t,i,a,s);Object(l["a"])(u)&&(t._setActualPosition(u),o?c.push(u):n["a"].expand(r,u,r))}o&&n["a"].fromPoints(c,r)}function Vt(t,e){const i=e.mode,a=t._billboards,n=t._billboardsToUpdate,s=t._modelMatrix;t._createVertexArray||t._mode!==i||i!==P["a"].SCENE3D&&!p["a"].equals(s,t.modelMatrix)?(t._mode=i,p["a"].clone(t.modelMatrix,s),t._createVertexArray=!0,i!==P["a"].SCENE3D&&i!==P["a"].SCENE2D&&i!==P["a"].COLUMBUS_VIEW||Ft(t,a,a.length,e,s,!0)):i===P["a"].MORPHING?Ft(t,a,a.length,e,s,!0):i!==P["a"].SCENE2D&&i!==P["a"].COLUMBUS_VIEW||Ft(t,n,t._billboardsToUpdateIndex,e,s,!1)}function Ht(t,e,i){let a=1;t._allSizedInMeters&&0===t._maxPixelOffset||(a=e.camera.getPixelSize(i,e.context.drawingBufferWidth,e.context.drawingBufferHeight));let n=a*t._maxScale*t._maxSize*2;t._allHorizontalCenter&&t._allVerticalCenter&&(n*=.5);const s=a*t._maxPixelOffset+t._maxEyeOffset;i.radius+=n+s}function zt(t,e){const i="uniform sampler2D billboard_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    gl_FragColor = texture2D(billboard_texture, v_textureCoordinates); \n} \n",a=e.createViewportQuadCommand(i,{uniformMap:{billboard_texture:function(){return t._textureAtlas.texture}}});return a.pass=T["a"].OVERLAY,a}const Gt=[];st.prototype.update=function(t){if(rt(this),!this.show)return;let e=this._billboards,i=e.length;const a=t.context;this._instanced=a.instancedArrays,it=this._instanced?nt:at,ct=this._instanced?lt:ht;let s=this._textureAtlas;if(!Object(l["a"])(s)){s=this._textureAtlas=new R["a"]({context:a});for(let t=0;t<i;++t)e[t]._loadImage()}const o=s.textureCoordinates;if(0===o.length)return;Vt(this,t),e=this._billboards,i=e.length;const r=this._billboardsToUpdate,c=this._billboardsToUpdateIndex,h=this._propertiesChanged,u=s.guid,_=this._createVertexArray||this._textureAtlasGUID!==u;let d;this._textureAtlasGUID=u;const f=t.passes,m=f.pick;if(_||!m&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let t=0;t<et;++t)h[t]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),i>0){this._vaf=_t(a,i,this._buffersUsage,this._instanced,this._batchTable,this._sdf),d=this._vaf.writers;for(let e=0;e<i;++e){const i=this._billboards[e];i._dirty=!1,kt(this,t,o,d,i)}this._vaf.commit(ct(a))}this._billboardsToUpdateIndex=0}else if(c>0){const e=Gt;e.length=0,(h[M]||h[X]||h[z])&&e.push(ft),(h[G]||h[k]||h[V]||h[H]||h[U])&&(e.push(Nt),this._instanced&&e.push(jt)),(h[G]||h[Y]||h[K])&&(e.push(vt),e.push(Lt)),(h[G]||h[W])&&e.push(Lt),h[F]&&e.push(jt),h[q]&&e.push(Pt),h[J]&&e.push(Bt),(h[Q]||h[$]||h[G]||h[M])&&e.push(Rt),(h[G]||h[M])&&e.push(wt),h[tt]&&e.push(Mt);const n=e.length;if(d=this._vaf.writers,c/i>.1){for(let i=0;i<c;++i){const a=r[i];a._dirty=!1;for(let i=0;i<n;++i)e[i](this,t,o,d,a)}this._vaf.commit(ct(a))}else{for(let i=0;i<c;++i){const a=r[i];a._dirty=!1;for(let i=0;i<n;++i)e[i](this,t,o,d,a);this._instanced?this._vaf.subCommit(a._index,1):this._vaf.subCommit(4*a._index,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(c>1.5*i&&(r.length=i),!Object(l["a"])(this._vaf)||!Object(l["a"])(this._vaf.va))return;let g;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,n["a"].transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let S=p["a"].IDENTITY;t.mode===P["a"].SCENE3D?(S=this.modelMatrix,g=n["a"].clone(this._baseVolumeWC,this._boundingVolume)):g=n["a"].clone(this._baseVolume2D,this._boundingVolume),Ht(this,t,g);const I=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,I){this._blendOption===v["a"].OPAQUE||this._blendOption===v["a"].OPAQUE_AND_TRANSLUCENT?this._rsOpaque=A["a"].fromCache({depthTest:{enabled:!0,func:b["a"].LESS},depthMask:!0}):this._rsOpaque=void 0;const t=this._blendOption===v["a"].TRANSLUCENT;this._blendOption===v["a"].TRANSLUCENT||this._blendOption===v["a"].OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=A["a"].fromCache({depthTest:{enabled:!0,func:t?b["a"].LEQUAL:b["a"].LESS},depthMask:t,blending:N["a"].ALPHA_BLEND}):this._rsTranslucent=void 0}let L,j,w,Z,st;this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==t.minimumDisableDepthTestDistance;const ot=y["a"].maximumVertexTextureImageUnits>0;if(I||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround||this._sdf!==this._compiledSDF){L=E["a"],j=C["a"],st=[],Object(l["a"])(this._batchTable)&&(st.push("VECTOR_TILE"),L=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(L),j=this._batchTable.getFragmentShaderCallback(!1,void 0)(j)),w=new D["a"]({defines:st,sources:[L]}),this._instanced&&w.defines.push("INSTANCED"),this._shaderRotation&&w.defines.push("ROTATION"),this._shaderAlignedAxis&&w.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&w.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&w.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&w.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&w.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&w.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(ot?w.defines.push("VERTEX_DEPTH_CHECK"):w.defines.push("FRAGMENT_DEPTH_CHECK"));const t=1-B["a"].CUTOFF;this._sdf&&w.defines.push("SDF");const e=Object(l["a"])(this._batchTable)?"VECTOR_TILE":"";this._blendOption===v["a"].OPAQUE_AND_TRANSLUCENT&&(Z=new D["a"]({defines:["OPAQUE",e],sources:[j]}),this._shaderClampToGround&&(ot?Z.defines.push("VERTEX_DEPTH_CHECK"):Z.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(Z.defines.push("SDF"),Z.defines.push("SDF_EDGE "+t)),this._sp=x["a"].replaceCache({context:a,shaderProgram:this._sp,vertexShaderSource:w,fragmentShaderSource:Z,attributeLocations:it}),Z=new D["a"]({defines:["TRANSLUCENT",e],sources:[j]}),this._shaderClampToGround&&(ot?Z.defines.push("VERTEX_DEPTH_CHECK"):Z.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(Z.defines.push("SDF"),Z.defines.push("SDF_EDGE "+t)),this._spTranslucent=x["a"].replaceCache({context:a,shaderProgram:this._spTranslucent,vertexShaderSource:w,fragmentShaderSource:Z,attributeLocations:it})),this._blendOption===v["a"].OPAQUE&&(Z=new D["a"]({defines:[e],sources:[j]}),this._shaderClampToGround&&(ot?Z.defines.push("VERTEX_DEPTH_CHECK"):Z.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(Z.defines.push("SDF"),Z.defines.push("SDF_EDGE "+t)),this._sp=x["a"].replaceCache({context:a,shaderProgram:this._sp,vertexShaderSource:w,fragmentShaderSource:Z,attributeLocations:it})),this._blendOption===v["a"].TRANSLUCENT&&(Z=new D["a"]({defines:[e],sources:[j]}),this._shaderClampToGround&&(ot?Z.defines.push("VERTEX_DEPTH_CHECK"):Z.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(Z.defines.push("SDF"),Z.defines.push("SDF_EDGE "+t)),this._spTranslucent=x["a"].replaceCache({context:a,shaderProgram:this._spTranslucent,vertexShaderSource:w,fragmentShaderSource:Z,attributeLocations:it})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround,this._compiledSDF=this._sdf}const ut=t.commandList;if(f.render||f.pick){const e=this._colorCommands,a=this._blendOption===v["a"].OPAQUE,n=this._blendOption===v["a"].OPAQUE_AND_TRANSLUCENT,s=this._vaf.va,o=s.length;let r,c=this._uniforms;Object(l["a"])(this._batchTable)?(c=this._batchTable.getUniformMapCallback()(c),r=this._batchTable.getPickId()):r="v_pickColor",e.length=o;const h=n?2*o:o;for(let t=0;t<h;++t){let o=e[t];Object(l["a"])(o)||(o=e[t]=new O["a"]);const h=a||n&&t%2===0;o.pass=h||!n?T["a"].OPAQUE:T["a"].TRANSLUCENT,o.owner=this;const u=n?Math.floor(t/2):t;o.boundingVolume=g,o.modelMatrix=S,o.count=s[u].indicesCount,o.shaderProgram=h?this._sp:this._spTranslucent,o.uniformMap=c,o.vertexArray=s[u].va,o.renderState=h?this._rsOpaque:this._rsTranslucent,o.debugShowBoundingVolume=this.debugShowBoundingVolume,o.pickId=r,this._instanced&&(o.count=6,o.instanceCount=i),ut.push(o)}this.debugShowTextureAtlas&&(Object(l["a"])(this.debugCommand)||(this.debugCommand=zt(this,t.context)),ut.push(this.debugCommand))}},st.prototype.isDestroyed=function(){return!1},st.prototype.destroy=function(){return Object(l["a"])(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),ot(this._billboards),Object(u["a"])(this)},e["a"]=st},a513:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var a=i("535a"),n=i("9c35"),s=i("2f63"),o=i("aa13"),r=i("2773");function c(t){t=Object(a["a"])(t,a["a"].EMPTY_OBJECT);const e=t.typedArray,i=t.resource,s=t.cacheKey;this._typedArray=e,this._resource=i,this._cacheKey=s,this._state=r["a"].UNLOADED,this._promise=Object(n["a"])()}function h(t){const e=t._resource;t._state=r["a"].LOADING,c._fetchArrayBuffer(e).then((function(e){t.isDestroyed()||(t._typedArray=new Uint8Array(e),t._state=r["a"].READY,t._promise.resolve(t))})).catch((function(i){if(t.isDestroyed())return;t._state=r["a"].FAILED;const a="Failed to load external buffer: "+e.url;t._promise.reject(t.getError(a,i))}))}Object(s["a"])(Object.create)&&(c.prototype=Object.create(o["a"].prototype),c.prototype.constructor=c),Object.defineProperties(c.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}}),c.prototype.load=function(){Object(s["a"])(this._typedArray)?this._promise.resolve(this):h(this)},c._fetchArrayBuffer=function(t){return t.fetchArrayBuffer()},c.prototype.unload=function(){this._typedArray=void 0}},b7c8:function(t,e,i){"use strict";var a=i("6f00"),n=i("30d2");const s={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:a["a"].ADD,equationAlpha:a["a"].ADD,functionSourceRgb:n["a"].SOURCE_ALPHA,functionSourceAlpha:n["a"].ONE,functionDestinationRgb:n["a"].ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n["a"].ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:a["a"].ADD,equationAlpha:a["a"].ADD,functionSourceRgb:n["a"].ONE,functionSourceAlpha:n["a"].ONE,functionDestinationRgb:n["a"].ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n["a"].ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:a["a"].ADD,equationAlpha:a["a"].ADD,functionSourceRgb:n["a"].SOURCE_ALPHA,functionSourceAlpha:n["a"].ONE,functionDestinationRgb:n["a"].ONE,functionDestinationAlpha:n["a"].ONE})};e["a"]=Object.freeze(s)},c078:function(t,e,i){"use strict";var a=i("7229"),n=i("8dfe"),s=i("535a"),o=i("9c35"),r=i("2f63"),c=i("21d7"),h=i("93da"),l=i("eace"),u=i("d4ed"),_=i("283e"),d=i("a89b"),f=i("d3a0"),p=i("1e82"),b=i("1360"),m=i("64ac");function g(t){t=Object(s["a"])(t,s["a"].EMPTY_OBJECT);const e=t.key;this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=1,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this._key=e,this._resource=u["a"].createIfNeeded(t.url),this._resource.appendForwardSlash(),this._tileProtocol=t.tileProtocol,this._mapStyle=Object(s["a"])(t.mapStyle,p["a"].AERIAL),this._culture=Object(s["a"])(t.culture,""),this._tileDiscardPolicy=t.tileDiscardPolicy,Object(r["a"])(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new b["a"]),this._proxy=t.proxy,this._credit=new n["a"](`<a href="http://www.bing.com"><img src="${g.logoUrl}" title="Bing Imagery"/></a>`),this._tilingScheme=new f["a"]({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:t.ellipsoid}),this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._imageUrlTemplate=void 0,this._imageUrlSubdomains=void 0,this._errorEvent=new c["a"],this._ready=!1,this._readyPromise=Object(o["a"])();let i=this._tileProtocol;if(Object(r["a"])(i))i.length>0&&":"===i[i.length-1]&&(i=i.substr(0,i.length-1));else{const t=document.location.protocol;i="http:"===t?"http":"https"}const a=this._resource.getDerivedResource({url:"REST/v1/Imagery/Metadata/"+this._mapStyle,queryParameters:{incl:"ImageryProviders",key:this._key,uriScheme:i}}),m=this;let y;function O(t){if(1!==t.resourceSets.length)return void T();const e=t.resourceSets[0].resources[0];m._tileWidth=e.imageWidth,m._tileHeight=e.imageHeight,m._maximumLevel=e.zoomMax-1,m._imageUrlSubdomains=e.imageUrlSubdomains,m._imageUrlTemplate=e.imageUrl;let i=m._attributionList=e.imageryProviders;i||(i=m._attributionList=[]);for(let a=0,s=i.length;a<s;++a){const t=i[a];if(t.credit instanceof n["a"])break;t.credit=new n["a"](t.attribution);const e=t.coverageAreas;for(let i=0,a=t.coverageAreas.length;i<a;++i){const t=e[i],a=t.bbox;t.bbox=new l["a"](h["a"].toRadians(a[1]),h["a"].toRadians(a[0]),h["a"].toRadians(a[3]),h["a"].toRadians(a[2]))}}m._ready=!0,m._readyPromise.resolve(!0),d["a"].handleSuccess(y)}function T(t){const e=`An error occurred while accessing ${a.url}.`;y=d["a"].handleError(y,m,m._errorEvent,e,void 0,void 0,void 0,x),m._readyPromise.reject(new _["a"](e))}const A=a.url;function x(){const t=a.fetchJsonp("jsonp");g._metadataCache[A]=t,t.then(O).catch(T)}const D=g._metadataCache[A];Object(r["a"])(D)?D.then(O).catch(T):x()}Object.defineProperties(g.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}});const y=new l["a"];function O(t,e,i,a,n){const s=t._imageUrlTemplate,o=t._imageUrlSubdomains,r=(e+i+a)%o.length;return t._resource.getDerivedResource({url:s,request:n,templateValues:{quadkey:g.tileXYToQuadKey(e,i,a),subdomain:o[r],culture:t._culture},queryParameters:{n:"z"}})}g.prototype.getTileCredits=function(t,e,i){const a=this._tilingScheme.tileXYToRectangle(t,e,i,y),n=A(this._attributionList,i,a);return n},g.prototype.requestImage=function(t,e,i,a){const n=m["a"].loadImage(this,O(this,t,e,i,a));if(Object(r["a"])(n))return n.catch((function(t){return Object(r["a"])(t.blob)&&0===t.blob.size?b["a"].EMPTY_IMAGE:Promise.reject(t)}))},g.prototype.pickFeatures=function(t,e,i,a,n){},g.tileXYToQuadKey=function(t,e,i){let a="";for(let n=i;n>=0;--n){const i=1<<n;let s=0;0!==(t&i)&&(s|=1),0!==(e&i)&&(s|=2),a+=s}return a},g.quadKeyToTileXY=function(t){let e=0,i=0;const a=t.length-1;for(let n=a;n>=0;--n){const s=1<<n,o=+t[a-n];0!==(1&o)&&(e|=s),0!==(2&o)&&(i|=s)}return{x:e,y:i,level:a}},g._logoUrl=void 0,Object.defineProperties(g,{logoUrl:{get:function(){return Object(r["a"])(g._logoUrl)||(g._logoUrl=Object(a["a"])("Assets/Images/bing_maps_credit.png")),g._logoUrl},set:function(t){g._logoUrl=t}}});const T=new l["a"];function A(t,e,i){++e;const a=[];for(let n=0,s=t.length;n<s;++n){const s=t[n],o=s.coverageAreas;let c=!1;for(let t=0,a=s.coverageAreas.length;!c&&t<a;++t){const a=o[t];if(e>=a.zoomMin&&e<=a.zoomMax){const t=l["a"].intersection(i,a.bbox,T);Object(r["a"])(t)&&(c=!0)}}c&&a.push(s.credit)}return a}g._metadataCache={},e["a"]=g}}]);