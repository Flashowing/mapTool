(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~9025cc6c"],{"059a":function(e,t,i){"use strict";var o=i("be18"),a=i("bef8"),n=i("2f63"),s=i("7d62"),r=i("55f9"),c=i("93da"),u=i("52f0"),m=i("713f"),d=i("c34a"),p=i("4e1a"),h=i("2ac3"),l=i("1863"),f=i("2f48"),_=i("f806"),g=i("9dbf"),b=i("a307");function C(e){this._scene=e,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}C.prototype.completeMorph=function(){Object(n["a"])(this._completeMorph)&&this._completeMorph()},C.prototype.morphTo2D=function(e,t){Object(n["a"])(this._completeMorph)&&this._completeMorph();const i=this._scene;this._previousMode=i.mode,this._morphToOrthographic=i.camera.frustum instanceof m["a"],this._previousMode!==b["a"].SCENE2D&&this._previousMode!==b["a"].MORPHING&&(this._scene.morphStart.raiseEvent(this,this._previousMode,b["a"].SCENE2D,!0),i._mode=b["a"].MORPHING,i.camera._setTransform(u["a"].IDENTITY),this._previousMode===b["a"].COLUMBUS_VIEW?he(this,e):Se(this,e,t),0===e&&Object(n["a"])(this._completeMorph)&&this._completeMorph())};const w=new o["a"],S=new o["a"],v=new o["a"],y=new o["a"],O=new o["a"],T=new o["a"],D=new o["a"],E=new a["a"],x=new u["a"],P=new p["a"],M=new m["a"],R={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};C.prototype.morphToColumbusView=function(e,t){Object(n["a"])(this._completeMorph)&&this._completeMorph();const i=this._scene;if(this._previousMode=i.mode,this._previousMode===b["a"].COLUMBUS_VIEW||this._previousMode===b["a"].MORPHING)return;this._scene.morphStart.raiseEvent(this,this._previousMode,b["a"].COLUMBUS_VIEW,!0),i.camera._setTransform(u["a"].IDENTITY);let a=w;const s=S,r=v;if(e>0)a.x=0,a.y=-1,a.z=1,a=o["a"].multiplyByScalar(o["a"].normalize(a,a),5*t.maximumRadius,a),o["a"].negate(o["a"].normalize(a,s),s),o["a"].cross(o["a"].UNIT_X,s,r);else{const e=i.camera;if(this._previousMode===b["a"].SCENE2D)o["a"].clone(e.position,a),a.z=e.frustum.right-e.frustum.left,o["a"].negate(o["a"].UNIT_Z,s),o["a"].clone(o["a"].UNIT_Y,r);else{o["a"].clone(e.positionWC,a),o["a"].clone(e.directionWC,s),o["a"].clone(e.upWC,r);const n=t.scaleToGeodeticSurface(a,D),c=_["a"].eastNorthUpToFixedFrame(n,t,x);u["a"].inverseTransformation(c,c),i.mapProjection.project(t.cartesianToCartographic(a,E),a),u["a"].multiplyByPointAsVector(c,s,s),u["a"].multiplyByPointAsVector(c,r,r)}}let m;this._morphToOrthographic?(m=M,m.width=i.camera.frustum.right-i.camera.frustum.left,m.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight):(m=P,m.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,m.fov=c["a"].toRadians(60));const d=R;d.position=a,d.direction=s,d.up=r,d.frustum=m;const p=xe(d);j(this,p),this._previousMode===b["a"].SCENE2D?ye(this,e,d,p):(d.position2D=u["a"].multiplyByPoint(g["a"].TRANSFORM_2D,a,y),d.direction2D=u["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,s,O),d.up2D=u["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,r,T),i._mode=b["a"].MORPHING,Oe(this,e,d,p)),0===e&&Object(n["a"])(this._completeMorph)&&this._completeMorph()};const F={position:new o["a"],direction:new o["a"],up:new o["a"],frustum:void 0},I=new p["a"];function j(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new l["a"](e._scene.canvas);const i=function(){e._morphCancelled=!0,e._scene.camera.cancelFlight(),t(e)};e._completeMorph=i,e._morphHandler.setInputAction(i,f["a"].LEFT_DOWN),e._morphHandler.setInputAction(i,f["a"].MIDDLE_DOWN),e._morphHandler.setInputAction(i,f["a"].RIGHT_DOWN),e._morphHandler.setInputAction(i,f["a"].WHEEL)}}function L(e){const t=e._currentTweens;for(let i=0;i<t.length;++i)t[i].cancelTween();e._currentTweens.length=0,e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}C.prototype.morphTo3D=function(e,t){Object(n["a"])(this._completeMorph)&&this._completeMorph();const i=this._scene;if(this._previousMode=i.mode,this._previousMode!==b["a"].SCENE3D&&this._previousMode!==b["a"].MORPHING){if(this._scene.morphStart.raiseEvent(this,this._previousMode,b["a"].SCENE3D,!0),i._mode=b["a"].MORPHING,i.camera._setTransform(u["a"].IDENTITY),this._previousMode===b["a"].SCENE2D)ee(this,e,t);else{let a,n;e>0?(a=F,o["a"].fromDegrees(0,0,5*t.maximumRadius,t,a.position),o["a"].negate(a.position,a.direction),o["a"].normalize(a.direction,a.direction),o["a"].clone(o["a"].UNIT_Z,a.up)):a=B(this,t);const s=i.camera;s.frustum instanceof m["a"]?n=s.frustum.clone():(n=I,n.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,n.fov=c["a"].toRadians(60)),a.frustum=n;const r=De(a);j(this,r),q(this,e,a,r)}0===e&&Object(n["a"])(this._completeMorph)&&this._completeMorph()}},C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){return L(this),Object(s["a"])(this)};const N=new a["a"],A=new o["a"],V=new u["a"];function B(e,t){const i=e._scene,o=i.camera,a=F,n=a.position,s=a.direction,r=a.up,c=i.mapProjection.unproject(o.position,N);t.cartographicToCartesian(c,n);const m=t.scaleToGeodeticSurface(n,A),d=_["a"].eastNorthUpToFixedFrame(m,t,V);return u["a"].multiplyByPointAsVector(d,o.direction,s),u["a"].multiplyByPointAsVector(d,o.up,r),a}const k=new o["a"],W=new o["a"],U=new o["a"],G=new o["a"],H=new o["a"],z=new o["a"];function q(e,t,i,a){t*=.5;const n=e._scene,s=n.camera,c=o["a"].clone(s.position,k),m=o["a"].clone(s.direction,W),d=o["a"].clone(s.up,U),p=u["a"].multiplyByPoint(g["a"].TRANSFORM_2D_INVERSE,i.position,G),h=u["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D_INVERSE,i.direction,H),l=u["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D_INVERSE,i.up,z);function f(e){te(c,p,e.time,s.position),te(m,h,e.time,s.direction),te(d,l,e.time,s.up),o["a"].cross(s.direction,s.up,s.right),o["a"].normalize(s.right,s.right)}const _=n.tweens.add({duration:t,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:f,complete:function(){Te(e,n,0,1,t,a)}});e._currentTweens.push(_)}const Q=new m["a"],Y=new o["a"],Z=new o["a"],K=new o["a"],X=new o["a"],J=new o["a"],$=new o["a"];function ee(e,t,i){t/=3;const a=e._scene,n=a.camera;let s,r;t>0?(s=F,o["a"].fromDegrees(0,0,5*i.maximumRadius,i,s.position),o["a"].negate(s.position,s.direction),o["a"].normalize(s.direction,s.direction),o["a"].clone(o["a"].UNIT_Z,s.up)):(n.position.z=n.frustum.right-n.frustum.left,s=B(e,i)),e._morphToOrthographic?(r=Q,r.aspectRatio=a.drawingBufferWidth/a.drawingBufferHeight,r.width=n.frustum.right-n.frustum.left):(r=I,r.aspectRatio=a.drawingBufferWidth/a.drawingBufferHeight,r.fov=c["a"].toRadians(60)),s.frustum=r;const u=De(s);let m;j(e,u),m=e._morphToOrthographic?function(){q(e,t,s,u)}:function(){ve(e,t,s,(function(){q(e,t,s,u)}))},t>0?(a._mode=b["a"].SCENE2D,n.flyTo({duration:t,destination:o["a"].fromDegrees(0,0,5*i.maximumRadius,i,X),complete:function(){a._mode=b["a"].MORPHING,m()}})):m()}function te(e,t,i,a){return o["a"].lerp(e,t,i,a)}function ie(e,t,i,o,a){const n=e._scene,s=n.camera;if(s.frustum instanceof m["a"])return;const u=s.frustum.fov,d=.5*c["a"].RADIANS_PER_DEGREE,p=i.position.z*Math.tan(.5*u);function h(e){s.frustum.fov=c["a"].lerp(u,d,e.time);const t=p/Math.tan(.5*s.frustum.fov);o(s,t)}s.frustum.far=p/Math.tan(.5*d)+1e7;const l=n.tweens.add({duration:t,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:h,complete:function(){s.frustum=i.frustum.clone(),a(e)}});e._currentTweens.push(l)}const oe=new o["a"],ae=new o["a"],ne=new o["a"],se=new o["a"],re=new o["a"],ce=new o["a"],ue=new d["a"],me=new h["a"],de=new o["a"],pe={position:void 0,direction:void 0,up:void 0,frustum:void 0};function he(e,t){t*=.5;const i=e._scene,a=i.camera,s=o["a"].clone(a.position,oe),c=o["a"].clone(a.direction,ae),m=o["a"].clone(a.up,ne),d=o["a"].negate(o["a"].UNIT_Z,re),p=o["a"].clone(o["a"].UNIT_Y,ce),h=se;if(t>0)o["a"].clone(o["a"].ZERO,se),h.z=5*i.mapProjection.ellipsoid.maximumRadius;else{o["a"].clone(s,se);const e=me;u["a"].multiplyByPoint(g["a"].TRANSFORM_2D,s,e.origin),u["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,c,e.direction);const t=i.globe;if(Object(n["a"])(t)){const a=t.pickWorldCoordinates(e,i,!0,de);Object(n["a"])(a)&&(u["a"].multiplyByPoint(g["a"].TRANSFORM_2D_INVERSE,a,h),h.z+=o["a"].distance(s,h))}}const l=ue;l.right=.5*h.z,l.left=-l.right,l.top=l.right*(i.drawingBufferHeight/i.drawingBufferWidth),l.bottom=-l.top;const f=pe;f.position=h,f.direction=d,f.up=p,f.frustum=l;const _=Ee(f);function b(e){te(s,h,e.time,a.position),te(c,d,e.time,a.direction),te(m,p,e.time,a.up),o["a"].cross(a.direction,a.up,a.right),o["a"].normalize(a.right,a.right),a._adjustOrthographicFrustum(!0)}function C(e,t){e.position.z=t}j(e,_);const w=i.tweens.add({duration:t,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:b,complete:function(){ie(e,t,f,C,_)}});e._currentTweens.push(w)}const le=new a["a"],fe={position:new o["a"],direction:new o["a"],up:new o["a"],position2D:new o["a"],direction2D:new o["a"],up2D:new o["a"],frustum:new d["a"]},_e={position:new o["a"],direction:new o["a"],up:new o["a"],frustum:void 0},ge=new o["a"],be=new h["a"],Ce=new u["a"],we=new o["a"];function Se(e,t,i){t*=.5;const a=e._scene,s=a.camera,r=fe;if(t>0)o["a"].clone(o["a"].ZERO,r.position),r.position.z=5*i.maximumRadius,o["a"].negate(o["a"].UNIT_Z,r.direction),o["a"].clone(o["a"].UNIT_Y,r.up);else{i.cartesianToCartographic(s.positionWC,le),a.mapProjection.project(le,r.position),o["a"].negate(o["a"].UNIT_Z,r.direction),o["a"].clone(o["a"].UNIT_Y,r.up);const e=be;o["a"].clone(r.position2D,e.origin);const t=o["a"].clone(s.directionWC,e.direction),c=i.scaleToGeodeticSurface(s.positionWC,we),m=_["a"].eastNorthUpToFixedFrame(c,i,Ce);u["a"].inverseTransformation(m,m),u["a"].multiplyByPointAsVector(m,t,t),u["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,t,t);const d=a.globe;if(Object(n["a"])(d)){const t=d.pickWorldCoordinates(e,a,!0,ge);if(Object(n["a"])(t)){const e=o["a"].distance(r.position2D,t);t.x+=e,o["a"].clone(t,r.position2D)}}}function c(e,t){e.position.x=t}u["a"].multiplyByPoint(g["a"].TRANSFORM_2D,r.position,r.position2D),u["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,r.direction,r.direction2D),u["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,r.up,r.up2D);const m=r.frustum;m.right=.5*r.position.z,m.left=-m.right,m.top=m.right*(a.drawingBufferHeight/a.drawingBufferWidth),m.bottom=-m.top;const d=_e;u["a"].multiplyByPoint(g["a"].TRANSFORM_2D_INVERSE,r.position2D,d.position),o["a"].clone(r.direction,d.direction),o["a"].clone(r.up,d.up),d.frustum=m;const p=Ee(d);function h(){ie(e,t,r,c,p)}j(e,p),Oe(e,t,r,h)}function ve(e,t,i,o){const a=e._scene,n=a.camera,s=n.frustum.right-n.frustum.left;n.frustum=i.frustum.clone();const u=n.frustum.fov,m=.5*c["a"].RADIANS_PER_DEGREE,d=s*Math.tan(.5*u);function p(e){n.frustum.fov=c["a"].lerp(m,u,e.time),n.position.z=d/Math.tan(.5*n.frustum.fov)}n.frustum.far=d/Math.tan(.5*m)+1e7,n.frustum.fov=m;const h=a.tweens.add({duration:t,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:p,complete:function(){o(e)}});e._currentTweens.push(h)}function ye(e,t,i,a){t*=.5;const n=e._scene,s=n.camera,c=o["a"].clone(i.position,X),u=o["a"].clone(i.direction,J),m=o["a"].clone(i.up,$);function d(){s.frustum=i.frustum.clone();const d=o["a"].clone(s.position,Y),p=o["a"].clone(s.direction,Z),h=o["a"].clone(s.up,K);function l(e){te(d,c,e.time,s.position),te(p,u,e.time,s.direction),te(h,m,e.time,s.up),o["a"].cross(s.direction,s.up,s.right),o["a"].normalize(s.right,s.right)}d.z=c.z;const f=n.tweens.add({duration:t,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:l,complete:function(){a(e)}});e._currentTweens.push(f)}n._mode=b["a"].MORPHING,e._morphToOrthographic?d():ve(e,0,i,d)}function Oe(e,t,i,a){const n=e._scene,s=n.camera,c=o["a"].clone(s.position,Y),u=o["a"].clone(s.direction,Z),m=o["a"].clone(s.up,K),d=o["a"].clone(i.position2D,X),p=o["a"].clone(i.direction2D,J),h=o["a"].clone(i.up2D,$);function l(e){te(c,d,e.time,s.position),te(u,p,e.time,s.direction),te(m,h,e.time,s.up),o["a"].cross(s.direction,s.up,s.right),o["a"].normalize(s.right,s.right),s._adjustOrthographicFrustum(!0)}const f=n.tweens.add({duration:t,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:l,complete:function(){Te(e,n,1,0,t,a)}});e._currentTweens.push(f)}function Te(e,t,i,o,a,s){const c={object:t,property:"morphTime",startValue:i,stopValue:o,duration:a,easingFunction:r["a"].QUARTIC_OUT};Object(n["a"])(s)&&(c.complete=function(){s(e)});const u=t.tweens.addProperty(c);e._currentTweens.push(u)}function De(e){return function(t){const i=t._scene;i._mode=b["a"].SCENE3D,i.morphTime=b["a"].getMorphTime(b["a"].SCENE3D),L(t);const a=i.camera;(t._previousMode!==b["a"].MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,o["a"].clone(e.position,a.position),o["a"].clone(e.direction,a.direction),o["a"].clone(e.up,a.up),o["a"].cross(a.direction,a.up,a.right),o["a"].normalize(a.right,a.right),a.frustum=e.frustum.clone());const s=a.frustum;i.frameState.useLogDepth&&(s.near=.1,s.far=1e10);const r=Object(n["a"])(t._completeMorph);t._completeMorph=void 0,i.camera.update(i.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,b["a"].SCENE3D,r)}}function Ee(e){return function(t){const i=t._scene;i._mode=b["a"].SCENE2D,i.morphTime=b["a"].getMorphTime(b["a"].SCENE2D),L(t);const a=i.camera;o["a"].clone(e.position,a.position),a.position.z=2*i.mapProjection.ellipsoid.maximumRadius,o["a"].clone(e.direction,a.direction),o["a"].clone(e.up,a.up),o["a"].cross(a.direction,a.up,a.right),o["a"].normalize(a.right,a.right),a.frustum=e.frustum.clone();const s=Object(n["a"])(t._completeMorph);t._completeMorph=void 0,i.camera.update(i.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,b["a"].SCENE2D,s)}}function xe(e){return function(t){const i=t._scene;i._mode=b["a"].COLUMBUS_VIEW,i.morphTime=b["a"].getMorphTime(b["a"].COLUMBUS_VIEW),L(t);const a=i.camera;(t._previousModeMode!==b["a"].MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,o["a"].clone(e.position,a.position),o["a"].clone(e.direction,a.direction),o["a"].clone(e.up,a.up),o["a"].cross(a.direction,a.up,a.right),o["a"].normalize(a.right,a.right));const s=a.frustum;i.frameState.useLogDepth&&(s.near=.1,s.far=1e10);const r=Object(n["a"])(t._completeMorph);t._completeMorph=void 0,i.camera.update(i.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,b["a"].COLUMBUS_VIEW,r)}}t["a"]=C},"0c80":function(e,t,i){"use strict";var o=i("77af"),a=i("670c"),n=i("be18"),s=i("a561"),r=i("bef8"),c=i("2f63"),u=i("93da"),m=i("52f0"),d=i("713f"),p=i("c34a"),h=i("f806"),l=i("a307");const f={},_=new s["a"](0,0,0,1);let g=new s["a"];const b=new o["a"],C=new a["a"],w=new a["a"];f.wgs84ToWindowCoordinates=function(e,t,i){return f.wgs84WithEyeOffsetToWindowCoordinates(e,t,n["a"].ZERO,i)};const S=new s["a"],v=new n["a"];function y(e,t,i,o){const a=i.viewMatrix,r=m["a"].multiplyByVector(a,s["a"].fromElements(e.x,e.y,e.z,1,S),S),c=n["a"].multiplyComponents(t,n["a"].normalize(r,v),v);return r.x+=t.x+c.x,r.y+=t.y+c.y,r.z+=c.z,m["a"].multiplyByVector(i.frustum.projectionMatrix,r,o)}const O=new r["a"](Math.PI,u["a"].PI_OVER_TWO),T=new n["a"],D=new n["a"];f.wgs84WithEyeOffsetToWindowCoordinates=function(e,t,i,o){const s=e.frameState,r=f.computeActualWgs84Position(s,t,_);if(!Object(c["a"])(r))return;const S=e.canvas,v=b;v.x=0,v.y=0,v.width=S.clientWidth,v.height=S.clientHeight;const E=e.camera;let x=!1;if(s.mode===l["a"].SCENE2D){const t=e.mapProjection,s=O,c=t.project(s,T),d=n["a"].clone(E.position,D),p=E.frustum.clone(),l=m["a"].computeViewportTransformation(v,0,1,new m["a"]),_=E.frustum.projectionMatrix,b=E.positionWC.y,P=n["a"].fromElements(u["a"].sign(b)*c.x-b,0,-E.positionWC.x),M=h["a"].pointToGLWindowCoordinates(_,l,P);if(0===b||M.x<=0||M.x>=S.clientWidth)x=!0;else{if(M.x>.5*S.clientWidth){v.width=M.x,E.frustum.right=c.x-b,g=y(r,i,E,g),f.clipToGLWindowCoordinates(v,g,C),v.x+=M.x,E.position.x=-E.position.x;const e=E.frustum.right;E.frustum.right=-E.frustum.left,E.frustum.left=-e,g=y(r,i,E,g),f.clipToGLWindowCoordinates(v,g,w)}else{v.x+=M.x,v.width-=M.x,E.frustum.left=-c.x-b,g=y(r,i,E,g),f.clipToGLWindowCoordinates(v,g,C),v.x=v.x-v.width,E.position.x=-E.position.x;const e=E.frustum.left;E.frustum.left=-E.frustum.right,E.frustum.right=-e,g=y(r,i,E,g),f.clipToGLWindowCoordinates(v,g,w)}n["a"].clone(d,E.position),E.frustum=p.clone(),o=a["a"].clone(C,o),(o.x<0||o.x>S.clientWidth)&&(o.x=w.x)}}if(s.mode!==l["a"].SCENE2D||x){if(g=y(r,i,E,g),g.z<0&&!(E.frustum instanceof d["a"])&&!(E.frustum instanceof p["a"]))return;o=f.clipToGLWindowCoordinates(v,g,o)}return o.y=S.clientHeight-o.y,o},f.wgs84ToDrawingBufferCoordinates=function(e,t,i){if(i=f.wgs84ToWindowCoordinates(e,t,i),Object(c["a"])(i))return f.transformWindowToDrawingBuffer(e,i,i)};const E=new n["a"],x=new r["a"];f.computeActualWgs84Position=function(e,t,i){const o=e.mode;if(o===l["a"].SCENE3D)return n["a"].clone(t,i);const a=e.mapProjection,s=a.ellipsoid.cartesianToCartographic(t,x);if(!Object(c["a"])(s))return;if(a.project(s,E),o===l["a"].COLUMBUS_VIEW)return n["a"].fromElements(E.z,E.x,E.y,i);if(o===l["a"].SCENE2D)return n["a"].fromElements(0,E.x,E.y,i);const r=e.morphTime;return n["a"].fromElements(u["a"].lerp(E.z,t.x,r),u["a"].lerp(E.x,t.y,r),u["a"].lerp(E.y,t.z,r),i)};const P=new n["a"],M=new n["a"],R=new m["a"];f.clipToGLWindowCoordinates=function(e,t,i){return n["a"].divideByScalar(t,t.w,P),m["a"].computeViewportTransformation(e,0,1,R),m["a"].multiplyByPoint(R,P,M),a["a"].fromCartesian3(M,i)},f.transformWindowToDrawingBuffer=function(e,t,i){const o=e.canvas,n=e.drawingBufferWidth/o.clientWidth,s=e.drawingBufferHeight/o.clientHeight;return a["a"].fromElements(t.x*n,t.y*s,i)};const F=new s["a"],I=new s["a"];f.drawingBufferToWgs84Coordinates=function(e,t,i,o){const a=e.context,r=a.uniformState,u=r.currentFrustum,d=u.x,p=u.y;if(e.frameState.useLogDepth){const e=i*r.log2FarDepthFromNearPlusOne,t=Math.pow(2,e)-1;i=p*(1-d/(t+d))/(p-d)}const h=e.view.passState.viewport,l=s["a"].clone(s["a"].UNIT_W,F);let f;l.x=(t.x-h.x)/h.width*2-1,l.y=(t.y-h.y)/h.height*2-1,l.z=2*i-1,l.w=1;let _=e.camera.frustum;if(Object(c["a"])(_.fovy)){f=m["a"].multiplyByVector(r.inverseViewProjection,l,I);const e=1/f.w;n["a"].multiplyByScalar(f,e,f)}else Object(c["a"])(_._offCenterFrustum)&&(_=_._offCenterFrustum),f=I,f.x=.5*(l.x*(_.right-_.left)+_.left+_.right),f.y=.5*(l.y*(_.top-_.bottom)+_.bottom+_.top),f.z=.5*(l.z*(d-p)-d-p),f.w=1,f=m["a"].multiplyByVector(r.inverseView,f,f);return n["a"].fromCartesian4(f,o)},t["a"]=f},"7fe1":function(e,t,i){"use strict";var o=i("bd8d"),a=i("7d62"),n=i("f845"),s=i("f630"),r=i("6ef5");function c(){this._numSamples=1,this._colorFramebuffer=new s["a"]({depthStencil:!0,supportsDepthTexture:!0}),this._idFramebuffer=new s["a"]({depthStencil:!0,supportsDepthTexture:!0}),this._idClearColor=new o["a"](0,0,0,0),this._clearCommand=new n["a"]({color:new o["a"](0,0,0,0),depth:1,owner:this})}function u(e){e._colorFramebuffer.destroy(),e._idFramebuffer.destroy()}Object.defineProperties(c.prototype,{framebuffer:{get:function(){return this._colorFramebuffer.framebuffer}},idFramebuffer:{get:function(){return this._idFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._colorFramebuffer.getDepthStencilTexture()}}}),c.prototype.update=function(e,t,i,o){const a=t.width,n=t.height,s=i?e.halfFloatingPointTexture?r["a"].HALF_FLOAT:r["a"].FLOAT:r["a"].UNSIGNED_BYTE;this._numSamples=o,this._colorFramebuffer.update(e,a,n,o,s),this._idFramebuffer.update(e,a,n)},c.prototype.clear=function(e,t,i){o["a"].clone(i,this._clearCommand.color),o["a"].clone(this._idClearColor,this._clearCommand.color),this._colorFramebuffer.clear(e,this._clearCommand,t),this._idFramebuffer.clear(e,this._clearCommand,t)},c.prototype.getFramebuffer=function(){return this._colorFramebuffer.framebuffer},c.prototype.getIdFramebuffer=function(){return this._idFramebuffer.framebuffer},c.prototype.prepareColorTextures=function(e){this._numSamples>1&&this._colorFramebuffer.prepareTextures(e)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return u(this),Object(a["a"])(this)},t["a"]=c},a307:function(e,t,i){"use strict";const o={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3,getMorphTime:function(e){return e===o.SCENE3D?1:e!==o.MORPHING?0:void 0}};t["a"]=Object.freeze(o)},da97:function(e,t,i){"use strict";var o=i("77af"),a=i("cef5"),n=i("b482"),s=i("be18"),r=i("bef8"),c=i("dc1c"),u=i("bd8d"),m=i("9541"),d=i("71ce"),p=i("2384"),h=i("535a"),l=i("2f63"),f=i("45c5"),_=i("7d62"),g=i("6cae"),b=i("21d7"),C=i("5e57"),w=i("3d7f"),S=i("d940"),v=i("c1e2"),y=i("66bf"),O=i("5ed2"),T=i("93da"),D=i("52f0"),E=i("4b0f"),x=i("f0be"),P=i("713f"),M=i("c34a"),R=i("4e1a"),F=i("4dc8"),I=i("75b2"),j=i("6a29"),L=i("f806"),N=i("f845"),A=i("aec5"),V=i("de02"),B=i("b997"),k=i("d289"),W=i("6dc0"),U=i("1331"),G=i("9dbf"),H=i("d150"),z=i("56d3"),q=i("0b8f"),Q=i("c965"),Y=i("81e1"),Z=i("ed8b"),K=i("9cff"),X=i("0838"),J=i("f3b8"),$=i("6b72"),ee=i("d57b"),te=i("4436"),ie=i("482f"),oe=i("1b40"),ae=i("01c0"),ne=i("3a8e"),se=i("d572"),re=i("9e4a"),ce=i("894b"),ue=i("738d"),me=i("a307"),de=i("0c80"),pe=i("059a"),he=i("59d5"),le=i("569f"),fe=i("3626"),_e=i("e065"),ge=i("cdd6"),be=i("619f"),Ce=i("ef77"),we=i("8e47");const Se=function(e){return function(){e.frameState.afterRender.push((function(){e.requestRender()}))}};function ve(e){e=Object(h["a"])(e,h["a"].EMPTY_OBJECT);const t=e.canvas;let i=e.creditContainer,a=e.creditViewport,n=Object(c["a"])(e.contextOptions);Object(l["a"])(n)||(n={}),Object(l["a"])(n.webgl)||(n.webgl={}),n.webgl.powerPreference=Object(h["a"])(n.webgl.powerPreference,"high-performance");const s=Object(l["a"])(i),r=new V["a"](t,n);s||(i=document.createElement("div"),i.style.position="absolute",i.style.bottom="0",i.style["text-shadow"]="0 0 2px #000000",i.style.color="#ffffff",i.style["font-size"]="10px",i.style["padding-right"]="5px",t.parentNode.appendChild(i)),Object(l["a"])(a)||(a=t.parentNode),this._id=Object(d["a"])(),this._jobScheduler=new te["a"],this._frameState=new J["a"](r,new q["a"](i," â€¢ ",a),this._jobScheduler),this._frameState.scene3DOnly=Object(h["a"])(e.scene3DOnly,!1),this._removeCreditContainer=!s,this._creditContainer=i,this._canvas=t,this._context=r,this._computeEngine=new A["a"](r),this._globe=void 0,this._globeTranslucencyState=new $["a"],this._primitives=new ue["a"],this._groundPrimitives=new ue["a"],this._globeHeight=void 0,this._cameraUnderground=!1,this._logDepthBuffer=r.fragmentDepth,this._logDepthBufferDirty=!0,this._tweens=new be["a"],this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._overlayCommandList=[];const m=!C["a"].isIPadOrIOS();this._useOIT=Object(h["a"])(e.orderIndependentTranslucency,m),this._executeOITFunction=void 0,this._depthPlane=new Y["a"](e.depthPlaneEllipsoidOffset),this._clearColorCommand=new N["a"]({color:new u["a"],stencil:0,owner:this}),this._depthClearCommand=new N["a"]({depth:1,owner:this}),this._stencilClearCommand=new N["a"]({stencil:0}),this._classificationStencilClearCommand=new N["a"]({stencil:0,renderState:W["a"].fromCache({stencilMask:fe["a"].CLASSIFICATION_MASK})}),this._depthOnlyRenderStateCache={},this._transitioner=new pe["a"](this),this._preUpdate=new b["a"],this._postUpdate=new b["a"],this._renderError=new b["a"],this._preRender=new b["a"],this._postRender=new b["a"],this._minimumDisableDepthTestDistance=0,this._debugInspector=new we["a"],this._msaaSamples=Object(h["a"])(e.msaaSamples,1),this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new b["a"],this.morphComplete=new b["a"],this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=u["a"].clone(u["a"].BLACK),this._mode=me["a"].SCENE3D,this._mapProjection=Object(l["a"])(e.mapProjection)?e.mapProjection:new w["a"],this.morphTime=1,this.farToNearRatio=1e3,this.logarithmicDepthFarToNearRatio=1e9,this.nearToFarDistance2D=175e4,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this.debugShowFramesPerSecond=!1,this.debugShowDepthFrustum=1,this.debugShowFrustumPlanes=!1,this._debugShowFrustumPlanes=!1,this._debugFrustumPlanes=void 0,this.useDepthPicking=!0,this.pickTranslucentDepth=!1,this.cameraEventWaitTime=500,this.fog=new X["a"],this._shadowMapCamera=new G["a"](this),this.shadowMap=new le["a"]({context:r,lightCamera:this._shadowMapCamera,enabled:Object(h["a"])(e.shadows,!1)}),this.invertClassification=!1,this.invertClassificationColor=u["a"].clone(u["a"].WHITE),this._actualInvertClassificationColor=u["a"].clone(this._invertClassificationColor),this._invertClassification=new ee["a"],this.focalLength=void 0,this.eyeSeparation=void 0,this.postProcessStages=new re["a"],this._brdfLutGenerator=new U["a"],this._performanceDisplay=void 0,this._debugVolume=void 0,this._screenSpaceCameraController=new he["a"](this),this._cameraUnderground=!1,this._mapMode2D=Object(h["a"])(e.mapMode2D,ie["a"].INFINITE_SCROLL),this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,renderTranslucentDepthForPick:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useInvertClassification:!1,usePostProcess:!1,usePostProcessSelected:!1,useWebVR:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0,this.requestRenderMode=Object(h["a"])(e.requestRenderMode,!1),this._renderRequested=!0,this.maximumRenderTimeChange=Object(h["a"])(e.maximumRenderTimeChange,0),this._lastRenderTime=void 0,this._frameRateMonitor=void 0,this._removeRequestListenerCallback=I["a"].requestCompletedEvent.addEventListener(Se(this)),this._removeTaskProcessorListenerCallback=j["a"].taskCompletedEvent.addEventListener(Se(this)),this._removeGlobeCallbacks=[];const p=new o["a"](0,0,r.drawingBufferWidth,r.drawingBufferHeight),f=new G["a"](this);this._logDepthBuffer&&(f.frustum.near=.1,f.frustum.far=1e10),this.preloadFlightCamera=new G["a"](this),this.preloadFlightCullingVolume=void 0,this._picking=new se["a"](this),this._defaultView=new Ce["a"](this,f,p),this._view=this._defaultView,this._hdr=void 0,this._hdrDirty=void 0,this.highDynamicRange=!1,this.gamma=2.2,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this._specularEnvironmentMapAtlas=void 0,this.light=new _e["a"],Fe(this,0,O["a"].now()),this.updateFrameState(),this.initializeFrame()}function ye(e,t){for(let o=0;o<e._removeGlobeCallbacks.length;++o)e._removeGlobeCallbacks[o]();e._removeGlobeCallbacks.length=0;const i=[];Object(l["a"])(t)&&(i.push(t.imageryLayersUpdatedEvent.addEventListener(Se(e))),i.push(t.terrainProviderChanged.addEventListener(Se(e)))),e._removeGlobeCallbacks=i}function Oe(e,t,i){const o=e._frameState,a=e._context,n=e._view.oit,s=o.shadowState.lightShadowMaps,r=o.shadowState.lightShadowsEnabled;let c=t.derivedCommands;Object(l["a"])(t.pickId)&&(c.picking=Z["a"].createPickDerivedCommand(e,t,a,c.picking)),t.pickOnly||(c.depth=Z["a"].createDepthOnlyDerivedCommand(e,t,a,c.depth)),c.originalCommand=t,e._hdr&&(c.hdr=Z["a"].createHdrCommand(t,a,c.hdr),t=c.hdr.command,c=t.derivedCommands),r&&t.receiveShadows&&(c.shadows=le["a"].createReceiveDerivedCommand(s,t,i,a,c.shadows)),t.pass===k["a"].TRANSLUCENT&&Object(l["a"])(n)&&n.isSupported()&&(r&&t.receiveShadows?(c.oit=Object(l["a"])(c.oit)?c.oit:{},c.oit.shadows=n.createDerivedCommands(c.shadows.receiveCommand,a,c.oit.shadows)):c.oit=n.createDerivedCommands(t,a,c.oit))}Object.defineProperties(ve.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return B["a"].maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return B["a"].maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},sampleHeightSupported:{get:function(){return this._context.depthTexture}},clampToHeightSupported:{get:function(){return this._context.depthTexture}},invertClassificationSupported:{get:function(){return this._context.depthTexture}},specularEnvironmentMapsSupported:{get:function(){return oe["a"].isSupported(this._context)}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy(),this._globe=e,ye(this,e)}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._view.camera},set:function(e){this._view.camera=e}},view:{get:function(){return this._view},set:function(e){this._view=e}},defaultView:{get:function(){return this._defaultView}},picking:{get:function(){return this._picking}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},jobScheduler:{get:function(){return this._jobScheduler}},frameState:{get:function(){return this._frameState}},environmentState:{get:function(){return this._environmentState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if(Object(l["a"])(this.globe))return this.globe.imageryLayers}},terrainProvider:{get:function(){if(Object(l["a"])(this.globe))return this.globe.terrainProvider},set:function(e){Object(l["a"])(this.globe)&&(this.globe.terrainProvider=e)}},terrainProviderChanged:{get:function(){if(Object(l["a"])(this.globe))return this.globe.terrainProviderChanged}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},lastRenderTime:{get:function(){return this._lastRenderTime}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._view.debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return this._useOIT}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){e===me["a"].SCENE2D?this.morphTo2D(0):e===me["a"].SCENE3D?this.morphTo3D(0):e===me["a"].COLUMBUS_VIEW&&this.morphToColumbusView(0),this._mode=e}},frustumCommandsList:{get:function(){return this._view.frustumCommandsList}},numberOfFrustums:{get:function(){return this._view.frustumCommandsList.length}},useWebVR:{get:function(){return this._useWebVR},set:function(e){this._useWebVR=e,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new G["a"](this),Object(l["a"])(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new K["a"](this)),this._aspectRatioVR=this.camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this.camera.frustum.aspectRatio=this._aspectRatioVR,this.camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}},splitPosition:{get:function(){return this._frameState.splitPosition},set:function(e){this._frameState.splitPosition=e}},imagerySplitPosition:{get:function(){return Object(f["a"])("Scene.imagerySplitPosition","Scene.imagerySplitPosition has been deprecated in Cesium 1.92. It will be removed in Cesium 1.94. Use splitPosition instead."),this._frameState.splitPosition},set:function(e){Object(f["a"])("Scene.imagerySplitPosition","Scene.imagerySplitPosition has been deprecated in Cesium 1.92. It will be removed in Cesium 1.94. Use splitPosition instead."),this._frameState.splitPosition=e}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(e){this._minimumDisableDepthTestDistance=e}},logarithmicDepthBuffer:{get:function(){return this._logDepthBuffer},set:function(e){e=this._context.fragmentDepth&&e,this._logDepthBuffer!==e&&(this._logDepthBuffer=e,this._logDepthBufferDirty=!0)}},gamma:{get:function(){return this._context.uniformState.gamma},set:function(e){this._context.uniformState.gamma=e}},highDynamicRange:{get:function(){return this._hdr},set:function(e){const t=this._context,i=e&&t.depthTexture&&(t.colorBufferFloat||t.colorBufferHalfFloat);this._hdrDirty=i!==this._hdr,this._hdr=i}},highDynamicRangeSupported:{get:function(){const e=this._context;return e.depthTexture&&(e.colorBufferFloat||e.colorBufferHalfFloat)}},cameraUnderground:{get:function(){return this._cameraUnderground}},msaaSamples:{get:function(){return this._msaaSamples},set:function(e){e=Math.min(e,B["a"].maximumSamples),this._msaaSamples=e}},msaaSupported:{get:function(){return this._context.msaa}},pixelRatio:{get:function(){return this._frameState.pixelRatio},set:function(e){this._frameState.pixelRatio=e}},opaqueFrustumNearOffset:{get:function(){return.9999}},globeHeight:{get:function(){return this._globeHeight}}}),ve.prototype.getCompressedTextureFormatSupported=function(e){const t=this.context;return("WEBGL_compressed_texture_s3tc"===e||"s3tc"===e)&&t.s3tc||("WEBGL_compressed_texture_pvrtc"===e||"pvrtc"===e)&&t.pvrtc||("WEBGL_compressed_texture_etc"===e||"etc"===e)&&t.etc||("WEBGL_compressed_texture_etc1"===e||"etc1"===e)&&t.etc1||("WEBGL_compressed_texture_astc"===e||"astc"===e)&&t.astc||("EXT_texture_compression_bptc"===e||"bc7"===e)&&t.bc7},ve.prototype.updateDerivedCommands=function(e){if(!Object(l["a"])(e.derivedCommands))return;const t=this._frameState,i=this._context;let o=!1;const a=t.shadowState.lastDirtyTime;e.lastDirtyTime!==a&&(e.lastDirtyTime=a,e.dirty=!0,o=!0);const n=t.useLogDepth,s=this._hdr,r=e.derivedCommands,c=Object(l["a"])(r.logDepth),u=Object(l["a"])(r.hdr),m=Object(l["a"])(r.originalCommand),d=n&&!c,p=s&&!u,h=(!n||!s)&&!m;if(e.dirty=e.dirty||d||p||h,e.dirty){e.dirty=!1;const a=t.shadowState.shadowMaps,n=t.shadowState.shadowsEnabled;n&&e.castShadows&&(r.shadows=le["a"].createCastDerivedCommand(a,e,o,i,r.shadows)),(c||d)&&(r.logDepth=Z["a"].createLogDepthCommand(e,i,r.logDepth),Oe(this,r.logDepth.command,o)),(m||h)&&Oe(this,e,o)}};const Te=new z["a"]({pass:H["a"].RENDER}),De=new z["a"]({pass:H["a"].PRELOAD}),Ee=new z["a"]({pass:H["a"].PRELOAD_FLIGHT}),xe=new z["a"]({pass:H["a"].REQUEST_RENDER_MODE_DEFER_CHECK}),Pe=new a["a"];let Me;function Re(e){const t=e.globe;if(e._mode===me["a"].SCENE3D&&Object(l["a"])(t)&&t.show&&!e._cameraUnderground&&!e._globeTranslucencyState.translucent){const i=t.ellipsoid,o=e.frameState.minimumTerrainHeight;return Pe.radius=i.minimumRadius+o,Me=x["a"].fromBoundingSphere(Pe,e.camera.positionWC,Me),Me}}function Fe(e,t,i){const o=e._frameState;o.frameNumber=t,o.time=O["a"].clone(i,o.time)}ve.prototype.clearPasses=function(e){e.render=!1,e.pick=!1,e.depth=!1,e.postProcess=!1,e.offscreen=!1},ve.prototype.updateFrameState=function(){const e=this.camera,t=this._frameState;t.commandList.length=0,t.shadowMaps.length=0,t.brdfLutGenerator=this._brdfLutGenerator,t.environmentMap=this.skyBox&&this.skyBox._cubeMap,t.mode=this._mode,t.morphTime=this.morphTime,t.mapProjection=this.mapProjection,t.camera=e,t.cullingVolume=e.frustum.computeCullingVolume(e.positionWC,e.directionWC,e.upWC),t.occluder=Re(this),t.minimumTerrainHeight=0,t.minimumDisableDepthTestDistance=this._minimumDisableDepthTestDistance,t.invertClassification=this.invertClassification,t.useLogDepth=this._logDepthBuffer&&!(this.camera.frustum instanceof P["a"]||this.camera.frustum instanceof M["a"]),t.light=this.light,t.cameraUnderground=this._cameraUnderground,t.globeTranslucencyState=this._globeTranslucencyState,Object(l["a"])(this.globe)&&(t.terrainExaggeration=this.globe.terrainExaggeration,t.terrainExaggerationRelativeHeight=this.globe.terrainExaggerationRelativeHeight),Object(l["a"])(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready?(t.specularEnvironmentMaps=this._specularEnvironmentMapAtlas.texture,t.specularEnvironmentMapsMaximumLOD=this._specularEnvironmentMapAtlas.maximumMipmapLevel):(t.specularEnvironmentMaps=void 0,t.specularEnvironmentMapsMaximumLOD=void 0),t.sphericalHarmonicCoefficients=this.sphericalHarmonicCoefficients,this._actualInvertClassificationColor=u["a"].clone(this.invertClassificationColor,this._actualInvertClassificationColor),ee["a"].isTranslucencySupported(this._context)||(this._actualInvertClassificationColor.alpha=1),t.invertClassificationColor=this._actualInvertClassificationColor,Object(l["a"])(this.globe)?t.maximumScreenSpaceError=this.globe.maximumScreenSpaceError:t.maximumScreenSpaceError=2,this.clearPasses(t.passes),t.tilesetPassState=void 0},ve.prototype.isVisible=function(e,t,i){return Object(l["a"])(e)&&(!Object(l["a"])(e.boundingVolume)||!e.cull||t.computeVisibility(e.boundingVolume)!==y["a"].OUTSIDE&&(!Object(l["a"])(i)||!e.occlude||!e.boundingVolume.isOccluded(i)))};let Ie=new D["a"](0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);function je(e,t,i,o){const a=t._frameState,r=a.context,c=e.boundingVolume;let u;Object(l["a"])(t._debugVolume)&&t._debugVolume.destroy();let d=s["a"].clone(c.center);if(a.mode!==me["a"].SCENE3D){d=D["a"].multiplyByPoint(Ie,d,d);const e=a.mapProjection,t=e.unproject(d);d=e.ellipsoid.cartographicToCartesian(t)}if(Object(l["a"])(c.radius)){const e=c.radius;u=v["a"].toWireframe(g["a"].createGeometry(new g["a"]({radii:new s["a"](e,e,e),vertexFormat:ne["a"].FLAT_VERTEX_FORMAT}))),t._debugVolume=new ce["a"]({geometryInstances:new S["a"]({geometry:u,modelMatrix:D["a"].fromTranslation(d),attributes:{color:new m["a"](1,0,0,1)}}),appearance:new ne["a"]({flat:!0,translucent:!1}),asynchronous:!1})}else{const e=c.halfAxes;u=v["a"].toWireframe(n["a"].createGeometry(n["a"].fromDimensions({dimensions:new s["a"](2,2,2),vertexFormat:ne["a"].FLAT_VERTEX_FORMAT}))),t._debugVolume=new ce["a"]({geometryInstances:new S["a"]({geometry:u,modelMatrix:D["a"].fromRotationTranslation(e,d,new D["a"]),attributes:{color:new m["a"](1,0,0,1)}}),appearance:new ne["a"]({flat:!0,translucent:!1}),asynchronous:!1})}const p=a.commandList,h=a.commandList=[];if(t._debugVolume.update(a),e=h[0],a.useLogDepth){const t=Z["a"].createLogDepthCommand(e,r);e=t.command}let f;Object(l["a"])(o)&&(f=i.framebuffer,i.framebuffer=o),e.execute(r,i),Object(l["a"])(f)&&(i.framebuffer=f),a.commandList=p}function Le(e,t,i,o,a){const n=t._frameState;if(Object(l["a"])(t.debugCommandFilter)&&!t.debugCommandFilter(e))return;if(e instanceof N["a"])return void e.execute(i,o);e.debugShowBoundingVolume&&Object(l["a"])(e.boundingVolume)&&je(e,t,o,a),n.useLogDepth&&Object(l["a"])(e.derivedCommands.logDepth)&&(e=e.derivedCommands.logDepth.command);const s=n.passes;if(!s.pick&&!s.depth&&t._hdr&&Object(l["a"])(e.derivedCommands)&&Object(l["a"])(e.derivedCommands.hdr)&&(e=e.derivedCommands.hdr.command),s.pick||s.depth){if(s.pick&&!s.depth&&Object(l["a"])(e.derivedCommands.picking))return e=e.derivedCommands.picking.pickCommand,void e.execute(i,o);if(Object(l["a"])(e.derivedCommands.depth))return e=e.derivedCommands.depth.depthOnlyCommand,void e.execute(i,o)}t.debugShowCommands||t.debugShowFrustums?t._debugInspector.executeDebugShowFrustumsCommand(t,e,o):n.shadowState.lightShadowsEnabled&&e.receiveShadows&&Object(l["a"])(e.derivedCommands.shadows)?e.derivedCommands.shadows.receiveCommand.execute(i,o):e.execute(i,o)}function Ne(e,t,i,o){const a=t._frameState;let n=e.derivedCommands;Object(l["a"])(n)&&(a.useLogDepth&&Object(l["a"])(n.logDepth)&&(e=n.logDepth.command),n=e.derivedCommands,Object(l["a"])(n.picking)?(e=n.picking.pickCommand,e.execute(i,o)):Object(l["a"])(n.depth)&&(e=n.depth.depthOnlyCommand,e.execute(i,o)))}function Ae(e,t,i){return t.boundingVolume.distanceSquaredTo(i)-e.boundingVolume.distanceSquaredTo(i)}function Ve(e,t,i){return e.boundingVolume.distanceSquaredTo(i)-t.boundingVolume.distanceSquaredTo(i)+T["a"].EPSILON12}function Be(e,t,i,o,a){const n=e.context;Object(E["a"])(o,Ae,e.camera.positionWC),Object(l["a"])(a)&&t(a.unclassifiedCommand,e,n,i);const s=o.length;for(let r=0;r<s;++r)t(o[r],e,n,i)}function ke(e,t,i,o,a){const n=e.context;Object(E["a"])(o,Ve,e.camera.positionWC),Object(l["a"])(a)&&t(a.unclassifiedCommand,e,n,i);const s=o.length;for(let r=0;r<s;++r)t(o[r],e,n,i)}Ie=D["a"].inverseTransformation(Ie,Ie);const We=new R["a"],Ue=new F["a"],Ge=new P["a"],He=new M["a"];function ze(e,t){const i=e.camera,o=e.context,a=e.frameState,n=o.uniformState;let s;n.updateCamera(i),s=Object(l["a"])(i.frustum.fov)?i.frustum.clone(We):Object(l["a"])(i.frustum.infiniteProjectionMatrix)?i.frustum.clone(Ue):Object(l["a"])(i.frustum.width)?i.frustum.clone(Ge):i.frustum.clone(He),s.near=i.frustum.near,s.far=i.frustum.far,n.updateFrustum(s),n.updatePass(k["a"].ENVIRONMENT);const r=a.passes,c=r.pick,u=e._environmentState,m=e._view,d=u.renderTranslucentDepthForPick,p=u.useWebVR;if(!c){const i=u.skyBoxCommand;if(Object(l["a"])(i)&&Le(i,e,o,t),u.isSkyAtmosphereVisible&&Le(u.skyAtmosphereCommand,e,o,t),u.isSunVisible&&(u.sunDrawCommand.execute(o,t),e.sunBloom&&!p)){let i;i=u.useGlobeDepthFramebuffer?m.globeDepth.framebuffer:u.usePostProcess?m.sceneFramebuffer.framebuffer:u.originalFramebuffer,e._sunPostProcess.execute(o),e._sunPostProcess.copy(o,i),t.framebuffer=i}u.isMoonVisible&&u.moonCommand.execute(o,t)}let h;u.useOIT?(Object(l["a"])(e._executeOITFunction)||(e._executeOITFunction=function(e,t,i,a,n){m.globeDepth.prepareColorTextures(o),m.oit.executeCommands(e,t,i,a,n)}),h=e._executeOITFunction):h=r.render?Be:ke;const f=m.frustumCommandsList,_=f.length,g=u.clearGlobeDepth,b=u.useDepthPlane,C=e._globeTranslucencyState,w=C.translucent,S=e._view.globeTranslucencyFramebuffer,v=e._depthClearCommand,y=e._stencilClearCommand,O=e._classificationStencilClearCommand,T=e._depthPlane,D=u.usePostProcessSelected,E=i.position.z;let x;for(let P=0;P<_;++P){const r=_-P-1,p=f[r];e.mode===me["a"].SCENE2D?(i.position.z=E-p.near+1,s.far=Math.max(1,p.far-p.near),s.near=1,n.update(a),n.updateFrustum(s)):(s.near=0!==r?p.near*e.opaqueFrustumNearOffset:p.near,s.far=p.far,n.updateFrustum(s)),v.execute(o,t),o.stencilBuffer&&y.execute(o,t),n.updatePass(k["a"].GLOBE);let M=p.commands[k["a"].GLOBE],R=p.indices[k["a"].GLOBE];if(w)C.executeGlobeCommands(p,Le,S,e,t);else for(x=0;x<R;++x)Le(M[x],e,o,t);const F=m.globeDepth;if(Object(l["a"])(F)&&u.useGlobeDepthFramebuffer&&F.executeCopyDepth(o,t),!u.renderTranslucentDepthForPick)if(n.updatePass(k["a"].TERRAIN_CLASSIFICATION),M=p.commands[k["a"].TERRAIN_CLASSIFICATION],R=p.indices[k["a"].TERRAIN_CLASSIFICATION],w)C.executeGlobeClassificationCommands(p,Le,S,e,t);else for(x=0;x<R;++x)Le(M[x],e,o,t);if(g&&(v.execute(o,t),b&&T.execute(o,t)),!u.useInvertClassification||c||u.renderTranslucentDepthForPick){for(n.updatePass(k["a"].CESIUM_3D_TILE),M=p.commands[k["a"].CESIUM_3D_TILE],R=p.indices[k["a"].CESIUM_3D_TILE],x=0;x<R;++x)Le(M[x],e,o,t);if(R>0&&(Object(l["a"])(F)&&u.useGlobeDepthFramebuffer&&(F.prepareColorTextures(o,g),F.executeUpdateDepth(o,t,g,F.depthStencilTexture)),!u.renderTranslucentDepthForPick))for(n.updatePass(k["a"].CESIUM_3D_TILE_CLASSIFICATION),M=p.commands[k["a"].CESIUM_3D_TILE_CLASSIFICATION],R=p.indices[k["a"].CESIUM_3D_TILE_CLASSIFICATION],x=0;x<R;++x)Le(M[x],e,o,t)}else{e._invertClassification.clear(o,t);const i=t.framebuffer;for(t.framebuffer=e._invertClassification._fbo.framebuffer,n.updatePass(k["a"].CESIUM_3D_TILE),M=p.commands[k["a"].CESIUM_3D_TILE],R=p.indices[k["a"].CESIUM_3D_TILE],x=0;x<R;++x)Le(M[x],e,o,t);for(Object(l["a"])(F)&&u.useGlobeDepthFramebuffer&&(e._invertClassification.prepareTextures(o),F.executeUpdateDepth(o,t,g,e._invertClassification._fbo.getDepthStencilTexture())),n.updatePass(k["a"].CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW),M=p.commands[k["a"].CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],R=p.indices[k["a"].CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],x=0;x<R;++x)Le(M[x],e,o,t);for(t.framebuffer=i,e._invertClassification.executeClassified(o,t),1===a.invertClassificationColor.alpha&&e._invertClassification.executeUnclassified(o,t),R>0&&o.stencilBuffer&&O.execute(o,t),n.updatePass(k["a"].CESIUM_3D_TILE_CLASSIFICATION),M=p.commands[k["a"].CESIUM_3D_TILE_CLASSIFICATION],R=p.indices[k["a"].CESIUM_3D_TILE_CLASSIFICATION],x=0;x<R;++x)Le(M[x],e,o,t)}for(R>0&&o.stencilBuffer&&y.execute(o,t),n.updatePass(k["a"].OPAQUE),M=p.commands[k["a"].OPAQUE],R=p.indices[k["a"].OPAQUE],x=0;x<R;++x)Le(M[x],e,o,t);let I;0!==r&&e.mode!==me["a"].SCENE2D&&(s.near=p.near,n.updateFrustum(s)),!c&&u.useInvertClassification&&a.invertClassificationColor.alpha<1&&(I=e._invertClassification),n.updatePass(k["a"].TRANSLUCENT),M=p.commands[k["a"].TRANSLUCENT],M.length=p.indices[k["a"].TRANSLUCENT],h(e,Le,t,M,I);const j=p.indices[k["a"].CESIUM_3D_TILE_CLASSIFICATION]>0;if(j&&m.translucentTileClassification.isSupported()&&(m.translucentTileClassification.executeTranslucentCommands(e,Le,t,M,F.depthStencilTexture),m.translucentTileClassification.executeClassificationCommands(e,Le,t,p)),o.depthTexture&&e.useDepthPicking&&(u.useGlobeDepthFramebuffer||d)){const i=F.depthStencilTexture,a=e._picking.getPickDepth(e,r);a.update(o,i),a.executeCopyDepth(o,t)}if(c||!D)continue;const L=t.framebuffer;if(t.framebuffer=m.sceneFramebuffer.getIdFramebuffer(),s.near=0!==r?p.near*e.opaqueFrustumNearOffset:p.near,s.far=p.far,n.updateFrustum(s),n.updatePass(k["a"].GLOBE),M=p.commands[k["a"].GLOBE],R=p.indices[k["a"].GLOBE],w)C.executeGlobeCommands(p,Ne,S,e,t);else for(x=0;x<R;++x)Ne(M[x],e,o,t);for(g&&(v.framebuffer=t.framebuffer,v.execute(o,t),v.framebuffer=void 0),g&&b&&T.execute(o,t),n.updatePass(k["a"].CESIUM_3D_TILE),M=p.commands[k["a"].CESIUM_3D_TILE],R=p.indices[k["a"].CESIUM_3D_TILE],x=0;x<R;++x)Ne(M[x],e,o,t);for(n.updatePass(k["a"].OPAQUE),M=p.commands[k["a"].OPAQUE],R=p.indices[k["a"].OPAQUE],x=0;x<R;++x)Ne(M[x],e,o,t);for(n.updatePass(k["a"].TRANSLUCENT),M=p.commands[k["a"].TRANSLUCENT],R=p.indices[k["a"].TRANSLUCENT],x=0;x<R;++x)Ne(M[x],e,o,t);t.framebuffer=L}}function qe(e){const t=e.context.uniformState;t.updatePass(k["a"].COMPUTE);const i=e._environmentState.sunComputeCommand;Object(l["a"])(i)&&i.execute(e._computeEngine);const o=e._computeCommandList,a=o.length;for(let n=0;n<a;++n)o[n].execute(e._computeEngine)}function Qe(e,t){const i=e.context.uniformState;i.updatePass(k["a"].OVERLAY);const o=e.context,a=e._overlayCommandList,n=a.length;for(let s=0;s<n;++s)a[s].execute(o,t)}function Ye(e,t,i){const o=i.shadowMapCullingVolume,a=i.isPointLight,n=i.passes,s=n.length,r=t.length;for(let c=0;c<r;++c){const i=t[c];if(e.updateDerivedCommands(i),i.castShadows&&(i.pass===k["a"].GLOBE||i.pass===k["a"].CESIUM_3D_TILE||i.pass===k["a"].OPAQUE||i.pass===k["a"].TRANSLUCENT)&&e.isVisible(i,o))if(a)for(let e=0;e<s;++e)n[e].commandList.push(i);else if(1===s)n[0].commandList.push(i);else{let t=!1;for(let o=s-1;o>=0;--o){const a=n[o].cullingVolume;if(e.isVisible(i,a))n[o].commandList.push(i),t=!0;else if(t)break}}}}function Ze(e){const t=e.frameState,i=t.shadowState.shadowMaps,o=i.length;if(!t.shadowState.shadowsEnabled)return;const a=e.context,n=a.uniformState;for(let s=0;s<o;++s){const t=i[s];if(t.outOfView)continue;const o=t.passes,r=o.length;for(let e=0;e<r;++e)o[e].commandList.length=0;const c=e.frameState.commandList;Ye(e,c,t);for(let i=0;i<r;++i){const o=t.passes[i];n.updateCamera(o.camera),t.updatePass(a,i);const r=o.commandList.length;for(let t=0;t<r;++t){const i=o.commandList[t];n.updatePass(i.pass),Le(i.derivedCommands.shadows.castCommands[s],e,a,o.passState)}}}}const Ke=new s["a"];function Xe(e,t,i){const o=e._view,a=o.camera,n=e._environmentState,r=n.renderTranslucentDepthForPick;pt(e,t,i),dt(e),o.createPotentiallyVisibleSet(e),qe(e),r||Ze(e);const c=t.viewport;c.x=0,c.y=0,c.width=.5*c.width;const u=G["a"].clone(a,e._cameraVR);u.frustum=a.frustum;const m=a.frustum.near,d=m*Object(h["a"])(e.focalLength,5),p=Object(h["a"])(e.eyeSeparation,d/30),l=s["a"].multiplyByScalar(u.right,.5*p,Ke);a.frustum.aspectRatio=c.width/c.height;const f=.5*p*m/d;s["a"].add(u.position,l,a.position),a.frustum.xOffset=f,ze(e,t),c.x=c.width,s["a"].subtract(u.position,l,a.position),a.frustum.xOffset=-f,ze(e,t),G["a"].clone(u,a)}ve.prototype.updateAndExecuteCommands=function(e,t){const i=this._frameState,o=i.mode,a=this._environmentState.useWebVR;a?Xe(this,e,t):o!==me["a"].SCENE2D||this._mapMode2D===ie["a"].ROTATE?rt(!0,this,e,t):(pt(this,e,t),st(this,e))};const Je=new r["a"](Math.PI,T["a"].PI_OVER_TWO),$e=new s["a"],et=new s["a"],tt=new D["a"],it=new D["a"],ot=new s["a"],at=new s["a"],nt=new o["a"];function st(e,t){const i=e.context,a=e.frameState,n=e.camera,r=t.viewport,c=o["a"].clone(r,nt);t.viewport=c;const u=Je,m=$e,d=e.mapProjection;d.project(u,m);const p=s["a"].clone(n.position,et),h=D["a"].clone(n.transform,it),l=n.frustum.clone();n._setTransform(D["a"].IDENTITY);const f=D["a"].computeViewportTransformation(c,0,1,tt),_=n.frustum.projectionMatrix,g=n.positionWC.y,b=s["a"].fromElements(T["a"].sign(g)*m.x-g,0,-n.positionWC.x,ot),C=L["a"].pointToGLWindowCoordinates(_,f,b,at);C.x=Math.floor(C.x);const w=c.x,S=c.width;if(0===g||C.x<=w||C.x>=w+S)rt(!0,e,t);else if(Math.abs(w+.5*S-C.x)<1)c.width=C.x-c.x,n.position.x*=T["a"].sign(n.position.x),n.frustum.right=0,a.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),i.uniformState.update(a),rt(!0,e,t),c.x=C.x,n.position.x=-n.position.x,n.frustum.right=-n.frustum.left,n.frustum.left=0,a.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),i.uniformState.update(a),rt(!1,e,t);else if(C.x>w+.5*S){c.width=C.x-w;const o=n.frustum.right;n.frustum.right=m.x-g,a.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),i.uniformState.update(a),rt(!0,e,t),c.x=C.x,c.width=w+S-C.x,n.position.x=-n.position.x,n.frustum.left=-n.frustum.right,n.frustum.right=o-2*n.frustum.right,a.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),i.uniformState.update(a),rt(!1,e,t)}else{c.x=C.x,c.width=w+S-C.x;const o=n.frustum.left;n.frustum.left=-m.x-g,a.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),i.uniformState.update(a),rt(!0,e,t),c.x=w,c.width=C.x-w,n.position.x=-n.position.x,n.frustum.right=-n.frustum.left,n.frustum.left=o-2*n.frustum.left,a.cullingVolume=n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC),i.uniformState.update(a),rt(!1,e,t)}n._setTransform(h),s["a"].clone(p,n.position),n.frustum=l.clone(),t.viewport=r}function rt(e,t,i,o){const a=t._environmentState,n=t._view,s=a.renderTranslucentDepthForPick;e||(t.frameState.commandList.length=0),dt(t),n.createPotentiallyVisibleSet(t),e&&(Object(l["a"])(o)&&pt(t,i,o),qe(t),s||Ze(t)),ze(t,i)}const ct=new p["a"];function ut(e){const t=e._frameState;e.debugShowFrustumPlanes!==e._debugShowFrustumPlanes&&(e.debugShowFrustumPlanes?e._debugFrustumPlanes=new Q["a"]({camera:e.camera,updateOnChange:!1,frustumSplits:t.frustumSplits}):e._debugFrustumPlanes=e._debugFrustumPlanes&&e._debugFrustumPlanes.destroy(),e._debugShowFrustumPlanes=e.debugShowFrustumPlanes),Object(l["a"])(e._debugFrustumPlanes)&&e._debugFrustumPlanes.update(t)}function mt(e){const t=e._frameState,i=t.shadowMaps,o=i.length,a=o>0&&!t.passes.pick&&e.mode===me["a"].SCENE3D;if(a!==t.shadowState.shadowsEnabled&&(++t.shadowState.lastDirtyTime,t.shadowState.shadowsEnabled=a),t.shadowState.lightShadowsEnabled=!1,a){for(let e=0;e<o;++e)if(i[e]!==t.shadowState.shadowMaps[e]){++t.shadowState.lastDirtyTime;break}t.shadowState.shadowMaps.length=0,t.shadowState.lightShadowMaps.length=0;for(let e=0;e<o;++e){const o=i[e];o.update(t),t.shadowState.shadowMaps.push(o),o.fromLightSource&&(t.shadowState.lightShadowMaps.push(o),t.shadowState.lightShadowsEnabled=!0),o.dirty&&(++t.shadowState.lastDirtyTime,o.dirty=!1)}}}function dt(e){const t=e._frameState;e._groundPrimitives.update(t),e._primitives.update(t),ut(e),mt(e),e._globe&&e._globe.render(t)}function pt(e,t,i){const o=e._context,a=e._frameState,n=e._environmentState,s=e._view,r=e._frameState.passes,c=r.pick;Object(l["a"])(s.globeDepth)&&(s.globeDepth.picking=c);const m=n.useWebVR;n.originalFramebuffer=t.framebuffer,Object(l["a"])(e.sun)&&e.sunBloom!==e._sunBloom?(e.sunBloom&&!m?e._sunPostProcess=new ge["a"]:Object(l["a"])(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy()),e._sunBloom=e.sunBloom):!Object(l["a"])(e.sun)&&Object(l["a"])(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy(),e._sunBloom=!1);const d=e._clearColorCommand;u["a"].clone(i,d.color),d.execute(o,t);const p=n.useGlobeDepthFramebuffer=Object(l["a"])(s.globeDepth);p&&(s.globeDepth.update(o,t,s.viewport,e.msaaSamples,e._hdr,n.clearGlobeDepth),s.globeDepth.clear(o,t,i));const h=s.oit,f=n.useOIT=!c&&Object(l["a"])(h)&&h.isSupported();f&&(h.update(o,t,s.globeDepth.colorFramebufferManager,e._hdr,e.msaaSamples),h.clear(o,t,i),n.useOIT=h.isSupported());const _=e.postProcessStages;let g=n.usePostProcess=!c&&(e._hdr||_.length>0||_.ambientOcclusion.enabled||_.fxaa.enabled||_.bloom.enabled);n.usePostProcessSelected=!1,g&&(s.sceneFramebuffer.update(o,s.viewport,e._hdr,e.msaaSamples),s.sceneFramebuffer.clear(o,t,i),_.update(o,a.useLogDepth,e._hdr),_.clear(o),g=n.usePostProcess=_.ready,n.usePostProcessSelected=g&&_.hasSelected),n.isSunVisible&&e.sunBloom&&!m?(t.framebuffer=e._sunPostProcess.update(t),e._sunPostProcess.clear(o,t,i)):p?t.framebuffer=s.globeDepth.framebuffer:g&&(t.framebuffer=s.sceneFramebuffer.framebuffer),Object(l["a"])(t.framebuffer)&&d.execute(o,t);const b=n.useInvertClassification=!c&&Object(l["a"])(t.framebuffer)&&e.invertClassification;if(b){let i;if(1===e.frameState.invertClassificationColor.alpha&&n.useGlobeDepthFramebuffer&&(i=s.globeDepth.framebuffer),Object(l["a"])(i)||o.depthTexture){if(e._invertClassification.previousFramebuffer=i,e._invertClassification.update(o,e.msaaSamples,s.globeDepth.colorFramebufferManager),e._invertClassification.clear(o,t),e.frameState.invertClassificationColor.alpha<1&&f){const t=e._invertClassification.unclassifiedCommand,i=t.derivedCommands;i.oit=h.createDerivedCommands(t,o,i.oit)}}else n.useInvertClassification=!1}e._globeTranslucencyState.translucent&&s.globeTranslucencyFramebuffer.updateAndClear(e._hdr,s.viewport,o,t)}function ht(e){const t=e._frameState.afterRender;for(let i=0,o=t.length;i<o;++i)t[i](),e.requestRender();t.length=0}function lt(e){const t=e._globe,i=e.camera,o=i.positionCartographic;if(Object(l["a"])(t)&&t.show&&Object(l["a"])(o))return t.getHeight(o)}function ft(e){const t=e.camera,i=e._mode,o=e.globe,a=e._screenSpaceCameraController,n=t.positionCartographic;if(!Object(l["a"])(n))return!1;if(!a.onMap()&&n.height<0)return!0;if(!Object(l["a"])(o)||!o.show||i===me["a"].SCENE2D||i===me["a"].MORPHING)return!1;const s=e._globeHeight;return Object(l["a"])(s)&&n.height<s}function _t(e,t){if(e.debugShowFramesPerSecond){if(!Object(l["a"])(e._performanceDisplay)){const t=document.createElement("div");t.className="cesium-performanceDisplay-defaultContainer";const i=e._canvas.parentNode;i.appendChild(t);const o=new ae["a"]({container:t});e._performanceDisplay=o,e._performanceContainer=t}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else Object(l["a"])(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}function gt(e){e._jobScheduler.resetBudgets();const t=e._frameState,i=e.primitives;i.prePassesUpdate(t),Object(l["a"])(e.globe)&&e.globe.update(t),e._picking.update(),t.creditDisplay.update()}function bt(e){const t=e._frameState,i=e.primitives;i.postPassesUpdate(t),I["a"].update()}ve.prototype.updateEnvironment=function(){const e=this._frameState,t=this._view,i=this._environmentState,o=e.passes.render,a=e.passes.offscreen,n=this.skyAtmosphere,s=this.globe,r=this._globeTranslucencyState;if(!o||this._mode!==me["a"].SCENE2D&&t.camera.frustum instanceof P["a"]||!r.environmentVisible)i.skyAtmosphereCommand=void 0,i.skyBoxCommand=void 0,i.sunDrawCommand=void 0,i.sunComputeCommand=void 0,i.moonCommand=void 0;else{Object(l["a"])(n)?(Object(l["a"])(s)&&(n.setDynamicAtmosphereColor(s.enableLighting&&s.dynamicAtmosphereLighting,s.dynamicAtmosphereLightingFromSun),i.isReadyForAtmosphere=i.isReadyForAtmosphere||s._surface._tilesToRender.length>0),i.skyAtmosphereCommand=n.update(e,s),Object(l["a"])(i.skyAtmosphereCommand)&&this.updateDerivedCommands(i.skyAtmosphereCommand)):i.skyAtmosphereCommand=void 0,i.skyBoxCommand=Object(l["a"])(this.skyBox)?this.skyBox.update(e,this._hdr):void 0;const o=Object(l["a"])(this.sun)?this.sun.update(e,t.passState,this._hdr):void 0;i.sunDrawCommand=Object(l["a"])(o)?o.drawCommand:void 0,i.sunComputeCommand=Object(l["a"])(o)?o.computeCommand:void 0,i.moonCommand=Object(l["a"])(this.moon)?this.moon.update(e):void 0}const c=i.clearGlobeDepth=Object(l["a"])(s)&&s.show&&(!s.depthTestAgainstTerrain||this.mode===me["a"].SCENE2D),u=i.useDepthPlane=c&&this.mode===me["a"].SCENE3D&&r.useDepthPlane;u&&this._depthPlane.update(e),i.renderTranslucentDepthForPick=!1,i.useWebVR=this._useWebVR&&this.mode!==me["a"].SCENE2D&&!a;const m=e.mode!==me["a"].SCENE3D||r.sunVisibleThroughGlobe?void 0:e.occluder;let d=e.cullingVolume;const p=ct.planes;for(let l=0;l<5;++l)p[l]=d.planes[l];d=ct,i.isSkyAtmosphereVisible=Object(l["a"])(i.skyAtmosphereCommand)&&i.isReadyForAtmosphere,i.isSunVisible=this.isVisible(i.sunDrawCommand,d,m),i.isMoonVisible=this.isVisible(i.moonCommand,d,m);const h=this.specularEnvironmentMaps;let f=this._specularEnvironmentMapAtlas;!Object(l["a"])(h)||Object(l["a"])(f)&&f.url===h?!Object(l["a"])(h)&&Object(l["a"])(f)&&(f.destroy(),this._specularEnvironmentMapAtlas=void 0):(f=f&&f.destroy(),this._specularEnvironmentMapAtlas=new oe["a"](h)),Object(l["a"])(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.update(e)},ve.prototype.resolveFramebuffers=function(e){const t=this._context,i=this._environmentState,o=this._view,a=o.globeDepth;Object(l["a"])(a)&&a.prepareColorTextures(t);const n=i.useOIT,s=i.useGlobeDepthFramebuffer,r=i.usePostProcess,c=i.originalFramebuffer,u=s?a.colorFramebufferManager:void 0,m=o.sceneFramebuffer._colorFramebuffer,d=o.sceneFramebuffer.idFramebuffer;n&&(e.framebuffer=r?m.framebuffer:c,o.oit.execute(t,e));const p=o.translucentTileClassification;if(p.hasTranslucentDepth&&p.isSupported()&&p.execute(this,e),r){o.sceneFramebuffer.prepareColorTextures(t);let e=m;s&&!n&&(e=u);const i=this.postProcessStages,a=e.getColorTexture(0),r=d.getColorTexture(0),p=Object(h["a"])(u,m).getDepthStencilTexture();i.execute(t,a,p,r),i.copy(t,c)}n||r||!s||(e.framebuffer=c,a.executeCopyColor(t,e))},ve.prototype.initializeFrame=function(){120===this._shaderFrameCount++&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms(),this._context.textureCache.destroyReleasedTextures()),this._tweens.update(),this._globeHeight=lt(this),this._cameraUnderground=ft(this),this._globeTranslucencyState.update(this),this._screenSpaceCameraController.update(),Object(l["a"])(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this.camera.update(this._mode),this.camera._updateCameraChanged()};const Ct=new u["a"];function wt(e){const t=e._frameState,i=e.context,a=i.uniformState,n=e._defaultView;e._view=n,e.updateFrameState(),t.passes.render=!0,t.passes.postProcess=e.postProcessStages.hasSelected,t.tilesetPassState=Te;let r=Object(h["a"])(e.backgroundColor,u["a"].BLACK);e._hdr&&(r=u["a"].clone(r,Ct),r.red=Math.pow(r.red,e.gamma),r.green=Math.pow(r.green,e.gamma),r.blue=Math.pow(r.blue,e.gamma)),t.backgroundColor=r,e.fog.update(t),a.update(t);const c=e.shadowMap;Object(l["a"])(c)&&c.enabled&&(!Object(l["a"])(e.light)||e.light instanceof _e["a"]?s["a"].negate(a.sunDirectionWC,e._shadowMapCamera.direction):s["a"].clone(e.light.direction,e._shadowMapCamera.direction),t.shadowMaps.push(c)),e._computeCommandList.length=0,e._overlayCommandList.length=0;const m=n.viewport;m.x=0,m.y=0,m.width=i.drawingBufferWidth,m.height=i.drawingBufferHeight;const d=n.passState;d.framebuffer=void 0,d.blendingEnabled=void 0,d.scissorTest=void 0,d.viewport=o["a"].clone(m,d.viewport),Object(l["a"])(e.globe)&&e.globe.beginFrame(t),e.updateEnvironment(),e.updateAndExecuteCommands(d,r),e.resolveFramebuffers(d),d.framebuffer=void 0,Qe(e,d),Object(l["a"])(e.globe)&&(e.globe.endFrame(t),e.globe.tilesLoaded||(e._renderRequested=!0)),i.endFrame()}function St(e,t){try{t(e)}catch(i){if(e._renderError.raiseEvent(e,i),e.rethrowRenderErrors)throw i}}function vt(e){return e._picking.updateMostDetailedRayPicks(e)}function yt(e){const t=e._frameState;De.camera=t.camera,De.cullingVolume=t.cullingVolume;const i=e.primitives;i.updateForPass(t,De)}function Ot(e){const t=e._frameState,i=t.camera;if(!i.canPreloadFlight())return;Ee.camera=e.preloadFlightCamera,Ee.cullingVolume=e.preloadFlightCullingVolume;const o=e.primitives;o.updateForPass(t,Ee)}function Tt(e){e.primitives.updateForPass(e._frameState,xe)}ve.prototype.render=function(e){this._preUpdate.raiseEvent(this,e);const t=this._frameState;t.newFrame=!1,Object(l["a"])(e)||(e=O["a"].now());const i=this._view.checkForCameraUpdates(this);let o=!this.requestRenderMode||this._renderRequested||i||this._logDepthBufferDirty||this._hdrDirty||this.mode===me["a"].MORPHING;if(!o&&Object(l["a"])(this.maximumRenderTimeChange)&&Object(l["a"])(this._lastRenderTime)){const t=Math.abs(O["a"].secondsDifference(this._lastRenderTime,e));o=o||t>this.maximumRenderTimeChange}if(o){this._lastRenderTime=O["a"].clone(e,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1;const i=T["a"].incrementWrap(t.frameNumber,15e6,1);Fe(this,i,e),t.newFrame=!0}St(this,gt),this.primitives.show&&(St(this,vt),St(this,yt),St(this,Ot),o||St(this,Tt)),this._postUpdate.raiseEvent(this,e),o&&(this._preRender.raiseEvent(this,e),t.creditDisplay.beginFrame(),St(this,wt)),_t(this,o),St(this,bt),ht(this),o&&(this._postRender.raiseEvent(this,e),t.creditDisplay.endFrame())},ve.prototype.forceRender=function(e){this._renderRequested=!0,this.render(e)},ve.prototype.requestRender=function(){this._renderRequested=!0},ve.prototype.clampLineWidth=function(e){return Math.max(B["a"].minimumAliasedLineWidth,Math.min(e,B["a"].maximumAliasedLineWidth))},ve.prototype.pick=function(e,t,i){return this._picking.pick(this,e,t,i)},ve.prototype.pickPositionWorldCoordinates=function(e,t){return this._picking.pickPositionWorldCoordinates(this,e,t)},ve.prototype.pickPosition=function(e,t){return this._picking.pickPosition(this,e,t)},ve.prototype.drillPick=function(e,t,i,o){return this._picking.drillPick(this,e,t,i,o)},ve.prototype.pickFromRay=function(e,t,i){return this._picking.pickFromRay(this,e,t,i)},ve.prototype.drillPickFromRay=function(e,t,i,o){return this._picking.drillPickFromRay(this,e,t,i,o)},ve.prototype.pickFromRayMostDetailed=function(e,t,i){return this._picking.pickFromRayMostDetailed(this,e,t,i)},ve.prototype.drillPickFromRayMostDetailed=function(e,t,i,o){return this._picking.drillPickFromRayMostDetailed(this,e,t,i,o)},ve.prototype.sampleHeight=function(e,t,i){return this._picking.sampleHeight(this,e,t,i)},ve.prototype.clampToHeight=function(e,t,i,o){return this._picking.clampToHeight(this,e,t,i,o)},ve.prototype.sampleHeightMostDetailed=function(e,t,i){return this._picking.sampleHeightMostDetailed(this,e,t,i)},ve.prototype.clampToHeightMostDetailed=function(e,t,i){return this._picking.clampToHeightMostDetailed(this,e,t,i)},ve.prototype.cartesianToCanvasCoordinates=function(e,t){return de["a"].wgs84ToWindowCoordinates(this,e,t)},ve.prototype.completeMorph=function(){this._transitioner.completeMorph()},ve.prototype.morphTo2D=function(e){let t;const i=this.globe;t=Object(l["a"])(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=Object(h["a"])(e,2),this._transitioner.morphTo2D(e,t)},ve.prototype.morphToColumbusView=function(e){let t;const i=this.globe;t=Object(l["a"])(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=Object(h["a"])(e,2),this._transitioner.morphToColumbusView(e,t)},ve.prototype.morphTo3D=function(e){let t;const i=this.globe;t=Object(l["a"])(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=Object(h["a"])(e,2),this._transitioner.morphTo3D(e,t)},ve.prototype.isDestroyed=function(){return!1},ve.prototype.destroy=function(){this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner=this._transitioner&&this._transitioner.destroy(),this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy(),this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy(),this._picking=this._picking&&this._picking.destroy(),this._defaultView=this._defaultView&&this._defaultView.destroy(),this._view=void 0,this._removeCreditContainer&&this._canvas.parentNode.removeChild(this._creditContainer),this.postProcessStages=this.postProcessStages&&this.postProcessStages.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay=this._frameState.creditDisplay&&this._frameState.creditDisplay.destroy(),Object(l["a"])(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),this._removeRequestListenerCallback(),this._removeTaskProcessorListenerCallback();for(let e=0;e<this._removeGlobeCallbacks.length;++e)this._removeGlobeCallbacks[e]();return this._removeGlobeCallbacks.length=0,Object(_["a"])(this)},t["a"]=ve}}]);