(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~25a84d4a"],{"0a40":function(e,t,r){"use strict";var a=r("2f63"),i=r("7d62"),n=r("fe57"),o=r("e90c"),s=r("0249"),c=r("a307");function u(e,t,r,a,i){this.numberOfDayTextures=e,this.flags=t,this.material=r,this.shaderProgram=a,this.clippingShaderState=i}function d(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}function l(e){const t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }",r="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }",a="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }";let i;switch(e){case c["a"].SCENE3D:i=t;break;case c["a"].SCENE2D:case c["a"].COLUMBUS_VIEW:i=r;break;case c["a"].MORPHING:i=a;break}return i}function h(e){const t="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }",r="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }";return e?r:t}d.prototype.getShaderProgram=function(e){const t=e.frameState,r=e.surfaceTile,i=e.numberOfDayTextures,c=e.applyBrightness,d=e.applyContrast,f=e.applyHue,p=e.applySaturation,m=e.applyGamma,g=e.applyAlpha,_=e.applyDayNightAlpha,y=e.applySplit,b=e.showReflectiveOcean,T=e.showOceanWaves,A=e.enableLighting,C=e.dynamicAtmosphereLighting,O=e.dynamicAtmosphereLightingFromSun,E=e.showGroundAtmosphere,v=e.perFragmentGroundAtmosphere,S=e.hasVertexNormals,x=e.useWebMercatorProjection,D=e.enableFog,R=e.enableClippingPlanes,L=e.clippingPlanes,F=e.clippedByBoundaries,w=e.hasImageryLayerCutout,N=e.colorCorrect,I=e.highlightFillTile,P=e.colorToAlpha,M=e.hasGeodeticSurfaceNormals,j=e.hasExaggeration,B=e.showUndergroundColor,H=e.translucent;let U=0,k="";const V=r.renderedMesh,G=V.encoding,Y=G.quantization;Y===n["a"].BITS12&&(U=1,k="QUANTIZATION_BITS12");let z=0,W="";F&&(z=1,W="TILE_LIMIT_RECTANGLE");let q=0,K="";w&&(q=1,K="APPLY_IMAGERY_CUTOUT");const $=t.mode,X=$|c<<2|d<<3|f<<4|p<<5|m<<6|g<<7|b<<8|T<<9|A<<10|C<<11|O<<12|E<<13|v<<14|S<<15|x<<16|D<<17|U<<18|y<<19|R<<20|z<<21|q<<22|N<<23|I<<24|P<<25|M<<26|j<<27|B<<28|H<<29|_<<30;let J=0;Object(a["a"])(L)&&L.length>0&&(J=R?L.clippingPlanesState:0);let Q=r.surfaceShader;if(Object(a["a"])(Q)&&Q.numberOfDayTextures===i&&Q.flags===X&&Q.material===this.material&&Q.clippingShaderState===J)return Q.shaderProgram;let Z=this._shadersByTexturesFlags[i];if(Object(a["a"])(Z)||(Z=this._shadersByTexturesFlags[i]=[]),Q=Z[X],!Object(a["a"])(Q)||Q.material!==this.material||Q.clippingShaderState!==J){const e=this.baseVertexShaderSource.clone(),r=this.baseFragmentShaderSource.clone();0!==J&&r.sources.unshift(Object(s["a"])(L,t.context)),e.defines.push(k),r.defines.push("TEXTURE_UNITS "+i,W,K),c&&r.defines.push("APPLY_BRIGHTNESS"),d&&r.defines.push("APPLY_CONTRAST"),f&&r.defines.push("APPLY_HUE"),p&&r.defines.push("APPLY_SATURATION"),m&&r.defines.push("APPLY_GAMMA"),g&&r.defines.push("APPLY_ALPHA"),_&&r.defines.push("APPLY_DAY_NIGHT_ALPHA"),b&&(r.defines.push("SHOW_REFLECTIVE_OCEAN"),e.defines.push("SHOW_REFLECTIVE_OCEAN")),T&&r.defines.push("SHOW_OCEAN_WAVES"),P&&r.defines.push("APPLY_COLOR_TO_ALPHA"),B&&(e.defines.push("UNDERGROUND_COLOR"),r.defines.push("UNDERGROUND_COLOR")),H&&(e.defines.push("TRANSLUCENT"),r.defines.push("TRANSLUCENT")),A&&(S?(e.defines.push("ENABLE_VERTEX_LIGHTING"),r.defines.push("ENABLE_VERTEX_LIGHTING")):(e.defines.push("ENABLE_DAYNIGHT_SHADING"),r.defines.push("ENABLE_DAYNIGHT_SHADING"))),C&&(e.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),r.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),O&&(e.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"),r.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"))),E&&(e.defines.push("GROUND_ATMOSPHERE"),r.defines.push("GROUND_ATMOSPHERE"),v&&(e.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"),r.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"))),e.defines.push("INCLUDE_WEB_MERCATOR_Y"),r.defines.push("INCLUDE_WEB_MERCATOR_Y"),D&&(e.defines.push("FOG"),r.defines.push("FOG")),y&&r.defines.push("APPLY_SPLIT"),R&&r.defines.push("ENABLE_CLIPPING_PLANES"),N&&r.defines.push("COLOR_CORRECT"),I&&r.defines.push("HIGHLIGHT_FILL_TILE"),M&&e.defines.push("GEODETIC_SURFACE_NORMALS"),j&&e.defines.push("EXAGGERATION");let a="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend)\n    {\n        vec4 color = initialColor;\n";w&&(a+="        vec4 cutoutAndColorResult;\n        bool texelUnclipped;\n");for(let t=0;t<i;++t)a+=w?`        cutoutAndColorResult = u_dayTextureCutoutRectangles[${t}];\n        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;\n        cutoutAndColorResult = sampleAndBlend(\n`:"        color = sampleAndBlend(\n",a+=`            color,\n            u_dayTextures[${t}],\n            u_dayTextureUseWebMercatorT[${t}] ? textureCoordinates.xz : textureCoordinates.xy,\n            u_dayTextureTexCoordsRectangle[${t}],\n            u_dayTextureTranslationAndScale[${t}],\n            ${g?`u_dayTextureAlpha[${t}]`:"1.0"},\n            ${_?`u_dayTextureNightAlpha[${t}]`:"1.0"},\n${_?`u_dayTextureDayAlpha[${t}]`:"1.0"},\n${c?`u_dayTextureBrightness[${t}]`:"0.0"},\n            ${d?`u_dayTextureContrast[${t}]`:"0.0"},\n            ${f?`u_dayTextureHue[${t}]`:"0.0"},\n            ${p?`u_dayTextureSaturation[${t}]`:"0.0"},\n            ${m?`u_dayTextureOneOverGamma[${t}]`:"0.0"},\n            ${y?`u_dayTextureSplit[${t}]`:"0.0"},\n            ${P?`u_colorsToAlpha[${t}]`:"vec4(0.0)"},\n        nightBlend        );\n`,w&&(a+="        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);\n");a+="        return color;\n    }",r.sources.push(a),e.sources.push(l($)),e.sources.push(h(x));const n=o["a"].fromCache({context:t.context,vertexShaderSource:e,fragmentShaderSource:r,attributeLocations:G.getAttributeLocations()});Q=Z[X]=new u(i,X,this.material,n,J)}return r.surfaceShader=Q,Q.shaderProgram},d.prototype.destroy=function(){let e,t;const r=this._shadersByTexturesFlags;for(const i in r)if(r.hasOwnProperty(i)){const n=r[i];if(!Object(a["a"])(n))continue;for(e in n)n.hasOwnProperty(e)&&(t=n[e],Object(a["a"])(t)&&t.shaderProgram.destroy())}return Object(i["a"])(this)},t["a"]=d},"161a":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var a=r("535a"),i=r("9c35"),n=r("2f63"),o=r("e856"),s=r("974b"),c=r("166e"),u=r("d4ed"),d=r("555f"),l=r("0523"),h=r("9937"),f=r("89f5"),p=r("2c8f"),m=r("bc46"),g=r("aa13"),_=r("2773");function y(e){e=Object(a["a"])(e,a["a"].EMPTY_OBJECT);const t=e.resourceCache,r=e.gltfResource,n=e.baseResource,o=e.typedArray,s=e.gltfJson,c=e.cacheKey;this._resourceCache=t,this._gltfResource=r,this._baseResource=n,this._typedArray=o,this._gltfJson=s,this._cacheKey=c,this._gltf=void 0,this._bufferLoaders=[],this._state=_["a"].UNLOADED,this._promise=Object(i["a"])()}function b(e){return e._fetchGltf().then((function(t){if(e.isDestroyed())return;const r=new Uint8Array(t);return v(e,r)}))}function T(e,t){e.unload(),e._state=_["a"].FAILED;const r="Failed to load glTF: "+e._gltfResource.url;e._promise.reject(e.getError(r,t))}function A(e,t){if("2.0"===t.asset.version)return Promise.resolve();const r=[];return h["a"].buffer(t,(function(t){if(!Object(n["a"])(t.extras._pipeline.source)&&Object(n["a"])(t.uri)){const a=e._baseResource.getDerivedResource({url:t.uri}),i=e._resourceCache,n=i.loadExternalBuffer({resource:a});e._bufferLoaders.push(n),r.push(n.promise.then((function(e){t.extras._pipeline.source=e.typedArray})))}})),Promise.all(r).then((function(){Object(m["a"])(t)}))}function C(e){const t=[];return h["a"].buffer(e,(function(e){const r=e.uri;!Object(n["a"])(e.extras._pipeline.source)&&Object(n["a"])(r)&&Object(c["a"])(r)&&(delete e.uri,t.push(u["a"].fetchArrayBuffer(r).then((function(t){e.extras._pipeline.source=new Uint8Array(t)}))))})),Promise.all(t)}function O(e,t){const r=[];return h["a"].buffer(t,(function(t,a){const i=t.extras._pipeline.source;if(Object(n["a"])(i)&&!Object(n["a"])(t.uri)){const t=e._resourceCache,n=t.loadEmbeddedBuffer({parentResource:e._gltfResource,bufferId:a,typedArray:i});e._bufferLoaders.push(n),r.push(n.promise)}})),Promise.all(r)}function E(e,t){return Object(l["a"])(t),C(t).then((function(){return A(e,t).then((function(){return Object(d["a"])(t),O(e,t).then((function(){return Object(p["a"])(t),t}))}))}))}function v(e,t){let r;return r="glTF"===Object(s["a"])(t)?Object(f["a"])(t):Object(o["a"])(t),E(e,r)}Object(n["a"])(Object.create)&&(y.prototype=Object.create(g["a"].prototype),y.prototype.constructor=y),Object.defineProperties(y.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},gltf:{get:function(){return this._gltf}}}),y.prototype.load=function(){let e;this._state=_["a"].LOADING,e=Object(n["a"])(this._gltfJson)?E(this,this._gltfJson):Object(n["a"])(this._typedArray)?v(this,this._typedArray):b(this);const t=this;return e.then((function(e){t.isDestroyed()||(t._gltf=e,t._state=_["a"].READY,t._promise.resolve(t))})).catch((function(e){t.isDestroyed()||T(t,e)}))},y.prototype.unload=function(){const e=this._bufferLoaders,t=e.length;for(let r=0;r<t;++r)this._resourceCache.unload(e[r]);this._bufferLoaders.length=0,this._gltf=void 0},y.prototype._fetchGltf=function(){return this._gltfResource.fetchArrayBuffer()}},2856:function(e,t,r){"use strict";var a=r("cef5"),i=r("be18"),n=r("a561"),o=r("bef8"),s=r("2f63"),c=r("0123"),u=r("5410"),d=r("e42d"),l=r("2ac3"),h=r("de66"),f=r("8a39"),p=r("b82e"),m=r("0769"),g=r("a89b"),_=r("f20a"),y=r("8b68"),b=r("6ef5"),T=r("6c84"),A=r("a913"),C=r("3022"),O=r("03f1"),E=r("23b6"),v=r("7c5e"),S=r("dddf"),x=r("f1b3"),D=r("a307"),R=r("4c22");function L(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new n["a"](0,0,1,1),this.terrainData=void 0,this.vertexArray=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new i["a"],this.boundingVolumeSourceTile=void 0,this.boundingVolumeIsFromMesh=!1,this.terrainState=R["a"].UNLOADED,this.mesh=void 0,this.fill=void 0,this.pickBoundingSphere=new a["a"],this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}Object.defineProperties(L.prototype,{eligibleForUnloading:{get:function(){const e=this.terrainState,t=e===R["a"].RECEIVING||e===R["a"].TRANSFORMING;let r=!t;const a=this.imagery;for(let i=0,n=a.length;r&&i<n;++i){const e=a[i];r=!Object(s["a"])(e.loadingImagery)||e.loadingImagery.state!==S["a"].TRANSITIONING}return r}},renderedMesh:{get:function(){return Object(s["a"])(this.vertexArray)?this.mesh:Object(s["a"])(this.fill)?this.fill.mesh:void 0}}});const F=new o["a"];function w(e,t,r,a,n,o){let c=e.getExaggeratedPosition(a,n,o);if(Object(s["a"])(t)&&t!==D["a"].SCENE3D){const e=r.ellipsoid,t=e.cartesianToCartographic(c,F);c=r.project(t,o),c=i["a"].fromElements(c.z,c.x,c.y,o)}return c}const N=new i["a"],I=new i["a"],P=new i["a"];function M(e,t,r,a){const i=e.renderedMesh,n=i.vertices,o=i.encoding,s=n.length/o.stride;let c=m["a"].clone(o);c.hasGeodeticSurfaceNormals=t,c=m["a"].clone(c);const u=c.stride,d=new Float32Array(s*u);t?o.addGeodeticSurfaceNormals(n,d,r):o.removeGeodeticSurfaceNormals(n,d),i.vertices=d,i.stride=u;const l=i!==e.mesh;l?(L._freeVertexArray(e.fill.vertexArray),e.fill.vertexArray=L._createVertexArrayForMesh(a.context,i)):(L._freeVertexArray(e.vertexArray),e.vertexArray=L._createVertexArrayForMesh(a.context,i)),L._freeVertexArray(e.wireframeVertexArray),e.wireframeVertexArray=void 0}function j(e,t,r){let a=t.getTileDataAvailable(e.x,e.y,e.level);if(!Object(s["a"])(a)&&Object(s["a"])(e.parent)){const t=e.parent,r=t.data;Object(s["a"])(r)&&Object(s["a"])(r.terrainData)&&(a=r.terrainData.isChildAvailable(t.x,t.y,e.x,e.y))}!1===a&&(e.data.terrainState=R["a"].FAILED);for(let i=0,n=r.length;i<n;++i){const a=r.get(i);a.show&&a._createTileImagerySkeletons(e,t)}}function B(e,t,r,a,i,n){const o=e.data,c=e.parent;if(o.terrainState===R["a"].FAILED&&void 0!==c){const e=void 0!==c.data&&void 0!==c.data.terrainData&&!1!==c.data.terrainData.canUpsample;e||L.processStateMachine(c,t,r,a,i,n,!0)}if(o.terrainState===R["a"].FAILED&&H(o,e,t,r,e.x,e.y,e.level),o.terrainState===R["a"].UNLOADED&&U(o,r,e.x,e.y,e.level),o.terrainState===R["a"].RECEIVED&&V(o,t,r,e.x,e.y,e.level),o.terrainState===R["a"].TRANSFORMED&&(G(o,t.context,r,e.x,e.y,e.level,n),o.updateExaggeration(e,t,i)),o.terrainState>=R["a"].RECEIVED&&void 0===o.waterMaskTexture&&r.hasWaterMask){const r=o.terrainData;if(void 0!==r.waterMask)z(t.context,o);else{const t=o._findAncestorTileWithTerrainData(e);Object(s["a"])(t)&&Object(s["a"])(t.data.waterMaskTexture)&&(o.waterMaskTexture=t.data.waterMaskTexture,++o.waterMaskTexture.referenceCount,o._computeWaterMaskTranslationAndScale(e,t,o.waterMaskTranslationAndScale))}}}function H(e,t,r,a,i,n,o){const c=t.parent;if(!c)return void(t.state=x["a"].FAILED);const u=c.data.terrainData,d=c.x,l=c.y,h=c.level;if(!Object(s["a"])(u))return;const f=u.upsample(a.tilingScheme,d,l,h,i,n,o);Object(s["a"])(f)&&(e.terrainState=R["a"].RECEIVING,Promise.resolve(f).then((function(t){e.terrainData=t,e.terrainState=R["a"].RECEIVED})).catch((function(){e.terrainState=R["a"].FAILED})))}function U(e,t,r,a,i){function n(t){e.terrainData=t,e.terrainState=R["a"].RECEIVED,e.request=void 0}function o(n){if(e.request.state===f["a"].CANCELLED)return e.terrainData=void 0,e.terrainState=R["a"].UNLOADED,void(e.request=void 0);e.terrainState=R["a"].FAILED,e.request=void 0;const o=`Failed to obtain terrain tile X: ${r} Y: ${a} Level: ${i}. Error message: "${n}"`;t._requestError=g["a"].handleError(t._requestError,t,t.errorEvent,o,r,a,i,c)}function c(){const c=new h["a"]({throttle:!1,throttleByServer:!0,type:p["a"].TERRAIN});e.request=c;const u=t.requestTileGeometry(r,a,i,c);Object(s["a"])(u)?(e.terrainState=R["a"].RECEIVING,Promise.resolve(u).then((function(e){n(e)})).catch((function(e){o(e)}))):(e.terrainState=R["a"].UNLOADED,e.request=void 0)}c()}L.prototype.pick=function(e,t,r,a,i){const n=this.renderedMesh;if(!Object(s["a"])(n))return;const o=n.vertices,c=n.indices,d=n.encoding,h=c.length;let f=Number.MAX_VALUE;for(let l=0;l<h;l+=3){const i=c[l],n=c[l+1],h=c[l+2],p=w(d,t,r,o,i,N),m=w(d,t,r,o,n,I),g=w(d,t,r,o,h,P),_=u["a"].rayTriangleParametric(e,p,m,g,a);Object(s["a"])(_)&&_<f&&_>=0&&(f=_)}return f!==Number.MAX_VALUE?l["a"].getPoint(e,f,i):void 0},L.prototype.freeResources=function(){Object(s["a"])(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,this.terrainState=R["a"].UNLOADED,this.mesh=void 0,this.fill=this.fill&&this.fill.destroy();const e=this.imagery;for(let t=0,r=e.length;t<r;++t)e[t].freeResources();this.imagery.length=0,this.freeVertexArray()},L.prototype.freeVertexArray=function(){L._freeVertexArray(this.vertexArray),this.vertexArray=void 0,L._freeVertexArray(this.wireframeVertexArray),this.wireframeVertexArray=void 0},L.initialize=function(e,t,r){let a=e.data;Object(s["a"])(a)||(a=e.data=new L),e.state===x["a"].START&&(j(e,t,r),e.state=x["a"].LOADING)},L.processStateMachine=function(e,t,r,a,i,n,o){L.initialize(e,r,a);const c=e.data;if(e.state===x["a"].LOADING&&B(e,t,r,a,i,n),o)return;const u=e.renderable;e.renderable=Object(s["a"])(c.vertexArray);const d=c.terrainState===R["a"].READY;e.upsampledFromParent=Object(s["a"])(c.terrainData)&&c.terrainData.wasCreatedByUpsampling();const l=c.processImagery(e,r,t);if(d&&l){const t=e._loadedCallbacks,r={};for(const a in t)t.hasOwnProperty(a)&&(t[a](e)||(r[a]=t[a]));e._loadedCallbacks=r,e.state=x["a"].DONE}u&&(e.renderable=!0)},L.prototype.processImagery=function(e,t,r,a){const i=e.data;let n=e.upsampledFromParent,o=!1,c=!0;const u=i.imagery;let d,l;for(d=0,l=u.length;d<l;++d){const i=u[d];if(!Object(s["a"])(i.loadingImagery)){n=!1;continue}if(i.loadingImagery.state===S["a"].PLACEHOLDER){const r=i.loadingImagery.imageryLayer;if(r.imageryProvider.ready){i.freeResources(),u.splice(d,1),r._createTileImagerySkeletons(e,t,d),--d,l=u.length;continue}n=!1}const h=i.processStateMachine(e,r,a);c=c&&h,o=o||h||Object(s["a"])(i.readyImagery),n=n&&Object(s["a"])(i.loadingImagery)&&(i.loadingImagery.state===S["a"].FAILED||i.loadingImagery.state===S["a"].INVALID)}return e.upsampledFromParent=n,e.renderable=e.renderable&&(o||c),c},L.prototype.addGeodeticSurfaceNormals=function(e,t){M(this,!0,e,t)},L.prototype.removeGeodeticSurfaceNormals=function(e){M(this,!1,void 0,e)},L.prototype.updateExaggeration=function(e,t,r){const a=this,i=a.renderedMesh;if(void 0===i)return;const n=t.terrainExaggeration,o=t.terrainExaggerationRelativeHeight,s=1!==n,c=i.encoding,u=c.exaggeration!==n,d=c.exaggerationRelativeHeight!==o;if(u||d){if(u)if(s&&!c.hasGeodeticSurfaceNormals){const r=e.tilingScheme.ellipsoid;a.addGeodeticSurfaceNormals(r,t)}else!s&&c.hasGeodeticSurfaceNormals&&a.removeGeodeticSurfaceNormals(t);if(c.exaggeration=n,c.exaggerationRelativeHeight=o,void 0!==r){r._tileToUpdateHeights.push(e);const t=e.customData,a=t.length;for(let e=0;e<a;e++){const r=t[e];r.level=-1}}}};const k={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};function V(e,t,r,a,i,n){const o=r.tilingScheme,c=k;c.tilingScheme=o,c.x=a,c.y=i,c.level=n,c.exaggeration=t.terrainExaggeration,c.exaggerationRelativeHeight=t.terrainExaggerationRelativeHeight,c.throttle=!0;const u=e.terrainData,d=u.createMesh(c);Object(s["a"])(d)&&(e.terrainState=R["a"].TRANSFORMING,Promise.resolve(d).then((function(t){e.mesh=t,e.terrainState=R["a"].TRANSFORMED})).catch((function(){e.terrainState=R["a"].FAILED})))}function G(e,t,r,a,i,n,o){e.vertexArray=L._createVertexArrayForMesh(t,e.mesh),e.terrainState=R["a"].READY,e.fill=e.fill&&e.fill.destroy(o)}function Y(e){let t=e.cache.tile_waterMaskData;if(!Object(s["a"])(t)){const r=A["a"].create({context:e,pixelFormat:d["a"].LUMINANCE,pixelDatatype:b["a"].UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});r.referenceCount=1;const a=new T["a"]({wrapS:E["a"].CLAMP_TO_EDGE,wrapT:E["a"].CLAMP_TO_EDGE,minificationFilter:O["a"].LINEAR,magnificationFilter:C["a"].LINEAR});t={allWaterTexture:r,sampler:a,destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}function z(e,t){const r=t.terrainData.waterMask,a=Y(e);let i;const o=r.length;if(1===o){if(0===r[0])return;i=a.allWaterTexture}else{const t=Math.sqrt(o);i=A["a"].create({context:e,pixelFormat:d["a"].LUMINANCE,pixelDatatype:b["a"].UNSIGNED_BYTE,source:{width:t,height:t,arrayBufferView:r},sampler:a.sampler,flipY:!1}),i.referenceCount=0}++i.referenceCount,t.waterMaskTexture=i,n["a"].fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}L._createVertexArrayForMesh=function(e,t){const r=t.vertices,a=_["a"].createVertexBuffer({context:e,typedArray:r,usage:y["a"].STATIC_DRAW}),i=t.encoding.getAttributes(a),n=t.indices.indexBuffers||{};let o=n[e.id];if(!Object(s["a"])(o)||o.isDestroyed()){const r=t.indices;o=_["a"].createIndexBuffer({context:e,typedArray:r,usage:y["a"].STATIC_DRAW,indexDatatype:c["a"].fromSizeInBytes(r.BYTES_PER_ELEMENT)}),o.vertexArrayDestroyable=!1,o.referenceCount=1,n[e.id]=o,t.indices.indexBuffers=n}else++o.referenceCount;return new v["a"]({context:e,attributes:i,indexBuffer:o})},L._freeVertexArray=function(e){if(Object(s["a"])(e)){const t=e.indexBuffer;e.isDestroyed()||e.destroy(),Object(s["a"])(t)&&!t.isDestroyed()&&Object(s["a"])(t.referenceCount)&&(--t.referenceCount,0===t.referenceCount&&t.destroy())}},L.prototype._findAncestorTileWithTerrainData=function(e){let t=e.parent;while(Object(s["a"])(t)&&(!Object(s["a"])(t.data)||!Object(s["a"])(t.data.terrainData)||t.data.terrainData.wasCreatedByUpsampling()))t=t.parent;return t},L.prototype._computeWaterMaskTranslationAndScale=function(e,t,r){const a=t.rectangle,i=e.rectangle,n=i.width,o=i.height,s=n/a.width,c=o/a.height;return r.x=s*(i.west-a.west)/n,r.y=c*(i.south-a.south)/o,r.z=s,r.w=c,r},t["a"]=L},3041:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r("535a"),i=r("9c35"),n=r("2f63"),o=r("08b8"),s=r("aa13"),c=r("2773");function u(e){e=Object(a["a"])(e,a["a"].EMPTY_OBJECT);const t=e.resourceCache,r=e.gltf,n=e.draco,o=e.gltfResource,s=e.baseResource,u=e.cacheKey;this._resourceCache=t,this._gltfResource=o,this._baseResource=s,this._gltf=r,this._draco=n,this._cacheKey=u,this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodePromise=void 0,this._decodedData=void 0,this._state=c["a"].UNLOADED,this._promise=Object(i["a"])()}function d(e,t){e.unload(),e._state=c["a"].FAILED;const r="Failed to load Draco";e._promise.reject(e.getError(r,t))}Object(n["a"])(Object.create)&&(u.prototype=Object.create(s["a"].prototype),u.prototype.constructor=u),Object.defineProperties(u.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},decodedData:{get:function(){return this._decodedData}}}),u.prototype.load=function(){const e=this._resourceCache,t=e.loadBufferView({gltf:this._gltf,bufferViewId:this._draco.bufferView,gltfResource:this._gltfResource,baseResource:this._baseResource});this._bufferViewLoader=t,this._state=c["a"].LOADING;const r=this;t.promise.then((function(){r.isDestroyed()||(r._bufferViewTypedArray=t.typedArray,r._state=c["a"].PROCESSING)})).catch((function(e){r.isDestroyed()||d(r,e)}))},u.prototype.process=function(e){if(!Object(n["a"])(this._bufferViewTypedArray))return;if(Object(n["a"])(this._decodePromise))return;const t=this._draco,r=this._gltf,a=r.bufferViews,i=t.bufferView,s=a[i],u=t.attributes,l={array:new Uint8Array(this._bufferViewTypedArray),bufferView:s,compressedAttributes:u,dequantizeInShader:!0},h=o["a"].decodeBufferView(l);if(!Object(n["a"])(h))return;const f=this;this._decodePromise=h.then((function(e){f.isDestroyed()||(f.unload(),f._decodedData={indices:e.indexArray,vertexAttributes:e.attributeData},f._state=c["a"].READY,f._promise.resolve(f))})).catch((function(e){f.isDestroyed()||d(f,e)}))},u.prototype.unload=function(){Object(n["a"])(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodedData=void 0,this._gltf=void 0}},3209:function(e,t,r){"use strict";var a=r("cef5"),i=r("b081"),n=r("670c"),o=r("be18"),s=r("a561"),c=r("bef8"),u=r("dc1c"),d=r("bd8d"),l=r("9541"),h=r("2bb9"),f=r("535a"),p=r("2f63"),m=r("7d62"),g=r("21d7"),_=r("d940"),y=r("c1e2"),b=r("0123"),T=r("66bf"),A=r("93da"),C=r("52f0"),O=r("6dfc"),E=r("78e5"),v=r("713f"),S=r("1b8d"),x=r("eace"),D=r("98f6"),R=r("c698"),L=r("fe57"),F=r("2368"),w=r("1184"),N=r("f20a"),I=r("8b68"),P=r("b997"),M=r("a894"),j=r("d289"),B=r("6dc0"),H=r("7c5e"),U=r("b7c8"),k=r("43ee"),V=r("06f0"),G=r("2856"),Y=r("ad4a"),z=r("dddf"),W=r("3a8e"),q=r("894b"),K=r("f1b3"),$=r("a307"),X=r("c86b"),J=r("2221"),Q=r("4c22"),Z=r("1ec0"),ee=r("ee78");function te(e){this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.dynamicAtmosphereLighting=!1,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!1,this.shadows=X["a"].RECEIVE_ONLY,this.fillHighlightColor=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this.undergroundColor=void 0,this.undergroundColorAlphaByDistance=void 0,this.lambertDiffuseMultiplier=0,this.materialUniformMap=void 0,this._materialUniformMap=void 0,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._disableCullingRenderState=void 0,this._disableCullingBlendRenderState=void 0,this._errorEvent=new g["a"],this._imageryLayers.layerAdded.addEventListener(te.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener(te.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener(te.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener(te.prototype._onLayerShownOrHidden,this),this._imageryLayersUpdatedEvent=new g["a"],this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new d["a"](0,0,.5,1),this._clippingPlanes=void 0,this.cartographicLimitRectangle=x["a"].clone(x["a"].MAX_VALUE),this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1,this._oldTerrainExaggeration=void 0,this._oldTerrainExaggerationRelativeHeight=void 0}function re(e,t){let r=e.loadingImagery;Object(p["a"])(r)||(r=e.readyImagery);let a=t.loadingImagery;return Object(p["a"])(a)||(a=t.readyImagery),r.imageryLayer._layerIndex-a.imageryLayer._layerIndex}function ae(e,t){const r=t.creditDisplay;e._terrainProvider.ready&&Object(p["a"])(e._terrainProvider.credit)&&r.addCredit(e._terrainProvider.credit);const a=e._imageryLayers;for(let i=0,n=a.length;i<n;++i){const e=a.get(i).imageryProvider;e.ready&&Object(p["a"])(e.credit)&&r.addCredit(e.credit)}}function ie(e,t){const r=t.globeTranslucencyState;if(r.translucent){const a=e.renderState.blending.enabled;r.pushDerivedCommands(e,a,t)}else t.commandList.push(e)}Object.defineProperties(te.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){this._baseColor=e,this._firstPassInitialColor=s["a"].fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(0===this._imageryLayers.length||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){this._terrainProvider!==e&&(this._terrainProvider=e,Object(p["a"])(this._quadtree)&&this._quadtree.invalidateAllTiles())}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){k["a"].setOwner(e,this,"_clippingPlanes")}}}),te.prototype.update=function(e){this._imageryLayers._update()},te.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile((function(e){e.data.imagery.sort(re)}))),ae(this,e);const t=this._vertexArraysToDestroy,r=t.length;for(let a=0;a<r;++a)G["a"]._freeVertexArray(t[a]);t.length=0},te.prototype.beginUpdate=function(e){const t=this._tilesToRenderByTextureCount;for(let a=0,i=t.length;a<i;++a){const e=t[a];Object(p["a"])(e)&&(e.length=0)}const r=this._clippingPlanes;Object(p["a"])(r)&&r.enabled&&r.update(e),this._usedDrawCommands=0,this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1},te.prototype.endUpdate=function(e){if(!Object(p["a"])(this._renderState)){this._renderState=B["a"].fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:V["a"].LESS}}),this._blendRenderState=B["a"].fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:V["a"].LESS_OR_EQUAL},blending:U["a"].ALPHA_BLEND});let e=Object(u["a"])(this._renderState,!0);e.cull.enabled=!1,this._disableCullingRenderState=B["a"].fromCache(e),e=Object(u["a"])(this._blendRenderState,!0),e.cull.enabled=!1,this._disableCullingBlendRenderState=B["a"].fromCache(e)}this._hasFillTilesThisFrame&&this._hasLoadedTilesThisFrame&&J["a"].updateFillTiles(this,this._quadtree._tilesToRender,e,this._vertexArraysToDestroy);const t=this.quadtree,r=e.terrainExaggeration,a=e.terrainExaggerationRelativeHeight,i=this._oldTerrainExaggeration!==r||this._oldTerrainExaggerationRelativeHeight!==a;this._oldTerrainExaggeration=r,this._oldTerrainExaggerationRelativeHeight=a,i&&t.forEachLoadedTile((function(r){const a=r.data;a.updateExaggeration(r,e,t)}));const n=this._tilesToRenderByTextureCount;for(let o=0,s=n.length;o<s;++o){const t=n[o];if(Object(p["a"])(t))for(let r=0,a=t.length;r<a;++r){const a=t[r],i=a.data.tileBoundingRegion;He(this,a,e),e.minimumTerrainHeight=Math.min(e.minimumTerrainHeight,i.minimumHeight)}}},te.prototype.updateForPick=function(e){const t=this._drawCommands;for(let r=0,a=this._usedDrawCommands;r<a;++r)ie(t[r],e)},te.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},te.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)},te.prototype.loadTile=function(e,t){let r,a=t.data,i=!0;Object(p["a"])(a)&&(i=a.boundingVolumeSourceTile!==t||t._lastSelectionResult===ee["a"].CULLED_BUT_NEEDED,r=a.terrainState),G["a"].processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,i),a=t.data,i&&r!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)!==F["a"].NONE&&a.boundingVolumeSourceTile===t&&(i=!1,G["a"].processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,i))};const ne=new a["a"],oe=new x["a"],se=new x["a"],ce=new c["a"];function ue(e,t){if(t.west<t.east)return t;const r=x["a"].clone(t,se),a=x["a"].center(e,ce);return a.longitude>0?r.east=A["a"].PI:r.west=-A["a"].PI,r}function de(e,t){if(t.cameraUnderground)return!0;if(t.globeTranslucencyState.translucent)return!0;if(e.backFaceCulling)return!1;const r=e._clippingPlanes;return!(!Object(p["a"])(r)||!r.enabled)||!x["a"].equals(e.cartographicLimitRectangle,x["a"].MAX_VALUE)}te.prototype.computeTileVisibility=function(e,t,r){const i=this.computeDistanceToTile(e,t);e._distance=i;const n=de(this,t);if(t.fog.enabled&&!n&&A["a"].fog(i,t.fog.density)>=1)return F["a"].NONE;const s=e.data,c=s.tileBoundingRegion;if(void 0===s.boundingVolumeSourceTile)return F["a"].PARTIAL;const u=t.cullingVolume;let d=c.boundingVolume;Object(p["a"])(d)||(d=c.boundingSphere),s.clippedByBoundaries=!1;const l=ue(e.rectangle,this.cartographicLimitRectangle),h=x["a"].simpleIntersection(l,e.rectangle,oe);if(!Object(p["a"])(h))return F["a"].NONE;if(x["a"].equals(h,e.rectangle)||(s.clippedByBoundaries=!0),t.mode!==$["a"].SCENE3D&&(d=ne,a["a"].fromRectangleWithHeights2D(e.rectangle,t.mapProjection,c.minimumHeight,c.maximumHeight,d),o["a"].fromElements(d.center.z,d.center.x,d.center.y,d.center),t.mode===$["a"].MORPHING&&Object(p["a"])(s.renderedMesh)&&(d=a["a"].union(c.boundingSphere,d,d))),!Object(p["a"])(d))return F["a"].PARTIAL;const f=this._clippingPlanes;if(Object(p["a"])(f)&&f.enabled){const t=f.computeIntersectionWithBoundingVolume(d);if(e.isClipped=t!==T["a"].INSIDE,t===T["a"].OUTSIDE)return F["a"].NONE}let m;const g=u.computeVisibility(d);if(g===T["a"].OUTSIDE?m=F["a"].NONE:g===T["a"].INTERSECTING?m=F["a"].PARTIAL:g===T["a"].INSIDE&&(m=F["a"].FULL),m===F["a"].NONE)return m;const _=t.mode===$["a"].SCENE3D&&t.camera.frustum instanceof v["a"];if(t.mode===$["a"].SCENE3D&&!_&&Object(p["a"])(r)&&!n){const e=s.occludeePointInScaledSpace;return Object(p["a"])(e)?r.ellipsoid.isScaledSpacePointVisiblePossiblyUnderEllipsoid(e,c.minimumHeight)?m:F["a"].NONE:m}return m},te.prototype.canRefine=function(e){if(Object(p["a"])(e.data.terrainData))return!0;const t=this.terrainProvider.getTileDataAvailable(2*e.x,2*e.y,e.level+1);return void 0!==t};const le=[],he=[];te.prototype.canRenderWithoutLosingDetail=function(e,t){const r=e.data,a=le;a.length=this._imageryLayers.length;let i,n,o,s=!1,c=!1;for(Object(p["a"])(r)&&(s=r.terrainState===Q["a"].READY,c=!0,i=r.imagery),n=0,o=a.length;n<o;++n)a[n]=c;if(Object(p["a"])(i))for(n=0,o=i.length;n<o;++n){const e=i[n],t=e.loadingImagery,r=!Object(p["a"])(t)||t.state===z["a"].FAILED||t.state===z["a"].INVALID,o=(e.loadingImagery||e.readyImagery).imageryLayer._layerIndex;a[o]=r&&a[o]}const u=this.quadtree._lastSelectionFrameNumber,d=he;d.length=0,d.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild);while(d.length>0){const e=d.pop(),t=e._lastSelectionResultFrame===u?e._lastSelectionResult:ee["a"].NONE;if(t===ee["a"].RENDERED){const t=e.data;if(!Object(p["a"])(t))continue;if(!s&&e.data.terrainState===Q["a"].READY)return!1;const r=e.data.imagery;for(n=0,o=r.length;n<o;++n){const e=r[n],t=e.loadingImagery,i=!Object(p["a"])(t)||t.state===z["a"].FAILED||t.state===z["a"].INVALID,o=(e.loadingImagery||e.readyImagery).imageryLayer._layerIndex;if(i&&!a[o])return!1}}else t===ee["a"].REFINED&&d.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild)}return!0};const fe=new o["a"];te.prototype.computeTileLoadPriority=function(e,t){const r=e.data;if(void 0===r)return 0;const a=r.tileBoundingRegion.boundingVolume;if(void 0===a)return 0;const i=t.camera.positionWC,n=t.camera.directionWC,s=o["a"].subtract(a.center,i,fe),c=o["a"].magnitude(s);return c<A["a"].EPSILON5?0:(o["a"].divideByScalar(s,c,s),(1-o["a"].dot(s,n))*e._distance)};const pe=new C["a"],me=new C["a"],ge=new s["a"],_e=new s["a"],ye=new s["a"],be=new o["a"],Te=new o["a"],Ae=new o["a"],Ce=new o["a"];te.prototype.showTileThisFrame=function(e,t){let r=0;const a=e.data.imagery;for(let s=0,c=a.length;s<c;++s){const e=a[s];Object(p["a"])(e.readyImagery)&&0!==e.readyImagery.imageryLayer.alpha&&++r}let i=this._tilesToRenderByTextureCount[r];Object(p["a"])(i)||(i=[],this._tilesToRenderByTextureCount[r]=i),i.push(e);const n=e.data;Object(p["a"])(n.vertexArray)?this._hasLoadedTilesThisFrame=!0:this._hasFillTilesThisFrame=!0;const o=this._debug;++o.tilesRendered,o.texturesRendered+=r};const Oe=[new o["a"],new o["a"],new o["a"],new o["a"]];function Ee(e,t,r,a,i,n){const s=e.quadtree._occluders.ellipsoid,c=s.ellipsoid,u=Oe;return o["a"].fromRadians(r.west,r.south,i,c,u[0]),o["a"].fromRadians(r.east,r.south,i,c,u[1]),o["a"].fromRadians(r.west,r.north,i,c,u[2]),o["a"].fromRadians(r.east,r.north,i,c,u[3]),s.computeHorizonCullingPointPossiblyUnderEllipsoid(t,u,a,n)}function ve(e,t,r){let i=e.data;void 0===i&&(i=e.data=new G["a"]);const n=e.tilingScheme.ellipsoid;void 0===i.tileBoundingRegion&&(i.tileBoundingRegion=new Z["a"]({computeBoundingVolumes:!1,rectangle:e.rectangle,ellipsoid:n,minimumHeight:0,maximumHeight:0}));const s=i.tileBoundingRegion,c=s.minimumHeight,u=s.maximumHeight;let d=!1,l=e;const h=i.mesh,f=i.terrainData;if(void 0!==h&&void 0!==h.minimumHeight&&void 0!==h.maximumHeight)s.minimumHeight=h.minimumHeight,s.maximumHeight=h.maximumHeight,d=!0;else if(void 0!==f&&void 0!==f._minimumHeight&&void 0!==f._maximumHeight)s.minimumHeight=f._minimumHeight,s.maximumHeight=f._maximumHeight;else{s.minimumHeight=Number.NaN,s.maximumHeight=Number.NaN;let t=e.parent;while(void 0!==t){const e=t.data;if(void 0!==e){const t=e.mesh,r=e.terrainData;if(void 0!==t&&void 0!==t.minimumHeight&&void 0!==t.maximumHeight){s.minimumHeight=t.minimumHeight,s.maximumHeight=t.maximumHeight;break}if(void 0!==r&&void 0!==r._minimumHeight&&void 0!==r._maximumHeight){s.minimumHeight=r._minimumHeight,s.maximumHeight=r._maximumHeight;break}}t=t.parent}l=t}if(void 0!==l){const f=r.terrainExaggeration,m=r.terrainExaggerationRelativeHeight,g=1!==f;if(g&&(d=!1,s.minimumHeight=R["a"].getHeight(s.minimumHeight,f,m),s.maximumHeight=R["a"].getHeight(s.maximumHeight,f,m)),d)i.boundingVolumeIsFromMesh||(s._orientedBoundingBox=E["a"].clone(h.orientedBoundingBox,s._orientedBoundingBox),s._boundingSphere=a["a"].clone(h.boundingSphere3D,s._boundingSphere),i.occludeePointInScaledSpace=o["a"].clone(h.occludeePointInScaledSpace,i.occludeePointInScaledSpace),Object(p["a"])(i.occludeePointInScaledSpace)||(i.occludeePointInScaledSpace=Ee(t,s._orientedBoundingBox.center,e.rectangle,s.minimumHeight,s.maximumHeight,i.occludeePointInScaledSpace)));else{const r=void 0===s._orientedBoundingBox||void 0===s._boundingSphere,a=s.minimumHeight!==c||s.maximumHeight!==u;(a||r)&&(s.computeBoundingVolumes(n),i.occludeePointInScaledSpace=Ee(t,s._orientedBoundingBox.center,e.rectangle,s.minimumHeight,s.maximumHeight,i.occludeePointInScaledSpace))}i.boundingVolumeSourceTile=l,i.boundingVolumeIsFromMesh=d}else i.boundingVolumeSourceTile=void 0,i.boundingVolumeIsFromMesh=!1}function Se(e,t,r){return function(a){let i,n,o=-1;const s=a.data.imagery,c=s.length;let u;for(u=0;u<c;++u)if(i=s[u],n=Object(f["a"])(i.readyImagery,i.loadingImagery),n.imageryLayer===t){o=u;break}if(-1!==o){const c=o+e;if(i=s[c],n=Object(p["a"])(i)?Object(f["a"])(i.readyImagery,i.loadingImagery):void 0,!Object(p["a"])(n)||n.imageryLayer!==t)return!t._createTileImagerySkeletons(a,r,c);for(u=o;u<c;++u)s[u].freeResources();s.splice(o,e)}return!0}}te.prototype.computeDistanceToTile=function(e,t){ve(e,this,t);const r=e.data,a=r.boundingVolumeSourceTile;if(void 0===a)return 9999999999;const i=r.tileBoundingRegion,n=i.minimumHeight,o=i.maximumHeight;if(r.boundingVolumeSourceTile!==e){const e=t.camera.positionCartographic.height,r=Math.abs(e-n),a=Math.abs(e-o);r>a?(i.minimumHeight=n,i.maximumHeight=n):(i.minimumHeight=o,i.maximumHeight=o)}const s=i.distanceToCamera(t);return i.minimumHeight=n,i.maximumHeight=o,s},te.prototype.isDestroyed=function(){return!1},te.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),Object(m["a"])(this)},te.prototype._onLayerAdded=function(e,t){if(e.show){const t=this._terrainProvider,r=this,a=e.imageryProvider,i=this._imageryLayersUpdatedEvent;a._reload=function(){e._imageryCache={},r._quadtree.forEachLoadedTile((function(r){if(Object(p["a"])(r._loadedCallbacks[e._layerIndex]))return;let a;const i=r.data.imagery,n=i.length;let o=-1,s=0;for(a=0;a<n;++a){const t=i[a],r=Object(f["a"])(t.readyImagery,t.loadingImagery);if(r.imageryLayer===e)-1===o&&(o=a),++s;else if(-1!==o)break}if(-1===o)return;const c=o+s;e._createTileImagerySkeletons(r,t,c)&&(r._loadedCallbacks[e._layerIndex]=Se(s,e,t),r.state=K["a"].LOADING)}))},this._quadtree.forEachLoadedTile((function(a){e._createTileImagerySkeletons(a,t)&&(a.state=K["a"].LOADING,0===a.level||a._lastSelectionResultFrame===r.quadtree._lastSelectionFrameNumber&&a._lastSelectionResult===ee["a"].RENDERED||(a.renderable=!1))})),this._layerOrderChanged=!0,i.raiseEvent()}},te.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile((function(t){const r=t.data.imagery;let a=-1,i=0;for(let n=0,o=r.length;n<o;++n){const t=r[n];let o=t.loadingImagery;if(Object(p["a"])(o)||(o=t.readyImagery),o.imageryLayer===e)-1===a&&(a=n),t.freeResources(),++i;else if(-1!==a)break}-1!==a&&r.splice(a,i)})),Object(p["a"])(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},te.prototype._onLayerMoved=function(e,t,r){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},te.prototype._onLayerShownOrHidden=function(e,t,r){r?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};const xe=new C["a"],De=new C["a"];function Re(e,t){const r={u_initialColor:function(){return this.properties.initialColor},u_fillHighlightColor:function(){return this.properties.fillHighlightColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_atmosphereLightIntensity:function(){return this.properties.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return this.properties.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return this.properties.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return this.properties.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return this.properties.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return this.properties.atmosphereMieAnisotropy},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_terrainExaggerationAndRelativeHeight:function(){return this.properties.terrainExaggerationAndRelativeHeight},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){const t=e.context.uniformState.view,r=C["a"].multiplyByPoint(t,this.properties.rtc,Te);return C["a"].setTranslation(t,r,pe),pe},u_modifiedModelViewProjection:function(){const t=e.context.uniformState.view,r=e.context.uniformState.projection,a=C["a"].multiplyByPoint(t,this.properties.rtc,Te);return C["a"].setTranslation(t,a,me),C["a"].multiply(r,me,me),me},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureNightAlpha:function(){return this.properties.dayTextureNightAlpha},u_dayTextureDayAlpha:function(){return this.properties.dayTextureDayAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){const r=t._clippingPlanes;return Object(p["a"])(r)&&Object(p["a"])(r.texture)?r.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){const r=t._clippingPlanes,a=Object(p["a"])(r)?C["a"].multiply(e.context.uniformState.view,r.modelMatrix,xe):C["a"].IDENTITY;return C["a"].inverseTranspose(a,De)},u_clippingPlanesEdgeStyle:function(){const e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_minimumBrightness:function(){return e.fog.minimumBrightness},u_hsbShift:function(){return this.properties.hsbShift},u_colorsToAlpha:function(){return this.properties.colorsToAlpha},u_frontFaceAlphaByDistance:function(){return this.properties.frontFaceAlphaByDistance},u_backFaceAlphaByDistance:function(){return this.properties.backFaceAlphaByDistance},u_translucencyRectangle:function(){return this.properties.localizedTranslucencyRectangle},u_undergroundColor:function(){return this.properties.undergroundColor},u_undergroundColorAlphaByDistance:function(){return this.properties.undergroundColorAlphaByDistance},u_lambertDiffuseMultiplier:function(){return this.properties.lambertDiffuseMultiplier},properties:{initialColor:new s["a"](0,0,.5,1),fillHighlightColor:new d["a"](0,0,0,0),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new n["a"](65e5,9e6),nightFadeDistance:new n["a"](1e7,4e7),atmosphereLightIntensity:10,atmosphereRayleighCoefficient:new o["a"](55e-7,13e-6,284e-7),atmosphereMieCoefficient:new o["a"](21e-6,21e-6,21e-6),atmosphereRayleighScaleHeight:1e4,atmosphereMieScaleHeight:3200,atmosphereMieAnisotropy:.9,hsbShift:new o["a"],center3D:void 0,rtc:new o["a"],modifiedModelView:new C["a"],tileRectangle:new s["a"],terrainExaggerationAndRelativeHeight:new n["a"](1,0),dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureNightAlpha:[],dayTextureDayAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,colorsToAlpha:[],southAndNorthLatitude:new n["a"],southMercatorYAndOneOverHeight:new n["a"],waterMask:void 0,waterMaskTranslationAndScale:new s["a"],minMaxHeight:new n["a"],scaleAndBias:new C["a"],clippingPlanesEdgeColor:d["a"].clone(d["a"].WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new s["a"],frontFaceAlphaByDistance:new s["a"],backFaceAlphaByDistance:new s["a"],localizedTranslucencyRectangle:new s["a"],undergroundColor:d["a"].clone(d["a"].TRANSPARENT),undergroundColorAlphaByDistance:new s["a"],lambertDiffuseMultiplier:0}};return Object(p["a"])(t.materialUniformMap)?Object(h["a"])(r,t.materialUniformMap):r}function Le(e,t,r){const a=r.data;let i,n;if(Object(p["a"])(a.vertexArray)?(i=a.mesh,n=a.vertexArray):Object(p["a"])(a.fill)&&Object(p["a"])(a.fill.vertexArray)&&(i=a.fill.mesh,n=a.fill.vertexArray),Object(p["a"])(i)&&Object(p["a"])(n)){if(Object(p["a"])(a.wireframeVertexArray)){if(a.wireframeVertexArray.mesh===i)return;a.wireframeVertexArray.destroy(),a.wireframeVertexArray=void 0}a.wireframeVertexArray=Fe(e,n,i),a.wireframeVertexArray.mesh=i}}function Fe(e,t,r){const a=r.indices,i={indices:a,primitiveType:S["a"].TRIANGLES};y["a"].toWireframe(i);const n=i.indices,o=N["a"].createIndexBuffer({context:e,typedArray:n,usage:I["a"].STATIC_DRAW,indexDatatype:b["a"].fromSizeInBytes(n.BYTES_PER_ELEMENT)});return new H["a"]({context:e,attributes:t._attributes,indexBuffer:o})}let we,Ne,Ie;(function(){const e=new _["a"]({geometry:i["a"].fromDimensions({dimensions:new o["a"](2,2,2)})}),t=new _["a"]({geometry:new D["a"]({radius:1})});let r,a,n=new C["a"];function s(e){return new q["a"]({geometryInstances:e,appearance:new W["a"]({translucent:!1,flat:!0}),asynchronous:!1})}we=function(t,i){return t===r||(Ie(),r=t,n=C["a"].fromRotationTranslation(t.halfAxes,t.center,n),e.modelMatrix=n,e.attributes.color=l["a"].fromColor(i),a=s(e)),a},Ne=function(e,i){return e===r||(Ie(),r=e,n=C["a"].fromTranslation(e.center,n),n=C["a"].multiplyByUniformScale(n,e.radius,n),t.modelMatrix=n,t.attributes.color=l["a"].fromColor(i),a=s(t)),a},Ie=function(){Object(p["a"])(a)&&(a.destroy(),a=void 0,r=void 0)}})();const Pe=new s["a"](0,0,0,0),Me={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applyDayNightAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,dynamicAtmosphereLighting:void 0,dynamicAtmosphereLightingFromSun:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0,colorToAlpha:void 0,hasGeodeticSurfaceNormals:void 0,hasExaggeration:void 0},je=d["a"].TRANSPARENT,Be=new O["a"];function He(e,t,r){const i=t.data;Object(p["a"])(i.vertexArray)||(void 0===i.fill&&(i.fill=new J["a"](t)),i.fill.update(e,r));const n=r.creditDisplay,c=i.terrainData;if(Object(p["a"])(c)&&Object(p["a"])(c.credits)){const e=c.credits;for(let t=0,r=e.length;t<r;++t)n.addCredit(e[t])}let u=P["a"].maximumTextureImageUnits,l=i.waterMaskTexture,h=i.waterMaskTranslationAndScale;!Object(p["a"])(l)&&Object(p["a"])(i.fill)&&(l=i.fill.waterMaskTexture,h=i.fill.waterMaskTranslationAndScale);const m=r.cameraUnderground,g=r.globeTranslucencyState,_=g.translucent,y=g.frontFaceAlphaByDistance,b=g.backFaceAlphaByDistance,T=g.rectangle,O=Object(f["a"])(e.undergroundColor,je),v=Object(f["a"])(e.undergroundColorAlphaByDistance,Be),D=de(e,r)&&r.mode===$["a"].SCENE3D&&O.alpha>0&&(v.nearValue>0||v.farValue>0),R=e.lambertDiffuseMultiplier,F=e.hasWaterMask&&Object(p["a"])(l),N=e.oceanNormalMap,I=F&&Object(p["a"])(N),B=e.terrainProvider.ready&&e.terrainProvider.hasVertexNormals,H=r.fog.enabled&&r.fog.renderable&&!m,U=e.showGroundAtmosphere&&r.mode===$["a"].SCENE3D,k=X["a"].castShadows(e.shadows)&&!_,V=X["a"].receiveShadows(e.shadows)&&!_,G=e.hueShift,z=e.saturationShift,W=e.brightnessShift;let q=!(A["a"].equalsEpsilon(G,0,A["a"].EPSILON7)&&A["a"].equalsEpsilon(z,0,A["a"].EPSILON7)&&A["a"].equalsEpsilon(W,0,A["a"].EPSILON7)),K=!1;if(U){const t=o["a"].magnitude(r.camera.positionWC),a=e.nightFadeOutDistance;K=t>a}F&&--u,I&&--u,Object(p["a"])(r.shadowState)&&r.shadowState.shadowsEnabled&&--u,Object(p["a"])(e.clippingPlanes)&&e.clippingPlanes.enabled&&--u,u-=g.numberOfTextureUniforms;const Q=i.renderedMesh;let Z=Q.center;const ee=Q.encoding,te=i.tileBoundingRegion,re=r.terrainExaggeration,ae=r.terrainExaggerationRelativeHeight,ne=1!==re,se=ee.hasGeodeticSurfaceNormals,ce=ge;let le=0,he=0,fe=0,pe=0,me=!1;if(r.mode!==$["a"].SCENE3D){const e=r.mapProjection,a=e.project(x["a"].southwest(t.rectangle),Ae),i=e.project(x["a"].northeast(t.rectangle),Ce);if(ce.x=a.x,ce.y=a.y,ce.z=i.x,ce.w=i.y,r.mode!==$["a"].MORPHING&&(Z=be,Z.x=0,Z.y=.5*(ce.z+ce.x),Z.z=.5*(ce.w+ce.y),ce.x-=Z.y,ce.y-=Z.z,ce.z-=Z.y,ce.w-=Z.z),r.mode===$["a"].SCENE2D&&ee.quantization===L["a"].BITS12){const e=1/(Math.pow(2,12)-1)*.5,t=(ce.z-ce.x)*e,r=(ce.w-ce.y)*e;ce.x-=t,ce.y-=r,ce.z+=t,ce.w+=r}e instanceof w["a"]&&(le=t.rectangle.south,he=t.rectangle.north,fe=w["a"].geodeticLatitudeToMercatorAngle(le),pe=1/(w["a"].geodeticLatitudeToMercatorAngle(he)-fe),me=!0)}const Te=Me;Te.frameState=r,Te.surfaceTile=i,Te.showReflectiveOcean=F,Te.showOceanWaves=I,Te.enableLighting=e.enableLighting,Te.dynamicAtmosphereLighting=e.dynamicAtmosphereLighting,Te.dynamicAtmosphereLightingFromSun=e.dynamicAtmosphereLightingFromSun,Te.showGroundAtmosphere=U,Te.atmosphereLightIntensity=e.atmosphereLightIntensity,Te.atmosphereRayleighCoefficient=e.atmosphereRayleighCoefficient,Te.atmosphereMieCoefficient=e.atmosphereMieCoefficient,Te.atmosphereRayleighScaleHeight=e.atmosphereRayleighScaleHeight,Te.atmosphereMieScaleHeight=e.atmosphereMieScaleHeight,Te.atmosphereMieAnisotropy=e.atmosphereMieAnisotropy,Te.perFragmentGroundAtmosphere=K,Te.hasVertexNormals=B,Te.useWebMercatorProjection=me,Te.clippedByBoundaries=i.clippedByBoundaries,Te.hasGeodeticSurfaceNormals=se,Te.hasExaggeration=ne;const Oe=i.imagery;let Ee=0;const ve=Oe.length,Se=e.showSkirts&&!m&&!_,xe=e.backFaceCulling&&!m&&!_,De=xe?e._renderState:e._disableCullingRenderState,Fe=xe?e._blendRenderState:e._disableCullingBlendRenderState;let He=De,Ue=e._firstPassInitialColor;const ke=r.context;Object(p["a"])(e._debug.boundingSphereTile)||Ie();const Ve=e._materialUniformMap!==e.materialUniformMap;if(Ve){e._materialUniformMap=e.materialUniformMap;const t=e._drawCommands.length;for(let a=0;a<t;++a)e._uniformMaps[a]=Re(r,e)}do{let c,f,L=0;if(e._drawCommands.length<=e._usedDrawCommands?(c=new M["a"],c.owner=t,c.cull=!1,c.boundingVolume=new a["a"],c.orientedBoundingBox=void 0,f=Re(r,e),e._drawCommands.push(c),e._uniformMaps.push(f)):(c=e._drawCommands[e._usedDrawCommands],f=e._uniformMaps[e._usedDrawCommands]),c.owner=t,++e._usedDrawCommands,t===e._debug.boundingSphereTile){const e=te.boundingVolume,t=te.boundingSphere;Object(p["a"])(e)?we(e,d["a"].RED).update(r):Object(p["a"])(t)&&Ne(t,d["a"].RED).update(r)}const F=f.properties;s["a"].clone(Ue,F.initialColor),F.oceanNormalMap=N,F.lightingFadeDistance.x=e.lightingFadeOutDistance,F.lightingFadeDistance.y=e.lightingFadeInDistance,F.nightFadeDistance.x=e.nightFadeOutDistance,F.nightFadeDistance.y=e.nightFadeInDistance,F.atmosphereLightIntensity=e.atmosphereLightIntensity,F.atmosphereRayleighCoefficient=e.atmosphereRayleighCoefficient,F.atmosphereMieCoefficient=e.atmosphereMieCoefficient,F.atmosphereRayleighScaleHeight=e.atmosphereRayleighScaleHeight,F.atmosphereMieScaleHeight=e.atmosphereMieScaleHeight,F.atmosphereMieAnisotropy=e.atmosphereMieAnisotropy,F.zoomedOutOceanSpecularIntensity=e.zoomedOutOceanSpecularIntensity;const w=m?b:y,I=m?y:b;Object(p["a"])(w)&&(s["a"].fromElements(w.near,w.nearValue,w.far,w.farValue,F.frontFaceAlphaByDistance),s["a"].fromElements(I.near,I.nearValue,I.far,I.farValue,F.backFaceAlphaByDistance)),s["a"].fromElements(v.near,v.nearValue,v.far,v.farValue,F.undergroundColorAlphaByDistance),d["a"].clone(O,F.undergroundColor),F.lambertDiffuseMultiplier=R;const P=!Object(p["a"])(i.vertexArray)&&Object(p["a"])(e.fillHighlightColor)&&e.fillHighlightColor.alpha>0;P&&d["a"].clone(e.fillHighlightColor,F.fillHighlightColor),F.terrainExaggerationAndRelativeHeight.x=re,F.terrainExaggerationAndRelativeHeight.y=ae,F.center3D=Q.center,o["a"].clone(Z,F.rtc),s["a"].clone(ce,F.tileRectangle),F.southAndNorthLatitude.x=le,F.southAndNorthLatitude.y=he,F.southMercatorYAndOneOverHeight.x=fe,F.southMercatorYAndOneOverHeight.y=pe;const B=_e,K=ue(t.rectangle,e.cartographicLimitRectangle),X=ye,J=ue(t.rectangle,T);o["a"].fromElements(G,z,W,F.hsbShift);const ne=t.rectangle,se=1/ne.width,de=1/ne.height;B.x=(K.west-ne.west)*se,B.y=(K.south-ne.south)*de,B.z=(K.east-ne.west)*se,B.w=(K.north-ne.south)*de,s["a"].clone(B,F.localizedCartographicLimitRectangle),X.x=(J.west-ne.west)*se,X.y=(J.south-ne.south)*de,X.z=(J.east-ne.west)*se,X.w=(J.north-ne.south)*de,s["a"].clone(X,F.localizedTranslucencyRectangle);const me=H&&A["a"].fog(t._distance,r.fog.density)>A["a"].EPSILON3;q=q&&(me||U);let ge=!1,be=!1,Ae=!1,Ce=!1,xe=!1,De=!1,Ie=!1,Me=!1,je=!1,Be=!1;while(L<u&&Ee<ve){const e=Oe[Ee],r=e.readyImagery;if(++Ee,!Object(p["a"])(r)||0===r.imageryLayer.alpha)continue;const a=e.useWebMercatorT?r.textureWebMercator:r.texture,i=r.imageryLayer;Object(p["a"])(e.textureTranslationAndScale)||(e.textureTranslationAndScale=i._calculateTextureTranslationAndScale(t,e)),F.dayTextures[L]=a,F.dayTextureTranslationAndScale[L]=e.textureTranslationAndScale,F.dayTextureTexCoordsRectangle[L]=e.textureCoordinateRectangle,F.dayTextureUseWebMercatorT[L]=e.useWebMercatorT,F.dayTextureAlpha[L]=i.alpha,De=De||1!==F.dayTextureAlpha[L],F.dayTextureNightAlpha[L]=i.nightAlpha,Ie=Ie||1!==F.dayTextureNightAlpha[L],F.dayTextureDayAlpha[L]=i.dayAlpha,Ie=Ie||1!==F.dayTextureDayAlpha[L],F.dayTextureBrightness[L]=i.brightness,ge=ge||F.dayTextureBrightness[L]!==Y["a"].DEFAULT_BRIGHTNESS,F.dayTextureContrast[L]=i.contrast,be=be||F.dayTextureContrast[L]!==Y["a"].DEFAULT_CONTRAST,F.dayTextureHue[L]=i.hue,Ae=Ae||F.dayTextureHue[L]!==Y["a"].DEFAULT_HUE,F.dayTextureSaturation[L]=i.saturation,Ce=Ce||F.dayTextureSaturation[L]!==Y["a"].DEFAULT_SATURATION,F.dayTextureOneOverGamma[L]=1/i.gamma,xe=xe||F.dayTextureOneOverGamma[L]!==1/Y["a"].DEFAULT_GAMMA,F.dayTextureSplit[L]=i.splitDirection,Me=Me||0!==F.dayTextureSplit[L];let o=F.dayTextureCutoutRectangles[L];if(Object(p["a"])(o)||(o=F.dayTextureCutoutRectangles[L]=new s["a"]),s["a"].clone(s["a"].ZERO,o),Object(p["a"])(i.cutoutRectangle)){const e=ue(ne,i.cutoutRectangle),t=x["a"].simpleIntersection(e,ne,oe);je=Object(p["a"])(t)||je,o.x=(e.west-ne.west)*se,o.y=(e.south-ne.south)*de,o.z=(e.east-ne.west)*se,o.w=(e.north-ne.south)*de}let c=F.colorsToAlpha[L];Object(p["a"])(c)||(c=F.colorsToAlpha[L]=new s["a"]);const u=Object(p["a"])(i.colorToAlpha)&&i.colorToAlphaThreshold>0;if(Be=Be||u,u){const e=i.colorToAlpha;c.x=e.red,c.y=e.green,c.z=e.blue,c.w=i.colorToAlphaThreshold}else c.w=-1;if(Object(p["a"])(r.credits)){const e=r.credits;for(let t=0,r=e.length;t<r;++t)n.addCredit(e[t])}++L}F.dayTextures.length=L,F.waterMask=l,s["a"].clone(h,F.waterMaskTranslationAndScale),F.minMaxHeight.x=ee.minimumHeight,F.minMaxHeight.y=ee.maximumHeight,C["a"].clone(ee.matrix,F.scaleAndBias);const Ve=e._clippingPlanes,Ge=Object(p["a"])(Ve)&&Ve.enabled&&t.isClipped;Ge&&(F.clippingPlanesEdgeColor=d["a"].clone(Ve.edgeColor,F.clippingPlanesEdgeColor),F.clippingPlanesEdgeWidth=Ve.edgeWidth),Te.numberOfDayTextures=L,Te.applyBrightness=ge,Te.applyContrast=be,Te.applyHue=Ae,Te.applySaturation=Ce,Te.applyGamma=xe,Te.applyAlpha=De,Te.applyDayNightAlpha=Ie,Te.applySplit=Me,Te.enableFog=me,Te.enableClippingPlanes=Ge,Te.clippingPlanes=Ve,Te.hasImageryLayerCutout=je,Te.colorCorrect=q,Te.highlightFillTile=P,Te.colorToAlpha=Be,Te.showUndergroundColor=D,Te.translucent=_;let Ye=i.renderedMesh.indices.length;Se||(Ye=i.renderedMesh.indexCountWithoutSkirts),c.shaderProgram=e._surfaceShaderSet.getShaderProgram(Te),c.castShadows=k,c.receiveShadows=V,c.renderState=He,c.primitiveType=S["a"].TRIANGLES,c.vertexArray=i.vertexArray||i.fill.vertexArray,c.count=Ye,c.uniformMap=f,c.pass=j["a"].GLOBE,e._debug.wireframe&&(Le(ke,e,t),Object(p["a"])(i.wireframeVertexArray)&&(c.vertexArray=i.wireframeVertexArray,c.primitiveType=S["a"].LINES,c.count=2*Ye));let ze=c.boundingVolume;const We=c.orientedBoundingBox;r.mode!==$["a"].SCENE3D?(a["a"].fromRectangleWithHeights2D(t.rectangle,r.mapProjection,te.minimumHeight,te.maximumHeight,ze),o["a"].fromElements(ze.center.z,ze.center.x,ze.center.y,ze.center),r.mode===$["a"].MORPHING&&(ze=a["a"].union(te.boundingSphere,ze,ze))):(c.boundingVolume=a["a"].clone(te.boundingSphere,ze),c.orientedBoundingBox=E["a"].clone(te.boundingVolume,We)),c.dirty=!0,_&&g.updateDerivedCommands(c,r),ie(c,r),He=Fe,Ue=Pe}while(Ee<ve)}t["a"]=te},5225:function(e,t,r){"use strict";var a=r("2f63"),i=r("6dfc"),n=r("eace");function o(){this._enabled=!1,this._frontFaceAlpha=1,this._frontFaceAlphaByDistance=void 0,this._backFaceAlpha=1,this._backFaceAlphaByDistance=void 0,this._rectangle=n["a"].clone(n["a"].MAX_VALUE)}Object.defineProperties(o.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabled=e}},frontFaceAlpha:{get:function(){return this._frontFaceAlpha},set:function(e){this._frontFaceAlpha=e}},frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance},set:function(e){this._frontFaceAlphaByDistance=i["a"].clone(e,this._frontFaceAlphaByDistance)}},backFaceAlpha:{get:function(){return this._backFaceAlpha},set:function(e){this._backFaceAlpha=e}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance},set:function(e){this._backFaceAlphaByDistance=i["a"].clone(e,this._backFaceAlphaByDistance)}},rectangle:{get:function(){return this._rectangle},set:function(e){Object(a["a"])(e)||(e=n["a"].clone(n["a"].MAX_VALUE)),n["a"].clone(e,this._rectangle)}}}),t["a"]=o},"52e6":function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var a=r("535a"),i=r("9c35"),n=r("2f63"),o=r("55d8"),s=r("7f5c"),c=r("aa13"),u=r("2773");function d(e){e=Object(a["a"])(e,a["a"].EMPTY_OBJECT);const t=e.resourceCache,r=e.gltf,n=e.bufferViewId,s=e.gltfResource,c=e.baseResource,d=e.cacheKey,l=r.bufferViews[n];let h,f,p,m,g=l.buffer,_=l.byteOffset,y=l.byteLength,b=!1;if(Object(o["a"])(l,"EXT_meshopt_compression")){const e=l.extensions.EXT_meshopt_compression;g=e.buffer,_=Object(a["a"])(e.byteOffset,0),y=e.byteLength,b=!0,h=e.byteStride,f=e.count,p=e.mode,m=Object(a["a"])(e.filter,"NONE")}const T=r.buffers[g];this._hasMeshopt=b,this._meshoptByteStride=h,this._meshoptCount=f,this._meshoptMode=p,this._meshoptFilter=m,this._resourceCache=t,this._gltfResource=s,this._baseResource=c,this._buffer=T,this._bufferId=g,this._byteOffset=_,this._byteLength=y,this._cacheKey=d,this._bufferLoader=void 0,this._typedArray=void 0,this._state=u["a"].UNLOADED,this._promise=Object(i["a"])()}function l(e){const t=e._resourceCache,r=e._buffer;if(Object(n["a"])(r.uri)){const a=e._baseResource,i=a.getDerivedResource({url:r.uri});return t.loadExternalBuffer({resource:i})}return t.loadEmbeddedBuffer({parentResource:e._gltfResource,bufferId:e._bufferId})}Object(n["a"])(Object.create)&&(d.prototype=Object.create(c["a"].prototype),d.prototype.constructor=d),Object.defineProperties(d.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}}),d.prototype.load=function(){const e=l(this);this._bufferLoader=e,this._state=u["a"].LOADING;const t=this;e.promise.then((function(){if(t.isDestroyed())return;const r=e.typedArray,a=new Uint8Array(r.buffer,r.byteOffset+t._byteOffset,t._byteLength);t.unload(),t._typedArray=a,t._hasMeshopt?t._state=u["a"].PROCESSING:(t._state=u["a"].READY,t._promise.resolve(t))})).catch((function(e){if(t.isDestroyed())return;t.unload(),t._state=u["a"].FAILED;const r="Failed to load buffer view";t._promise.reject(t.getError(r,e))}))},d.prototype.process=function(e){if(!this._hasMeshopt)return;if(!Object(n["a"])(this._typedArray))return;if(this._state!==u["a"].PROCESSING)return;const t=this._meshoptCount,r=this._meshoptByteStride,a=new Uint8Array(t*r);s["a"].decodeGltfBuffer(a,t,r,this._typedArray,this._meshoptMode,this._meshoptFilter),this._typedArray=a,this._state=u["a"].READY,this._promise.resolve(this)},d.prototype.unload=function(){Object(n["a"])(this._bufferLoader)&&this._resourceCache.unload(this._bufferLoader),this._bufferLoader=void 0,this._typedArray=void 0}},"6b72":function(e,t,r){"use strict";var a=r("2bb9"),i=r("535a"),n=r("2f63"),o=r("6dfc"),s=r("eace"),c=r("a894"),u=r("d289"),d=r("6dc0"),l=r("5770"),h=r("b7c8"),f=r("29ab"),p=r("a307");const m={OPAQUE_FRONT_FACE:0,OPAQUE_BACK_FACE:1,DEPTH_ONLY_FRONT_FACE:2,DEPTH_ONLY_BACK_FACE:3,DEPTH_ONLY_FRONT_AND_BACK_FACE:4,TRANSLUCENT_FRONT_FACE:5,TRANSLUCENT_BACK_FACE:6,TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:7,TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:8,PICK_FRONT_FACE:9,PICK_BACK_FACE:10,DERIVED_COMMANDS_MAXIMUM_LENGTH:11},g=m.DERIVED_COMMANDS_MAXIMUM_LENGTH,_=["opaqueFrontFaceCommand","opaqueBackFaceCommand","depthOnlyFrontFaceCommand","depthOnlyBackFaceCommand","depthOnlyFrontAndBackFaceCommand","translucentFrontFaceCommand","translucentBackFaceCommand","translucentFrontFaceManualDepthTestCommand","translucentBackFaceManualDepthTestCommand","pickFrontFaceCommand","pickBackFaceCommand"];function y(){this._frontFaceAlphaByDistance=new o["a"](0,1,0,1),this._backFaceAlphaByDistance=new o["a"](0,1,0,1),this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._requiresManualDepthTest=!1,this._sunVisibleThroughGlobe=!1,this._environmentVisible=!1,this._useDepthPlane=!1,this._numberOfTextureUniforms=0,this._globeTranslucencyFramebuffer=void 0,this._rectangle=s["a"].clone(s["a"].MAX_VALUE),this._derivedCommandKey=0,this._derivedCommandsDirty=!1,this._derivedCommandPacks=void 0,this._derivedCommandTypes=new Array(g),this._derivedBlendCommandTypes=new Array(g),this._derivedPickCommandTypes=new Array(g),this._derivedCommandTypesToUpdate=new Array(g),this._derivedCommandsLength=0,this._derivedBlendCommandsLength=0,this._derivedPickCommandsLength=0,this._derivedCommandsToUpdateLength=0}function b(e,t,r,a){return e?Object(n["a"])(r)?(o["a"].clone(r,a),a.nearValue*=t,a.farValue*=t,a):(a.nearValue=t,a.farValue=t,a):(a.nearValue=1,a.farValue=1,a)}function T(e,t,r){return e&&(r.baseColor.alpha<1||t.nearValue<1||t.farValue<1)}function A(e,t){const r=e._frontFaceTranslucent,a=e._backFaceTranslucent;return r&&(t.cameraUnderground||a)}function C(e,t){return!t.cameraUnderground||e._frontFaceTranslucent}function O(e,t){return!t.cameraUnderground&&!e._frontFaceTranslucent}function E(e,t,r){return e._frontFaceTranslucent&&!e._backFaceTranslucent&&!r.depthTestAgainstTerrain&&t.mode!==p["a"].SCENE2D&&t.context.depthTexture}function v(e){let t=0;return e._frontFaceTranslucent&&++t,e._requiresManualDepthTest&&++t,t}function S(e,t){let r;e._derivedCommandsLength=x(e,t,!1,!1,e._derivedCommandTypes),e._derivedBlendCommandsLength=x(e,t,!0,!1,e._derivedBlendCommandTypes),e._derivedPickCommandsLength=x(e,t,!1,!0,e._derivedPickCommandTypes);let a=0;for(r=0;r<e._derivedCommandsLength;++r)a|=1<<e._derivedCommandTypes[r];for(r=0;r<e._derivedBlendCommandsLength;++r)a|=1<<e._derivedBlendCommandTypes[r];for(r=0;r<e._derivedPickCommandsLength;++r)a|=1<<e._derivedPickCommandTypes[r];let i=0;for(r=0;r<g;++r)(a&1<<r)>0&&(e._derivedCommandTypesToUpdate[i++]=r);e._derivedCommandsToUpdateLength=i;const o=a!==e._derivedCommandKey;e._derivedCommandKey=a,e._derivedCommandsDirty=o,!Object(n["a"])(e._derivedCommandPacks)&&e._frontFaceTranslucent&&(e._derivedCommandPacks=Q())}function x(e,t,r,a,i){let n=0;const o=e._frontFaceTranslucent,s=e._backFaceTranslucent;if(!o)return n;const c=t.cameraUnderground,u=e._requiresManualDepthTest,d=a?m.PICK_FRONT_FACE:u?m.TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:m.TRANSLUCENT_FRONT_FACE,l=a?m.PICK_BACK_FACE:u?m.TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:m.TRANSLUCENT_BACK_FACE;return t.mode===p["a"].SCENE2D?(i[n++]=m.DEPTH_ONLY_FRONT_FACE,i[n++]=d,n):(s?(r||(i[n++]=m.DEPTH_ONLY_FRONT_AND_BACK_FACE),c?(i[n++]=d,i[n++]=l):(i[n++]=l,i[n++]=d)):c?(r||(i[n++]=m.DEPTH_ONLY_BACK_FACE),i[n++]=m.OPAQUE_FRONT_FACE,i[n++]=l):(r||(i[n++]=m.DEPTH_ONLY_FRONT_FACE),i[n++]=m.OPAQUE_BACK_FACE,i[n++]=d),n)}function D(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}function R(e,t){return e.indexOf(t)>-1}function L(e,t){D(e.defines,"TRANSLUCENT"),D(t.defines,"TRANSLUCENT")}function F(e,t){D(e.defines,"GROUND_ATMOSPHERE"),D(t.defines,"GROUND_ATMOSPHERE"),D(e.defines,"FOG"),D(t.defines,"FOG"),D(e.defines,"TRANSLUCENT"),D(t.defines,"TRANSLUCENT")}function w(e,t){if(R(t.defines,"TILE_LIMIT_RECTANGLE")||R(t.defines,"ENABLE_CLIPPING_PLANES"))return;const r="void main() \n{ \n    gl_FragColor = vec4(1.0); \n} \n";t.sources=[r]}function N(e,t){const r=t.sources,a=r.length;for(let n=0;n<a;++n)r[n]=l["a"].replaceMain(r[n],"czm_globe_translucency_main");const i="\n\nuniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n#ifdef MANUAL_DEPTH_TEST \n    float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, st)); \n    if (logDepthOrDepth != 0.0) \n    { \n        vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth); \n        float depthEC = eyeCoordinate.z / eyeCoordinate.w; \n        if (v_positionEC.z < depthEC) \n        { \n            discard; \n        } \n    } \n#endif \n    czm_globe_translucency_main(); \n    vec4 classificationColor = texture2D(u_classificationTexture, st); \n    if (classificationColor.a > 0.0) \n    { \n        // Reverse premultiplication process to get the correct composited result of the classification primitives \n        classificationColor.rgb /= classificationColor.a; \n    } \n    gl_FragColor = classificationColor * vec4(classificationColor.aaa, 1.0) + gl_FragColor * (1.0 - classificationColor.a); \n} \n";r.push(i)}function I(e,t){N(e,t),D(e.defines,"GROUND_ATMOSPHERE"),D(t.defines,"GROUND_ATMOSPHERE"),D(e.defines,"FOG"),D(t.defines,"FOG")}function P(e,t){N(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function M(e,t){I(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function j(e,t){const r="uniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n    vec4 pickColor = texture2D(u_classificationTexture, st); \n    if (pickColor == vec4(0.0)) \n    { \n        discard; \n    } \n    gl_FragColor = pickColor; \n} \n";t.sources=[r]}function B(e,t,r,a,i,o){if(!Object(n["a"])(i))return t;if(!a&&Object(n["a"])(r))return r;let s=e.shaderCache.getDerivedShaderProgram(t,o);if(!Object(n["a"])(s)){const r=t._attributeLocations,a=t.vertexShaderSource.clone(),c=t.fragmentShaderSource.clone();a.defines=Object(n["a"])(a.defines)?a.defines.slice(0):[],c.defines=Object(n["a"])(c.defines)?c.defines.slice(0):[],i(a,c),s=e.shaderCache.createDerivedShaderProgram(t,o,{vertexShaderSource:a,fragmentShaderSource:c,attributeLocations:r})}return s}function H(e){e.cull.face=f["a"].BACK,e.cull.enabled=!0}function U(e){e.cull.face=f["a"].FRONT,e.cull.enabled=!0}function k(e){e.cull.face=f["a"].BACK,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function V(e){e.cull.face=f["a"].FRONT,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function G(e){e.cull.enabled=!1,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function Y(e){e.cull.face=f["a"].BACK,e.cull.enabled=!0,e.depthMask=!1,e.blending=h["a"].ALPHA_BLEND}function z(e){e.cull.face=f["a"].FRONT,e.cull.enabled=!0,e.depthMask=!1,e.blending=h["a"].ALPHA_BLEND}function W(e){e.cull.face=f["a"].BACK,e.cull.enabled=!0,e.blending.enabled=!1}function q(e){e.cull.face=f["a"].FRONT,e.cull.enabled=!0,e.blending.enabled=!1}function K(e,t,r,a,i){if(!Object(n["a"])(a))return e;if(!r&&Object(n["a"])(t))return t;let o=i[e.id];if(!Object(n["a"])(o)){const t=d["a"].getState(e);a(t),o=d["a"].fromCache(t),i[e.id]=o}return o}function $(e){return{u_classificationTexture:function(){return e._globeTranslucencyFramebuffer.classificationTexture}}}function X(e,t,r,i,o){return Object(n["a"])(o)?!i&&Object(n["a"])(r)?r:Object(a["a"])(t,o(e),!1):t}function J(e){this.pass=e.pass,this.pickOnly=e.pickOnly,this.getShaderProgramFunction=e.getShaderProgramFunction,this.getRenderStateFunction=e.getRenderStateFunction,this.getUniformMapFunction=e.getUniformMapFunction,this.renderStateCache={}}function Q(){return[new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:L,getRenderStateFunction:H,getUniformMapFunction:void 0}),new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:F,getRenderStateFunction:U,getUniformMapFunction:void 0}),new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:w,getRenderStateFunction:k,getUniformMapFunction:void 0}),new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:w,getRenderStateFunction:V,getUniformMapFunction:void 0}),new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:w,getRenderStateFunction:G,getUniformMapFunction:void 0}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:N,getRenderStateFunction:Y,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:I,getRenderStateFunction:z,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:P,getRenderStateFunction:Y,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:M,getRenderStateFunction:z,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:j,getRenderStateFunction:W,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:j,getRenderStateFunction:q,getUniformMapFunction:$})]}Object.defineProperties(y.prototype,{frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance}},translucent:{get:function(){return this._frontFaceTranslucent}},sunVisibleThroughGlobe:{get:function(){return this._sunVisibleThroughGlobe}},environmentVisible:{get:function(){return this._environmentVisible}},useDepthPlane:{get:function(){return this._useDepthPlane}},numberOfTextureUniforms:{get:function(){return this._numberOfTextureUniforms}},rectangle:{get:function(){return this._rectangle}}}),y.prototype.update=function(e){const t=e.globe;if(!Object(n["a"])(t)||!t.show)return this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._sunVisibleThroughGlobe=!0,this._environmentVisible=!0,void(this._useDepthPlane=!1);this._frontFaceAlphaByDistance=b(t.translucency.enabled,t.translucency.frontFaceAlpha,t.translucency.frontFaceAlphaByDistance,this._frontFaceAlphaByDistance),this._backFaceAlphaByDistance=b(t.translucency.enabled,t.translucency.backFaceAlpha,t.translucency.backFaceAlphaByDistance,this._backFaceAlphaByDistance),this._frontFaceTranslucent=T(t.translucency.enabled,this._frontFaceAlphaByDistance,t),this._backFaceTranslucent=T(t.translucency.enabled,this._backFaceAlphaByDistance,t),this._requiresManualDepthTest=E(this,e,t),this._sunVisibleThroughGlobe=A(this,e),this._environmentVisible=C(this,e),this._useDepthPlane=O(this,e),this._numberOfTextureUniforms=v(this),this._rectangle=s["a"].clone(t.translucency.rectangle,this._rectangle),S(this,e)};const Z=new Array(g),ee=new Array(g);function te(e,t,r,a,o,s,u){let d=t.derivedCommands.globeTranslucency;const l=e._derivedCommandsDirty;if(t.dirty||!Object(n["a"])(d)||l){t.dirty=!1,Object(n["a"])(d)||(d={},t.derivedCommands.globeTranslucency=d);const l=u.frameNumber,h=Object(i["a"])(d.uniformMapDirtyFrame,0),f=Object(i["a"])(d.shaderProgramDirtyFrame,0),p=Object(i["a"])(d.renderStateDirtyFrame,0),m=d.uniformMap!==t.uniformMap,g=d.shaderProgramId!==t.shaderProgram.id,_=d.renderStateId!==t.renderState.id;m&&(d.uniformMapDirtyFrame=l),g&&(d.shaderProgramDirtyFrame=l),_&&(d.renderStateDirtyFrame=l),d.uniformMap=t.uniformMap,d.shaderProgramId=t.shaderProgram.id,d.renderStateId=t.renderState.id;for(let y=0;y<r;++y){const r=s[y],b=a[y],T=o[y];let A,C,O,E=d[T];Object(n["a"])(E)?(A=E.uniformMap,C=E.shaderProgram,O=E.renderState):(A=void 0,C=void 0,O=void 0),E=c["a"].shallowClone(t,E),d[T]=E;const v=Object(i["a"])(E.derivedCommands.uniformMapDirtyFrame,0),S=Object(i["a"])(E.derivedCommands.shaderProgramDirtyFrame,0),x=Object(i["a"])(E.derivedCommands.renderStateDirtyFrame,0),D=m||v<h,R=g||S<f,L=_||x<p;D&&(E.derivedCommands.uniformMapDirtyFrame=l),R&&(E.derivedCommands.shaderProgramDirtyFrame=l),L&&(E.derivedCommands.renderStateDirtyFrame=l),E.derivedCommands.type=b,E.pass=r.pass,E.pickOnly=r.pickOnly,E.uniformMap=X(e,t.uniformMap,A,D,r.getUniformMapFunction),E.shaderProgram=B(u.context,t.shaderProgram,C,R,r.getShaderProgramFunction,T),E.renderState=K(t.renderState,O,L,r.getRenderStateFunction,r.renderStateCache)}}}function re(e,t,r,a,i,o,s){for(let c=0;c<t;++c){const t=e[c],u=t.derivedCommands.type;(!Object(n["a"])(s)||s.indexOf(u)>-1)&&r(t,a,i,o)}}function ae(e,t,r,a,i,n){for(let o=0;o<t;++o)r(e[o],a,i,n)}y.prototype.updateDerivedCommands=function(e,t){const r=this._derivedCommandTypesToUpdate,a=this._derivedCommandsToUpdateLength;if(0!==a){for(let e=0;e<a;++e)ee[e]=this._derivedCommandPacks[r[e]],Z[e]=_[r[e]];te(this,e,a,r,Z,ee,t)}},y.prototype.pushDerivedCommands=function(e,t,r){const a=r.passes.pick;if(a&&t)return;let i=this._derivedCommandTypes,n=this._derivedCommandsLength;if(a?(i=this._derivedPickCommandTypes,n=this._derivedPickCommandsLength):t&&(i=this._derivedBlendCommandTypes,n=this._derivedBlendCommandsLength),0===n)return void r.commandList.push(e);const o=e.derivedCommands.globeTranslucency;for(let s=0;s<n;++s){const e=_[i[s]];r.commandList.push(o[e])}};const ie=[m.OPAQUE_FRONT_FACE,m.OPAQUE_BACK_FACE],ne=[m.DEPTH_ONLY_FRONT_FACE,m.DEPTH_ONLY_BACK_FACE,m.DEPTH_ONLY_FRONT_AND_BACK_FACE];y.prototype.executeGlobeCommands=function(e,t,r,a,i){const n=a.context,o=e.commands[u["a"].GLOBE],s=e.indices[u["a"].GLOBE];0!==s&&(this._globeTranslucencyFramebuffer=r,r.clearClassification(n,i),re(o,s,t,a,n,i,ie))},y.prototype.executeGlobeClassificationCommands=function(e,t,r,a,i){const n=a.context,o=e.commands[u["a"].GLOBE],s=e.indices[u["a"].GLOBE],c=e.commands[u["a"].TERRAIN_CLASSIFICATION],d=e.indices[u["a"].TERRAIN_CLASSIFICATION];if(0===s||0===d)return;const l=this._frontFaceTranslucent,h=this._backFaceTranslucent;if(l&&h||ae(c,d,t,a,n,i),!l&&!h)return;this._globeTranslucencyFramebuffer=r;const f=n.uniformState.globeDepthTexture,p=i.framebuffer;if(i.framebuffer=r.classificationFramebuffer,re(o,s,t,a,n,i,ne),n.depthTexture){const e=r.packDepth(n,i);n.uniformState.globeDepthTexture=e}ae(c,d,t,a,n,i),n.uniformState.globeDepthTexture=f,i.framebuffer=p},t["a"]=y},8004:function(e,t,r){"use strict";var a=r("77af"),i=r("bd8d"),n=r("2f63"),o=r("7d62"),s=r("f845"),c=r("f630"),u=r("6ef5"),d=r("6dc0"),l=r("987b");function h(){this._framebuffer=new c["a"]({depthStencil:!0,supportsDepthTexture:!0}),this._packedDepthFramebuffer=new c["a"],this._renderState=void 0,this._packedDepthCommand=void 0,this._clearCommand=void 0,this._viewport=new a["a"],this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0}function f(e){e._framebuffer.destroy(),e._packedDepthFramebuffer.destroy()}function p(e,t,r,a,i){const n=i?t.halfFloatingPointTexture?u["a"].HALF_FLOAT:u["a"].FLOAT:u["a"].UNSIGNED_BYTE;e._framebuffer.update(t,r,a,1,n),e._packedDepthFramebuffer.update(t,r,a)}function m(e,t,r,o,c){e._viewport.width=r,e._viewport.height=o;const u=!a["a"].equals(e._viewport,c.viewport);let h=u!==e._useScissorTest;e._useScissorTest=u,a["a"].equals(e._scissorRectangle,c.viewport)||(e._scissorRectangle=a["a"].clone(c.viewport,e._scissorRectangle),h=!0),Object(n["a"])(e._renderState)&&a["a"].equals(e._viewport,e._renderState.viewport)&&!h||(e._renderState=d["a"].fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),Object(n["a"])(e._packedDepthCommand)||(e._packedDepthCommand=t.createViewportQuadCommand(l["a"],{uniformMap:{u_depthTexture:function(){return e.depthStencilTexture}},owner:e})),Object(n["a"])(e._clearCommand)||(e._clearCommand=new s["a"]({color:new i["a"](0,0,0,0),depth:1,stencil:0,owner:e})),e._packedDepthCommand.framebuffer=e._packedDepthFramebuffer.framebuffer,e._packedDepthCommand.renderState=e._renderState,e._clearCommand.framebuffer=e.classificationFramebuffer,e._clearCommand.renderState=e._renderState}Object.defineProperties(h.prototype,{classificationTexture:{get:function(){return this._framebuffer.getColorTexture()}},classificationFramebuffer:{get:function(){return this._framebuffer.framebuffer}},packedDepthFramebuffer:{get:function(){return this._packedDepthFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._framebuffer.getDepthStencilTexture()}},depthStencilRenderbuffer:{get:function(){return this._framebuffer.getDepthStencilRenderbuffer()}},packedDepthTexture:{get:function(){return this._packedDepthFramebuffer.getColorTexture()}}}),h.prototype.updateAndClear=function(e,t,r,a){const i=t.width,n=t.height;p(this,r,i,n,e),m(this,r,i,n,a),this._useHdr=e},h.prototype.clearClassification=function(e,t){this._clearCommand.execute(e,t)},h.prototype.packDepth=function(e,t){return this._packedDepthCommand.execute(e,t),this.packedDepthTexture},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return f(this),Object(o["a"])(this)},t["a"]=h},ceee:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var a=r("abab"),i=r("535a"),n=r("9c35"),o=r("2f63"),s=r("0123"),c=r("f20a"),u=r("8b68"),d=r("568a"),l=r("aa13"),h=r("2773");function f(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT);const t=e.resourceCache,r=e.gltf,a=e.accessorId,o=e.gltfResource,s=e.baseResource,c=e.draco,u=e.cacheKey,d=Object(i["a"])(e.asynchronous,!0),l=Object(i["a"])(e.loadAsTypedArray,!1),f=r.accessors[a].componentType;this._resourceCache=t,this._gltfResource=o,this._baseResource=s,this._gltf=r,this._accessorId=a,this._indexDatatype=f,this._draco=c,this._cacheKey=u,this._asynchronous=d,this._loadAsTypedArray=l,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=h["a"].UNLOADED,this._promise=Object(n["a"])()}function p(e){const t=e._resourceCache,r=t.loadDraco({gltf:e._gltf,draco:e._draco,gltfResource:e._gltfResource,baseResource:e._baseResource});e._dracoLoader=r,e._state=h["a"].LOADING,r.promise.then((function(){if(e.isDestroyed())return;const t=r.decodedData.indices.typedArray;e._typedArray=t,e._indexDatatype=a["a"].fromTypedArray(t),e._state=h["a"].PROCESSING})).catch((function(t){e.isDestroyed()||_(e,t)}))}function m(e){const t=e._gltf,r=e._accessorId,a=t.accessors[r],i=a.bufferView,n=e._resourceCache,o=n.loadBufferView({gltf:t,bufferViewId:i,gltfResource:e._gltfResource,baseResource:e._baseResource});e._state=h["a"].LOADING,e._bufferViewLoader=o,o.promise.then((function(){if(e.isDestroyed())return;const t=o.typedArray;e._typedArray=g(e,t),e._state=h["a"].PROCESSING})).catch((function(t){e.isDestroyed()||_(e,t)}))}function g(e,t){const r=e._gltf,a=e._accessorId,i=r.accessors[a],n=i.count,o=i.componentType,c=t.buffer,u=t.byteOffset+i.byteOffset;let d;return o===s["a"].UNSIGNED_BYTE?d=new Uint8Array(c,u,n):o===s["a"].UNSIGNED_SHORT?d=new Uint16Array(c,u,n):o===s["a"].UNSIGNED_INT&&(d=new Uint32Array(c,u,n)),d}function _(e,t){e.unload(),e._state=h["a"].FAILED;const r="Failed to load index buffer";t=e.getError(r,t),e._promise.reject(t)}function y(){this.typedArray=void 0,this.indexDatatype=void 0,this.context=void 0,this.buffer=void 0}function b(e,t,r){const a=c["a"].createIndexBuffer({typedArray:e,context:r,usage:u["a"].STATIC_DRAW,indexDatatype:t});return a.vertexArrayDestroyable=!1,a}Object(o["a"])(Object.create)&&(f.prototype=Object.create(l["a"].prototype),f.prototype.constructor=f),Object.defineProperties(f.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},indexDatatype:{get:function(){return this._indexDatatype}}}),f.prototype.load=function(){Object(o["a"])(this._draco)?p(this):m(this)},y.prototype.set=function(e,t,r){this.typedArray=e,this.indexDatatype=t,this.context=r},y.prototype.execute=function(){this.buffer=b(this.typedArray,this.indexDatatype,this.context)};const T=new y;f.prototype.process=function(e){if(this._state===h["a"].READY)return;const t=this._typedArray,r=this._indexDatatype;if(Object(o["a"])(this._dracoLoader)&&this._dracoLoader.process(e),Object(o["a"])(this._bufferViewLoader)&&this._bufferViewLoader.process(e),!Object(o["a"])(t))return;const a=e.context.webgl2;if(this._loadAsTypedArray||!a)return this.unload(),this._typedArray=t,this._state=h["a"].READY,void this._promise.resolve(this);let i;if(this._asynchronous){const a=T;a.set(t,r,e.context);const n=e.jobScheduler;if(!n.execute(a,d["a"].BUFFER))return;i=a.buffer}else i=b(t,r,e.context);this.unload(),this._buffer=i,this._state=h["a"].READY,this._promise.resolve(this)},f.prototype.unload=function(){Object(o["a"])(this._buffer)&&this._buffer.destroy();const e=this._resourceCache;Object(o["a"])(this._bufferViewLoader)&&e.unload(this._bufferViewLoader),Object(o["a"])(this._dracoLoader)&&e.unload(this._dracoLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0}},d9c0:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r("535a"),i=r("9c35"),n=r("2f63"),o=r("d69d"),s=r("7ceb"),c=r("283e"),u=r("aa13"),d=r("2773");function l(e){e=Object(a["a"])(e,a["a"].EMPTY_OBJECT);const t=e.resourceCache,r=e.gltf,n=e.imageId,o=e.gltfResource,s=e.baseResource,c=e.cacheKey,u=r.images[n],l=u.bufferView,h=u.uri;this._resourceCache=t,this._gltfResource=o,this._baseResource=s,this._gltf=r,this._bufferViewId=l,this._uri=h,this._cacheKey=c,this._bufferViewLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._state=d["a"].UNLOADED,this._promise=Object(i["a"])()}function h(e){let t;return Array.isArray(e)&&(t=e.slice(1,e.length).map((function(e){return e.bufferView})),e=e[0]),{image:e,mipLevels:t}}function f(e){const t=e._resourceCache,r=t.loadBufferView({gltf:e._gltf,bufferViewId:e._bufferViewId,gltfResource:e._gltfResource,baseResource:e._baseResource});e._bufferViewLoader=r,e._state=d["a"].LOADING,r.promise.then((function(){if(e.isDestroyed())return;const t=r.typedArray;return _(t).then((function(t){if(e.isDestroyed())return;const r=h(t);e.unload(),e._image=r.image,e._mipLevels=r.mipLevels,e._state=d["a"].READY,e._promise.resolve(e)}))})).catch((function(t){e.isDestroyed()||m(e,t,"Failed to load embedded image")}))}function p(e){const t=e._baseResource,r=e._uri,a=t.getDerivedResource({url:r});e._state=d["a"].LOADING,b(a).then((function(t){if(e.isDestroyed())return;const r=h(t);e.unload(),e._image=r.image,e._mipLevels=r.mipLevels,e._state=d["a"].READY,e._promise.resolve(e)})).catch((function(t){e.isDestroyed()||m(e,t,"Failed to load image: "+r)}))}function m(e,t,r){e.unload(),e._state=d["a"].FAILED,e._promise.reject(e.getError(r,t))}function g(e){const t=e.subarray(0,2),r=e.subarray(0,4),a=e.subarray(8,12);if(255===t[0]&&216===t[1])return"image/jpeg";if(137===t[0]&&80===t[1])return"image/png";if(171===t[0]&&75===t[1])return"image/ktx2";if(82===r[0]&&73===r[1]&&70===r[2]&&70===r[3]&&87===a[0]&&69===a[1]&&66===a[2]&&80===a[3])return"image/webp";throw new c["a"]("Image format is not recognized")}function _(e){const t=g(e);if("image/ktx2"===t){const t=new Uint8Array(e);return Object(s["a"])(t)}return l._loadImageFromTypedArray({uint8Array:e,format:t,flipY:!1,skipColorSpaceConversion:!0})}Object(n["a"])(Object.create)&&(l.prototype=Object.create(u["a"].prototype),l.prototype.constructor=l),Object.defineProperties(l.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},image:{get:function(){return this._image}},mipLevels:{get:function(){return this._mipLevels}}}),l.prototype.load=function(){Object(n["a"])(this._bufferViewId)?f(this):p(this)};const y=/(^data:image\/ktx2)|(\.ktx2$)/i;function b(e){const t=e.url;return y.test(t)?Object(s["a"])(e):e.fetchImage({skipColorSpaceConversion:!0,preferImageBitmap:!0})}l.prototype.unload=function(){Object(n["a"])(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._uri=void 0,this._image=void 0,this._mipLevels=void 0,this._gltf=void 0},l._loadImageFromTypedArray=o["a"]}}]);