(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~ba4fd1e9"],{2221:function(e,t,a){"use strict";var o=a("c8d1"),i=a("e438"),s=a("cef5"),n=a("670c"),r=a("be18"),h=a("a561"),c=a("bef8"),u=a("2f63"),d=a("4f04"),l=a("af23"),f=a("93da"),g=a("78e5"),m=a("9410"),T=a("eace"),w=a("0769"),x=a("4261"),_=a("fde5"),b=a("1184"),p=a("2856"),S=a("ee78");function y(e){this.tile=e,this.frameLastUpdated=void 0,this.westMeshes=[],this.westTiles=[],this.southMeshes=[],this.southTiles=[],this.eastMeshes=[],this.eastTiles=[],this.northMeshes=[],this.northTiles=[],this.southwestMesh=void 0,this.southwestTile=void 0,this.southeastMesh=void 0,this.southeastTile=void 0,this.northwestMesh=void 0,this.northwestTile=void 0,this.northeastMesh=void 0,this.northeastTile=void 0,this.changedThisFrame=!0,this.visitedFrame=void 0,this.enqueuedFrame=void 0,this.mesh=void 0,this.vertexArray=void 0,this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new h["a"]}y.prototype.update=function(e,t,a){this.changedThisFrame&&(G(e,t,this.tile,a),this.changedThisFrame=!1)},y.prototype.destroy=function(e){this._destroyVertexArray(e),Object(u["a"])(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0)},y.prototype._destroyVertexArray=function(e){Object(u["a"])(this.vertexArray)&&(Object(u["a"])(e)?e.push(this.vertexArray):p["a"]._freeVertexArray(this.vertexArray),this.vertexArray=void 0)};const O=new m["a"];function E(e,t,a,o,i,s,n,r,h){if(void 0===o)return;let c=o;while(c&&(c._lastSelectionResultFrame!==i||S["a"].wasKicked(c._lastSelectionResult)||S["a"].originalResult(c._lastSelectionResult)===S["a"].CULLED)){if(n)return;const e=c.parent;if(s>=_["a"].NORTHWEST&&void 0!==e)switch(s){case _["a"].NORTHWEST:c=c===e.northwestChild?e:void 0;break;case _["a"].NORTHEAST:c=c===e.northeastChild?e:void 0;break;case _["a"].SOUTHWEST:c=c===e.southwestChild?e:void 0;break;case _["a"].SOUTHEAST:c=c===e.southeastChild?e:void 0;break}else c=e}if(void 0!==c)if(c._lastSelectionResult!==S["a"].RENDERED){if(S["a"].originalResult(o._lastSelectionResult)!==S["a"].CULLED)switch(s){case _["a"].WEST:E(e,t,a,o.northwestChild,i,s,!0,r,h),E(e,t,a,o.southwestChild,i,s,!0,r,h);break;case _["a"].EAST:E(e,t,a,o.southeastChild,i,s,!0,r,h),E(e,t,a,o.northeastChild,i,s,!0,r,h);break;case _["a"].SOUTH:E(e,t,a,o.southwestChild,i,s,!0,r,h),E(e,t,a,o.southeastChild,i,s,!0,r,h);break;case _["a"].NORTH:E(e,t,a,o.northeastChild,i,s,!0,r,h),E(e,t,a,o.northwestChild,i,s,!0,r,h);break;case _["a"].NORTHWEST:E(e,t,a,o.northwestChild,i,s,!0,r,h);break;case _["a"].NORTHEAST:E(e,t,a,o.northeastChild,i,s,!0,r,h);break;case _["a"].SOUTHWEST:E(e,t,a,o.southwestChild,i,s,!0,r,h);break;case _["a"].SOUTHEAST:E(e,t,a,o.southeastChild,i,s,!0,r,h);break;default:throw new d["a"]("Invalid edge")}}else{if(Object(u["a"])(c.data.vertexArray))return;M(e,t,a,c,s,i,r,h)}}function M(e,t,a,o,i,s,n,r){const h=o.data;if(void 0===h.fill)h.fill=new y(o);else if(h.fill.visitedFrame===s)return;h.fill.enqueuedFrame!==s&&(h.fill.enqueuedFrame=s,h.fill.changedThisFrame=!1,n.enqueue(o)),v(e,t,a,o,i,r)}function v(e,t,a,o,i,s){const n=o.data.fill;let r;const h=a.data.fill;let c,d,l,g,m,T;switch(Object(u["a"])(h)?(h.visitedFrame=t.frameNumber,h.changedThisFrame&&(G(e,t,a,s),h.changedThisFrame=!1),r=a.data.fill.mesh):r=a.data.mesh,i){case _["a"].WEST:c=n.westMeshes,d=n.westTiles;break;case _["a"].SOUTH:c=n.southMeshes,d=n.southTiles;break;case _["a"].EAST:c=n.eastMeshes,d=n.eastTiles;break;case _["a"].NORTH:c=n.northMeshes,d=n.northTiles;break;case _["a"].NORTHWEST:return n.changedThisFrame=n.changedThisFrame||n.northwestMesh!==r,n.northwestMesh=r,void(n.northwestTile=a);case _["a"].NORTHEAST:return n.changedThisFrame=n.changedThisFrame||n.northeastMesh!==r,n.northeastMesh=r,void(n.northeastTile=a);case _["a"].SOUTHWEST:return n.changedThisFrame=n.changedThisFrame||n.southwestMesh!==r,n.southwestMesh=r,void(n.southwestTile=a);case _["a"].SOUTHEAST:return n.changedThisFrame=n.changedThisFrame||n.southeastMesh!==r,n.southeastMesh=r,void(n.southeastTile=a)}if(a.level<=o.level)return n.changedThisFrame=n.changedThisFrame||c[0]!==r||1!==c.length,c[0]=r,d[0]=a,c.length=1,void(d.length=1);const w=a.rectangle;let x;const b=o.rectangle;switch(i){case _["a"].WEST:for(x=(b.north-b.south)*f["a"].EPSILON5,l=0;l<d.length;++l)if(m=d[l],T=m.rectangle,f["a"].greaterThan(w.north,T.south,x))break;for(g=l;g<d.length;++g)if(m=d[g],T=m.rectangle,f["a"].greaterThanOrEquals(w.south,T.north,x))break;break;case _["a"].SOUTH:for(x=(b.east-b.west)*f["a"].EPSILON5,l=0;l<d.length;++l)if(m=d[l],T=m.rectangle,f["a"].lessThan(w.west,T.east,x))break;for(g=l;g<d.length;++g)if(m=d[g],T=m.rectangle,f["a"].lessThanOrEquals(w.east,T.west,x))break;break;case _["a"].EAST:for(x=(b.north-b.south)*f["a"].EPSILON5,l=0;l<d.length;++l)if(m=d[l],T=m.rectangle,f["a"].lessThan(w.south,T.north,x))break;for(g=l;g<d.length;++g)if(m=d[g],T=m.rectangle,f["a"].lessThanOrEquals(w.north,T.south,x))break;break;case _["a"].NORTH:for(x=(b.east-b.west)*f["a"].EPSILON5,l=0;l<d.length;++l)if(m=d[l],T=m.rectangle,f["a"].greaterThan(w.east,T.west,x))break;for(g=l;g<d.length;++g)if(m=d[g],T=m.rectangle,f["a"].greaterThanOrEquals(w.west,T.east,x))break;break}g-l===1?(n.changedThisFrame=n.changedThisFrame||c[l]!==r,c[l]=r,d[l]=a):(n.changedThisFrame=!0,c.splice(l,g-l,r),d.splice(l,g-l,a))}y.updateFillTiles=function(e,t,a,o){const i=e._quadtree,s=i._levelZeroTiles,n=i._lastSelectionFrameNumber,r=O;r.clear();for(let c=0;c<t.length;++c){const e=t[c];Object(u["a"])(e.data.vertexArray)&&r.enqueue(t[c])}let h=r.dequeue();while(void 0!==h){const t=h.findTileToWest(s),i=h.findTileToSouth(s),c=h.findTileToEast(s),u=h.findTileToNorth(s);E(e,a,h,t,n,_["a"].EAST,!1,r,o),E(e,a,h,i,n,_["a"].NORTH,!1,r,o),E(e,a,h,c,n,_["a"].WEST,!1,r,o),E(e,a,h,u,n,_["a"].SOUTH,!1,r,o);const d=t.findTileToNorth(s),l=t.findTileToSouth(s),f=c.findTileToNorth(s),g=c.findTileToSouth(s);E(e,a,h,d,n,_["a"].SOUTHEAST,!1,r,o),E(e,a,h,f,n,_["a"].SOUTHWEST,!1,r,o),E(e,a,h,l,n,_["a"].NORTHEAST,!1,r,o),E(e,a,h,g,n,_["a"].NORTHWEST,!1,r,o),h=r.dequeue()}};const N=new c["a"],A=new c["a"],C=new r["a"],I=new r["a"],R=new n["a"],H=new n["a"],L=new n["a"];function W(){this.height=0,this.encodedNormal=new n["a"]}function F(e,t,a,o,i,s,n,r,h){if(Object(u["a"])(i))return i;let c;if(Object(u["a"])(s)&&Object(u["a"])(n))c=.5*(s.height+n.height);else if(Object(u["a"])(s))c=s.height;else if(Object(u["a"])(n))c=n.height;else if(Object(u["a"])(r))c=r.height;else{const t=e.tile.data,a=t.tileBoundingRegion;let o=0,i=0;Object(u["a"])(a)&&(o=a.minimumHeight,i=a.maximumHeight),c=.5*(o+i)}return ee(e,t,a,o,c,h),h}const P={minimumHeight:0,maximumHeight:0},j=new r["a"],k=new W,U=new W,D=new W,B=new W,V="undefined"!==typeof Uint8Array?new Uint8Array(81):void 0,z={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0};function G(e,t,a,i){p["a"].initialize(a,e.terrainProvider,e._imageryLayers);const r=a.data,h=r.fill,c=a.rectangle,d=t.terrainExaggeration,f=t.terrainExaggerationRelativeHeight,m=1!==d,S=a.tilingScheme.ellipsoid;let y=te(h,S,0,1,h.northwestTile,h.northwestMesh,h.northTiles,h.northMeshes,h.westTiles,h.westMeshes,D),O=te(h,S,0,0,h.southwestTile,h.southwestMesh,h.westTiles,h.westMeshes,h.southTiles,h.southMeshes,k),E=te(h,S,1,0,h.southeastTile,h.southeastMesh,h.southTiles,h.southMeshes,h.eastTiles,h.eastMeshes,U),M=te(h,S,1,1,h.northeastTile,h.northeastMesh,h.eastTiles,h.eastMeshes,h.northTiles,h.northMeshes,B);y=F(h,S,0,1,y,O,M,E,D),O=F(h,S,0,0,O,y,E,M,k),E=F(h,S,1,1,E,O,M,y,U),M=F(h,S,1,1,M,E,y,O,B);const v=O.height,C=E.height,H=y.height,W=M.height;let G=Math.min(v,C,H,W),Y=Math.max(v,C,H,W);const J=.5*(G+Y);let Z,X;const K=e.getLevelMaximumGeometricError(a.level),Q=S.maximumRadius-K;let $=4*Math.acos(Q/S.maximumRadius);if($*=1.5,c.width>$&&Y-G<=K){const e=new l["a"]({width:9,height:9,buffer:V,structure:{heightOffset:Y}}),t=z;t.tilingScheme=a.tilingScheme,t.x=a.x,t.y=a.y,t.level=a.level,t.exaggeration=d,t.exaggerationRelativeHeight=f,h.mesh=e._createMeshSync(t)}else{const t=m,i=T["a"].center(c,A);i.height=J;const r=S.cartographicToCartesian(i,j),u=new w["a"](r,void 0,void 0,void 0,void 0,!0,!0,t,d,f);let l,p=5;for(l=h.westMeshes,Z=0,X=l.length;Z<X;++Z)p+=l[Z].eastIndicesNorthToSouth.length;for(l=h.southMeshes,Z=0,X=l.length;Z<X;++Z)p+=l[Z].northIndicesWestToEast.length;for(l=h.eastMeshes,Z=0,X=l.length;Z<X;++Z)p+=l[Z].westIndicesSouthToNorth.length;for(l=h.northMeshes,Z=0,X=l.length;Z<X;++Z)p+=l[Z].southIndicesEastToWest.length;const v=P;v.minimumHeight=G,v.maximumHeight=Y;const C=u.stride;let H=new Float32Array(p*C),W=0;const F=W;W=q(S,c,u,H,W,0,1,y.height,y.encodedNormal,1,v),W=oe(h,S,u,H,W,h.westTiles,h.westMeshes,_["a"].EAST,v);const k=W;W=q(S,c,u,H,W,0,0,O.height,O.encodedNormal,0,v),W=oe(h,S,u,H,W,h.southTiles,h.southMeshes,_["a"].NORTH,v);const U=W;W=q(S,c,u,H,W,1,0,E.height,E.encodedNormal,0,v),W=oe(h,S,u,H,W,h.eastTiles,h.eastMeshes,_["a"].WEST,v);const D=W;W=q(S,c,u,H,W,1,1,M.height,M.encodedNormal,1,v),W=oe(h,S,u,H,W,h.northTiles,h.northMeshes,_["a"].SOUTH,v),G=v.minimumHeight,Y=v.maximumHeight;const B=g["a"].fromRectangle(c,G,Y,a.tilingScheme.ellipsoid),V=b["a"].geodeticLatitudeToMercatorAngle(c.south),z=1/(b["a"].geodeticLatitudeToMercatorAngle(c.north)-V),K=(b["a"].geodeticLatitudeToMercatorAngle(i.latitude)-V)*z,Q=S.geodeticSurfaceNormalCartographic(N,I),$=o["a"].octEncode(Q,R),ee=W;u.encode(H,W*C,B.center,n["a"].fromElements(.5,.5,L),J,$,K,Q),++W;const te=W,ae=te<256?1:2,ie=3*(te-1),se=ie*ae,ne=(H.length-te*C)*Float32Array.BYTES_PER_ELEMENT;let re;if(ne>=se){const e=te*C*Float32Array.BYTES_PER_ELEMENT;re=te<256?new Uint8Array(H.buffer,e,ie):new Uint16Array(H.buffer,e,ie)}else re=te<256?new Uint8Array(ie):new Uint16Array(ie);H=new Float32Array(H.buffer,0,te*C);let he=0;for(Z=0;Z<te-2;++Z)re[he++]=ee,re[he++]=Z,re[he++]=Z+1;re[he++]=ee,re[he++]=Z,re[he++]=0;const ue=[];for(Z=k;Z>=F;--Z)ue.push(Z);const de=[];for(Z=U;Z>=k;--Z)de.push(Z);const le=[];for(Z=D;Z>=U;--Z)le.push(Z);const fe=[];for(fe.push(0),Z=ee-1;Z>=D;--Z)fe.push(Z);h.mesh=new x["a"](u.center,H,re,ie,te,G,Y,s["a"].fromOrientedBoundingBox(B),ce(e,B.center,c,G,Y),u.stride,B,u,ue,de,le,fe)}const ee=t.context;h._destroyVertexArray(i),h.vertexArray=p["a"]._createVertexArrayForMesh(ee,h.mesh),r.processImagery(a,e.terrainProvider,t,!0);const ae=h.waterMaskTexture;if(h.waterMaskTexture=void 0,e.terrainProvider.hasWaterMask){const e=r._findAncestorTileWithTerrainData(a);Object(u["a"])(e)&&Object(u["a"])(e.data.waterMaskTexture)&&(h.waterMaskTexture=e.data.waterMaskTexture,++h.waterMaskTexture.referenceCount,r._computeWaterMaskTranslationAndScale(a,e,h.waterMaskTranslationAndScale))}Object(u["a"])(ae)&&(--ae.referenceCount,0===ae.referenceCount&&ae.destroy())}function q(e,t,a,o,i,s,n,r,h,c,u){const d=N;d.longitude=f["a"].lerp(t.west,t.east,s),d.latitude=f["a"].lerp(t.south,t.north,n),d.height=r;const l=e.cartographicToCartesian(d,C);let g;a.hasGeodeticSurfaceNormals&&(g=e.geodeticSurfaceNormal(l,I));const m=H;return m.x=s,m.y=n,a.encode(o,i*a.stride,l,m,r,h,c,g),u.minimumHeight=Math.min(u.minimumHeight,r),u.maximumHeight=Math.max(u.maximumHeight,r),i+1}const Y=new T["a"];function J(e,t,a,o){let i=e.rectangle;const s=t.rectangle;0===t.x&&1===a.x&&e.x===e.tilingScheme.getNumberOfXTilesAtLevel(e.level)-1?(i=T["a"].clone(e.rectangle,Y),i.west-=f["a"].TWO_PI,i.east-=f["a"].TWO_PI):0===e.x&&0===a.x&&t.x===t.tilingScheme.getNumberOfXTilesAtLevel(t.level)-1&&(i=T["a"].clone(e.rectangle,Y),i.west+=f["a"].TWO_PI,i.east+=f["a"].TWO_PI);const n=i.east-i.west,r=(s.west-i.west)/n,h=(s.east-i.west)/n,c=i.north-i.south,u=(s.south-i.south)/c,d=(s.north-i.south)/c;let l=(a.x-r)/(h-r),g=(a.y-u)/(d-u);return Math.abs(l)<Math.EPSILON5?l=0:Math.abs(l-1)<Math.EPSILON5&&(l=1),Math.abs(g)<Math.EPSILON5?g=0:Math.abs(g-1)<Math.EPSILON5&&(g=1),o.x=l,o.y=g,o}const Z=new n["a"];function X(e,t,a,o,i){const s=e.encoding,n=e.vertices;if(i.height=s.decodeHeight(n,t),s.hasVertexNormals)s.getOctEncodedNormal(n,t,i.encodedNormal);else{const e=i.encodedNormal;e.x=0,e.y=0}}const K=new n["a"],Q=new r["a"];function $(e,t,a,i,s,n,h,c,u,d){const l=i.encoding,g=i.vertices,m=J(t,a,l.decodeTextureCoordinates(g,s,L),L),T=J(t,a,l.decodeTextureCoordinates(g,n,H),H);let w;w=u?(h-m.x)/(T.x-m.x):(c-m.y)/(T.y-m.y);const x=l.decodeHeight(g,s),_=l.decodeHeight(g,n),b=a.rectangle;let p;if(N.longitude=f["a"].lerp(b.west,b.east,h),N.latitude=f["a"].lerp(b.south,b.north,c),d.height=N.height=f["a"].lerp(x,_,w),l.hasVertexNormals){const e=l.getOctEncodedNormal(g,s,Z),t=l.getOctEncodedNormal(g,n,K),a=o["a"].octDecode(e.x,e.y,C),i=o["a"].octDecode(t.x,t.y,Q);p=r["a"].lerp(a,i,w,C),r["a"].normalize(p,p),o["a"].octEncode(p,d.encodedNormal)}else p=e.geodeticSurfaceNormalCartographic(N,C),o["a"].octEncode(p,d.encodedNormal)}function ee(e,t,a,i,s,n){n.height=s;const r=t.geodeticSurfaceNormalCartographic(N,C);o["a"].octEncode(r,n.encodedNormal)}function te(e,t,a,o,i,s,n,r,h,c,d){const l=re(e,t,r,n,!1,a,o,d)||re(e,t,c,h,!0,a,o,d);if(l)return d;let f,g;return ne(i,s)?(f=0===a?0===o?s.eastIndicesNorthToSouth[0]:s.southIndicesEastToWest[0]:0===o?s.northIndicesWestToEast[0]:s.westIndicesSouthToNorth[0],X(s,f,a,o,d),d):(g=0===a?0===o?ae(e.westMeshes,e.westTiles,_["a"].EAST,e.southMeshes,e.southTiles,_["a"].NORTH,a,o):ae(e.northMeshes,e.northTiles,_["a"].SOUTH,e.westMeshes,e.westTiles,_["a"].EAST,a,o):0===o?ae(e.southMeshes,e.southTiles,_["a"].NORTH,e.eastMeshes,e.eastTiles,_["a"].WEST,a,o):ae(e.eastMeshes,e.eastTiles,_["a"].WEST,e.northMeshes,e.northTiles,_["a"].SOUTH,a,o),Object(u["a"])(g)?(ee(e,t,a,o,g,d),d):void 0)}function ae(e,t,a,o,i,s,n,r){const h=se(e,t,!1,a,n,r),c=se(o,i,!0,s,n,r);return Object(u["a"])(h)&&Object(u["a"])(c)?.5*(h+c):Object(u["a"])(h)?h:c}function oe(e,t,a,o,i,s,n,r,h){for(let c=0;c<s.length;++c)i=ie(e,t,a,o,i,s[c],n[c],r,h);return i}function ie(e,t,a,o,i,s,n,r,h){let c=s.rectangle;r===_["a"].EAST&&0===e.tile.x?(c=T["a"].clone(s.rectangle,Y),c.west-=f["a"].TWO_PI,c.east-=f["a"].TWO_PI):r===_["a"].WEST&&0===s.x&&(c=T["a"].clone(s.rectangle,Y),c.west+=f["a"].TWO_PI,c.east+=f["a"].TWO_PI);const u=e.tile.rectangle;let d,l,g,m;switch(i>0&&(a.decodeTextureCoordinates(o,i-1,L),d=L.x,l=L.y),r){case _["a"].WEST:g=n.westIndicesSouthToNorth,m=!1;break;case _["a"].NORTH:g=n.northIndicesWestToEast,m=!0;break;case _["a"].EAST:g=n.eastIndicesNorthToSouth,m=!1;break;case _["a"].SOUTH:g=n.southIndicesEastToWest,m=!0;break}const w=s,x=e.tile,p=n.encoding,S=n.vertices,y=a.stride;let O,E;p.hasWebMercatorT&&(O=b["a"].geodeticLatitudeToMercatorAngle(u.south),E=1/(b["a"].geodeticLatitudeToMercatorAngle(u.north)-O));for(let T=0;T<g.length;++T){const e=g[T],s=p.decodeTextureCoordinates(S,e,L);J(w,x,s,s);const n=s.x,r=s.y,c=m?n:r;if(c<0||c>1)continue;if(Math.abs(n-d)<f["a"].EPSILON5&&Math.abs(r-l)<f["a"].EPSILON5)continue;const _=Math.abs(n)<f["a"].EPSILON5||Math.abs(n-1)<f["a"].EPSILON5,M=Math.abs(r)<f["a"].EPSILON5||Math.abs(r-1)<f["a"].EPSILON5;if(_&&M)continue;const v=p.decodePosition(S,e,C),N=p.decodeHeight(S,e);let A;p.hasVertexNormals?A=p.getOctEncodedNormal(S,e,R):(A=R,A.x=0,A.y=0);let H,W=r;if(p.hasWebMercatorT){const e=f["a"].lerp(u.south,u.north,r);W=(b["a"].geodeticLatitudeToMercatorAngle(e)-O)*E}a.hasGeodeticSurfaceNormals&&(H=t.geodeticSurfaceNormal(v,I)),a.encode(o,i*y,v,s,N,A,W,H),h.minimumHeight=Math.min(h.minimumHeight,N),h.maximumHeight=Math.max(h.maximumHeight,N),++i}return i}function se(e,t,a,o,i,s){let n,r,h;a?(n=0,r=e.length,h=1):(n=e.length-1,r=-1,h=-1);for(let c=n;c!==r;c+=h){const i=e[c],s=t[c];if(!ne(s,i))continue;let n;switch(o){case _["a"].WEST:n=i.westIndicesSouthToNorth;break;case _["a"].SOUTH:n=i.southIndicesEastToWest;break;case _["a"].EAST:n=i.eastIndicesNorthToSouth;break;case _["a"].NORTH:n=i.northIndicesWestToEast;break}const r=n[a?0:n.length-1];if(Object(u["a"])(r))return i.encoding.decodeHeight(i.vertices,r)}}function ne(e,t){return Object(u["a"])(t)&&(!Object(u["a"])(e.data.fill)||!e.data.fill.changedThisFrame)}function re(e,t,a,o,s,n,r,h){let c,u,d,l,f;const g=o[s?0:a.length-1],m=a[s?0:a.length-1];if(ne(g,m)&&(0===n?0===r?(c=s?m.northIndicesWestToEast:m.eastIndicesNorthToSouth,u=s,d=s):(c=s?m.eastIndicesNorthToSouth:m.southIndicesEastToWest,u=!s,d=!1):0===r?(c=s?m.westIndicesSouthToNorth:m.northIndicesWestToEast,u=!s,d=!0):(c=s?m.southIndicesEastToWest:m.westIndicesSouthToNorth,u=s,d=!s),c.length>0)){l=s?0:c.length-1,f=c[l],m.encoding.decodeTextureCoordinates(m.vertices,f,L);const a=J(g,e.tile,L,L);if(a.x===n&&a.y===r)return X(m,f,n,r,h),!0;if(l=Object(i["a"])(c,u?n:r,(function(t,a){m.encoding.decodeTextureCoordinates(m.vertices,t,L);const o=J(g,e.tile,L,L);return d?u?o.x-n:o.y-r:u?n-o.x:r-o.y})),!(l<0))return X(m,c[l],n,r,h),!0;if(l=~l,l>0&&l<c.length)return $(t,g,e.tile,m,c[l-1],c[l],n,r,u,h),!0}return!1}const he=[new r["a"],new r["a"],new r["a"],new r["a"]];function ce(e,t,a,o,i,s){const n=e.quadtree._occluders.ellipsoid,h=n.ellipsoid,c=he;return r["a"].fromRadians(a.west,a.south,i,h,c[0]),r["a"].fromRadians(a.east,a.south,i,h,c[1]),r["a"].fromRadians(a.west,a.north,i,h,c[2]),r["a"].fromRadians(a.east,a.north,i,h,c[3]),n.computeHorizonCullingPointPossiblyUnderEllipsoid(t,c,o,s)}t["a"]=y},3334:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var o=a("535a");function i(e){e=Object(o["a"])(e,o["a"].EMPTY_OBJECT),this.webp=Object(o["a"])(e.webp,!1),this.basis=Object(o["a"])(e.basis,!1)}},"4c22":function(e,t,a){"use strict";const o={FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6};t["a"]=Object.freeze(o)},"7eb3":function(e,t,a){"use strict";var o=a("77af"),i=a("670c"),s=a("71ce"),n=a("535a"),r=a("2f63"),h=a("7d62"),c=a("e42d"),u=a("d4ed"),d=a("283e"),l=a("ac3b"),f=a("a913");function g(e,t,a,o,s){this.bottomLeft=Object(n["a"])(e,i["a"].ZERO),this.topRight=Object(n["a"])(t,i["a"].ZERO),this.childNode1=a,this.childNode2=o,this.imageIndex=s}const m=new i["a"](16,16);function T(e){e=Object(n["a"])(e,n["a"].EMPTY_OBJECT);const t=Object(n["a"])(e.borderWidthInPixels,1),a=Object(n["a"])(e.initialSize,m);this._context=e.context,this._pixelFormat=Object(n["a"])(e.pixelFormat,c["a"].RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=Object(s["a"])(),this._idHash={},this._indexHash={},this._initialSize=a,this._root=void 0}function w(e,t){const a=e._context,o=e.numberOfImages,s=2,n=e._borderWidthInPixels;if(o>0){const o=e._texture.width,h=e._texture.height,c=s*(o+t.width+n),u=s*(h+t.height+n),d=o/c,m=h/u,T=new g(new i["a"](o+n,n),new i["a"](c,h)),w=new g(new i["a"],new i["a"](c,h),e._root,T),x=new g(new i["a"](n,h+n),new i["a"](c,u)),_=new g(new i["a"],new i["a"](c,u),w,x);for(let t=0;t<e._textureCoordinates.length;t++){const a=e._textureCoordinates[t];Object(r["a"])(a)&&(a.x*=d,a.y*=m,a.width*=d,a.height*=m)}const b=new f["a"]({context:e._context,width:c,height:u,pixelFormat:e._pixelFormat}),p=new l["a"]({context:a,colorTextures:[e._texture],destroyAttachments:!1});p._bind(),b.copyFromFramebuffer(0,0,0,0,c,u),p._unBind(),p.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=b,e._root=_}else{let a=s*(t.width+2*n),o=s*(t.height+2*n);a<e._initialSize.x&&(a=e._initialSize.x),o<e._initialSize.y&&(o=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new f["a"]({context:e._context,width:a,height:o,pixelFormat:e._pixelFormat}),e._root=new g(new i["a"](n,n),new i["a"](a,o))}}function x(e,t,a){if(Object(r["a"])(t)){if(!Object(r["a"])(t.childNode1)&&!Object(r["a"])(t.childNode2)){if(Object(r["a"])(t.imageIndex))return;const o=t.topRight.x-t.bottomLeft.x,s=t.topRight.y-t.bottomLeft.y,n=o-a.width,h=s-a.height;if(n<0||h<0)return;if(0===n&&0===h)return t;if(n>h){t.childNode1=new g(new i["a"](t.bottomLeft.x,t.bottomLeft.y),new i["a"](t.bottomLeft.x+a.width,t.topRight.y));const o=t.bottomLeft.x+a.width+e._borderWidthInPixels;o<t.topRight.x&&(t.childNode2=new g(new i["a"](o,t.bottomLeft.y),new i["a"](t.topRight.x,t.topRight.y)))}else{t.childNode1=new g(new i["a"](t.bottomLeft.x,t.bottomLeft.y),new i["a"](t.topRight.x,t.bottomLeft.y+a.height));const o=t.bottomLeft.y+a.height+e._borderWidthInPixels;o<t.topRight.y&&(t.childNode2=new g(new i["a"](t.bottomLeft.x,o),new i["a"](t.topRight.x,t.topRight.y)))}return x(e,t.childNode1,a)}return x(e,t.childNode1,a)||x(e,t.childNode2,a)}}function _(e,t,a){const i=x(e,e._root,t);if(Object(r["a"])(i)){i.imageIndex=a;const s=e._texture.width,n=e._texture.height,r=i.topRight.x-i.bottomLeft.x,h=i.topRight.y-i.bottomLeft.y,c=i.bottomLeft.x/s,u=i.bottomLeft.y/n,d=r/s,l=h/n;e._textureCoordinates[a]=new o["a"](c,u,d,l),e._texture.copyFrom({source:t,xOffset:i.bottomLeft.x,yOffset:i.bottomLeft.y})}else w(e,t),_(e,t,a);e._guid=Object(s["a"])()}function b(e,t){if(!Object(r["a"])(e)||e.isDestroyed())return-1;const a=e.numberOfImages;return _(e,t,a),a}Object.defineProperties(T.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return Object(r["a"])(this._texture)||(this._texture=new f["a"]({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}}),T.prototype.getImageIndex=function(e){return this._indexHash[e]},T.prototype.addImageSync=function(e,t){let a=this._indexHash[e];return Object(r["a"])(a)||(a=b(this,t),this._idHash[e]=Promise.resolve(a),this._indexHash[e]=a),a},T.prototype.addImage=function(e,t){let a=this._idHash[e];if(Object(r["a"])(a))return a;if("function"===typeof t)t=t(e);else if("string"===typeof t||t instanceof u["a"]){const e=u["a"].createIfNeeded(t);t=e.fetchImage()}const o=this;return a=Promise.resolve(t).then((function(t){const a=b(o,t);return o._indexHash[e]=a,a})),this._idHash[e]=a,a},T.prototype.addSubRegion=function(e,t){const a=this._idHash[e];if(!Object(r["a"])(a))throw new d["a"](`image with id "${e}" not found in the atlas.`);const i=this;return Promise.resolve(a).then((function(e){if(-1===e)return-1;const a=i._texture.width,n=i._texture.height,r=i.numberOfImages,h=i._textureCoordinates[e],c=h.x+t.x/a,u=h.y+t.y/n,d=t.width/a,l=t.height/n;return i._textureCoordinates.push(new o["a"](c,u,d,l)),i._guid=Object(s["a"])(),r}))},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),Object(h["a"])(this)},t["a"]=T},ccf4:function(e,t,a){"use strict";var o=a("cef5"),i=a("670c"),s=a("be18"),n=a("a561"),r=a("abab"),h=a("2f63"),c=a("7d62"),u=a("0123"),d=a("93da"),l=a("52f0"),f=a("e42d"),g=a("1b8d"),m=a("f20a"),T=a("8b68"),w=a("5b54"),x=a("a894"),_=a("6ef5"),b=a("6dc0"),p=a("e90c"),S=a("a913"),y=a("7c5e"),O=a("563a"),E=a("a036"),M=a("7c36"),v=a("b7c8"),N=a("a307"),A=a("0c80");function C(){this.show=!0,this._drawCommand=new x["a"]({primitiveType:g["a"].TRIANGLES,boundingVolume:new o["a"],owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new o["a"],this._boundingVolume2D=new o["a"],this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1,this._useHdr=void 0;const e=this;this._uniformMap={u_texture:function(){return e._texture},u_size:function(){return e._size}}}Object.defineProperties(C.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});const I=new i["a"],R=new i["a"],H=new n["a"],L=new n["a"];C.prototype.update=function(e,t,a){if(!this.show)return;const n=e.mode;if(n===N["a"].SCENE2D||n===N["a"].MORPHING)return;if(!e.passes.render)return;const c=e.context,g=t.viewport.width,x=t.viewport.height;if(!Object(h["a"])(this._texture)||g!==this._drawingBufferWidth||x!==this._drawingBufferHeight||this._glowFactorDirty||a!==this._useHdr){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=g,this._drawingBufferHeight=x,this._glowFactorDirty=!1,this._useHdr=a;let e=Math.max(g,x);e=Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))-2),e=Math.max(1,e);const t=a?c.halfFloatingPointTexture?_["a"].HALF_FLOAT:_["a"].FLOAT:_["a"].UNSIGNED_BYTE;this._texture=new S["a"]({context:c,width:e,height:e,pixelFormat:f["a"].RGBA,pixelDatatype:t}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;const o=this,i={u_radiusTS:function(){return o._radiusTS}};this._commands.computeCommand=new w["a"]({fragmentShaderSource:E["a"],outputTexture:this._texture,uniformMap:i,persists:!1,owner:this,postExecute:function(){o._commands.computeCommand=void 0}})}const C=this._drawCommand;if(!Object(h["a"])(C.vertexArray)){const e={direction:0},t=new Uint8Array(8);t[0]=0,t[1]=0,t[2]=255,t[3]=0,t[4]=255,t[5]=255,t[6]=0,t[7]=255;const a=m["a"].createVertexBuffer({context:c,typedArray:t,usage:T["a"].STATIC_DRAW}),o=[{index:e.direction,vertexBuffer:a,componentsPerAttribute:2,normalize:!0,componentDatatype:r["a"].UNSIGNED_BYTE}],i=m["a"].createIndexBuffer({context:c,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:T["a"].STATIC_DRAW,indexDatatype:u["a"].UNSIGNED_SHORT});C.vertexArray=new y["a"]({context:c,attributes:o,indexBuffer:i}),C.shaderProgram=p["a"].fromCache({context:c,vertexShaderSource:M["a"],fragmentShaderSource:O["a"],attributeLocations:e}),C.renderState=b["a"].fromCache({blending:v["a"].ALPHA_BLEND}),C.uniformMap=this._uniformMap}const W=c.uniformState.sunPositionWC,F=c.uniformState.sunPositionColumbusView,P=this._boundingVolume,j=this._boundingVolume2D;s["a"].clone(W,P.center),j.center.x=F.z,j.center.y=F.x,j.center.z=F.y,P.radius=d["a"].SOLAR_RADIUS+d["a"].SOLAR_RADIUS*this._glowLengthTS,j.radius=P.radius,n===N["a"].SCENE3D?o["a"].clone(P,C.boundingVolume):n===N["a"].COLUMBUS_VIEW&&o["a"].clone(j,C.boundingVolume);const k=A["a"].computeActualWgs84Position(e,W,L),U=s["a"].magnitude(s["a"].subtract(k,e.camera.position,L)),D=c.uniformState.projection,B=H;B.x=0,B.y=0,B.z=-U,B.w=1;const V=l["a"].multiplyByVector(D,B,L),z=A["a"].clipToGLWindowCoordinates(t.viewport,V,I);B.x=d["a"].SOLAR_RADIUS;const G=l["a"].multiplyByVector(D,B,L),q=A["a"].clipToGLWindowCoordinates(t.viewport,G,R);return this._size=i["a"].magnitude(i["a"].subtract(q,z,L)),this._size=2*this._size*(1+2*this._glowLengthTS),this._size=Math.ceil(this._size),this._commands},C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){const e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),Object(c["a"])(this)},t["a"]=C},cdd6:function(e,t,a){"use strict";var o=a("77af"),i=a("670c"),s=a("a561"),n=a("2f63"),r=a("7d62"),h=a("93da"),c=a("52f0"),u=a("f806"),d=a("1627"),l=a("34e1"),f=a("ae18"),g=a("3720"),m=a("9249"),T=a("f724"),w=a("0d09"),x=a("18a0"),_=a("7fe1");function b(){this._sceneFramebuffer=new _["a"];const e=.125,t=new Array(6);t[0]=new m["a"]({fragmentShader:g["a"],textureScale:e,forcePowerOfTwo:!0,sampleMode:w["a"].LINEAR});const a=t[1]=new m["a"]({fragmentShader:l["a"],uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:e,forcePowerOfTwo:!0}),o=this;this._delta=1,this._sigma=2,this._blurStep=new i["a"],t[2]=new m["a"]({fragmentShader:f["a"],uniforms:{step:function(){return o._blurStep.x=o._blurStep.y=1/a.outputTexture.width,o._blurStep},delta:function(){return o._delta},sigma:function(){return o._sigma},direction:0},textureScale:e,forcePowerOfTwo:!0}),t[3]=new m["a"]({fragmentShader:f["a"],uniforms:{step:function(){return o._blurStep.x=o._blurStep.y=1/a.outputTexture.width,o._blurStep},delta:function(){return o._delta},sigma:function(){return o._sigma},direction:1},textureScale:e,forcePowerOfTwo:!0}),t[4]=new m["a"]({fragmentShader:g["a"],sampleMode:w["a"].LINEAR}),this._uCenter=new i["a"],this._uRadius=void 0,t[5]=new m["a"]({fragmentShader:d["a"],uniforms:{center:function(){return o._uCenter},radius:function(){return o._uRadius},colorTexture2:function(){return o._sceneFramebuffer.framebuffer.getColorTexture(0)}}}),this._stages=new T["a"]({stages:t});const s=new x["a"](this),n=t.length;for(let i=0;i<n;++i)t[i]._textureCache=s;this._textureCache=s,this.length=t.length}b.prototype.get=function(e){return this._stages.get(e)},b.prototype.getStageByName=function(e){const t=this._stages.length;for(let a=0;a<t;++a){const t=this._stages.get(a);if(t.name===e)return t}};const p=new s["a"],S=new i["a"],y=new i["a"],O=new c["a"];function E(e,t,a){const s=t.uniformState,n=s.sunPositionWC,r=s.view,d=s.viewProjection,l=s.projection;let f=c["a"].computeViewportTransformation(a,0,1,O);const g=c["a"].multiplyByPoint(r,n,p);let m=u["a"].pointToGLWindowCoordinates(d,f,n,S);g.x+=h["a"].SOLAR_RADIUS;const T=u["a"].pointToGLWindowCoordinates(l,f,g,g),w=30*i["a"].magnitude(i["a"].subtract(T,m,T))*2,x=y;x.x=w,x.y=w,e._uCenter=i["a"].clone(m,e._uCenter),e._uRadius=.15*Math.max(x.x,x.y);const _=t.drawingBufferWidth,b=t.drawingBufferHeight,E=e._stages,M=E.get(0),v=M.outputTexture.width,N=M.outputTexture.height,A=new o["a"];A.width=v,A.height=N,f=c["a"].computeViewportTransformation(A,0,1,O),m=u["a"].pointToGLWindowCoordinates(d,f,n,S),x.x*=v/_,x.y*=N/b;const C=M.scissorRectangle;C.x=Math.max(m.x-.5*x.x,0),C.y=Math.max(m.y-.5*x.y,0),C.width=Math.min(x.x,_),C.height=Math.min(x.y,b);for(let i=1;i<4;++i)o["a"].clone(C,E.get(i).scissorRectangle)}b.prototype.clear=function(e,t,a){this._sceneFramebuffer.clear(e,t,a),this._textureCache.clear(e)},b.prototype.update=function(e){const t=e.context,a=e.viewport,o=this._sceneFramebuffer;o.update(t,a);const i=o.framebuffer;return this._textureCache.update(t),this._stages.update(t,!1),E(this,t,a),i},b.prototype.execute=function(e){const t=this._sceneFramebuffer.framebuffer.getColorTexture(0),a=this._stages,o=a.length;a.get(0).execute(e,t);for(let i=1;i<o;++i)a.get(i).execute(e,a.get(i-1).outputTexture)},b.prototype.copy=function(e,t){if(!Object(n["a"])(this._copyColorCommand)){const t=this;this._copyColorCommand=e.createViewportQuadCommand(g["a"],{uniformMap:{colorTexture:function(){return t._stages.get(t._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),Object(r["a"])(this)},t["a"]=b},e065:function(e,t,a){"use strict";var o=a("bd8d"),i=a("535a");function s(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT),this.color=o["a"].clone(Object(i["a"])(e.color,o["a"].WHITE)),this.intensity=Object(i["a"])(e.intensity,2)}t["a"]=s}}]);