(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~e59a3b15"],{1307:function(e,t,n){"use strict";var i=n("52f0");function a(e,t,n){this.primitive=e,this._modelMatrix=i["a"].clone(t),this._instanceId=n}Object.defineProperties(a.prototype,{instanceId:{get:function(){return this._instanceId}},model:{get:function(){return this.primitive._model}},modelMatrix:{get:function(){return i["a"].clone(this._modelMatrix)},set:function(e){i["a"].clone(e,this._modelMatrix),this.primitive.expandBoundingSphere(this._modelMatrix),this.primitive._dirty=!0}}}),t["a"]=a},"1e38":function(e,t,n){"use strict";var i=n("cef5"),a=n("be18"),o=n("dc1c"),r=n("bd8d"),s=n("abab"),c=n("535a"),d=n("9c35"),m=n("2f63"),l=n("7d62"),u=n("8bd8"),h=n("52f0"),_=n("1b8d"),f=n("d4ed"),g=n("283e"),b=n("f806"),p=n("f20a"),w=n("8b68"),y=n("a894"),O=n("d289"),x=n("6dc0"),I=n("5770"),B=n("9937"),E=n("ce35"),S=n("1307"),L=n("e349"),M=n("a307"),T=n("c86b"),C=n("3de6");const v={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};function A(e){e=Object(c["a"])(e,c["a"].EMPTY_OBJECT),this.show=Object(c["a"])(e.show,!0),this._instancingSupported=!1,this._dynamic=Object(c["a"])(e.dynamic,!1),this._allowPicking=Object(c["a"])(e.allowPicking,!0),this._ready=!1,this._readyPromise=Object(d["a"])(),this._state=v.NEEDS_LOAD,this._dirty=!1,this._cull=Object(c["a"])(e.cull,!0),this._opaquePass=Object(c["a"])(e.opaquePass,O["a"].OPAQUE),this._instances=D(this,e.instances),this._batchTable=e.batchTable,this._model=void 0,this._vertexBufferTypedArray=void 0,this._vertexBuffer=void 0,this._batchIdBuffer=void 0,this._instancedUniformsByProgram=void 0,this._drawCommands=[],this._modelCommands=void 0,this._renderStates=void 0,this._disableCullingRenderStates=void 0,this._boundingSphere=V(this),this._center=a["a"].clone(this._boundingSphere.center),this._rtcTransform=new h["a"],this._rtcModelView=new h["a"],this._mode=void 0,this.modelMatrix=h["a"].clone(h["a"].IDENTITY),this._modelMatrix=h["a"].clone(this.modelMatrix),this._url=f["a"].createIfNeeded(e.url),this._requestType=e.requestType,this._gltf=e.gltf,this._basePath=f["a"].createIfNeeded(e.basePath),this._asynchronous=e.asynchronous,this._incrementallyLoadTextures=e.incrementallyLoadTextures,this._upAxis=e.upAxis,this._forwardAxis=e.forwardAxis,this.shadows=Object(c["a"])(e.shadows,T["a"].ENABLED),this._shadows=this.shadows,this._pickIdLoaded=e.pickIdLoaded,this.splitDirection=Object(c["a"])(e.splitDirection,C["a"].NONE),this.debugShowBoundingVolume=Object(c["a"])(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=Object(c["a"])(e.debugWireframe,!1),this._debugWireframe=!1,Object(m["a"])(e.imageBasedLighting)?(this._imageBasedLighting=e.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):(this._imageBasedLighting=new u["a"]({imageBasedLightingFactor:e.imageBasedLightingFactor,luminanceAtZenith:e.luminanceAtZenith,sphericalHarmonicCoefficients:e.sphericalHarmonicCoefficients,specularEnvironmentMaps:e.specularEnvironmentMaps}),this._shouldDestroyImageBasedLighting=!0),this.backFaceCulling=Object(c["a"])(e.backFaceCulling,!0),this._backFaceCulling=this.backFaceCulling,this.showCreditsOnScreen=Object(c["a"])(e.showCreditsOnScreen,!1)}function D(e,t){t=Object(c["a"])(t,[]);const n=t.length,i=new Array(n);for(let a=0;a<n;++a){const n=t[a],o=n.modelMatrix,r=Object(c["a"])(n.batchId,a);i[a]=new S["a"](e,o,r)}return i}function V(e){const t=e.length,n=new Array(t);for(let i=0;i<t;++i)n[i]=h["a"].getTranslation(e._instances[i]._modelMatrix,new a["a"]);return i["a"].fromPoints(n)}Object.defineProperties(A.prototype,{allowPicking:{get:function(){return this._allowPicking}},length:{get:function(){return this._instances.length}},activeAnimations:{get:function(){return this._model.activeAnimations}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1)}},imageBasedLightingFactor:{get:function(){return this._imageBasedLighting.imageBasedLightingFactor},set:function(e){this._imageBasedLighting.imageBasedLightingFactor=e}},luminanceAtZenith:{get:function(){return this._imageBasedLighting.luminanceAtZenith},set:function(e){this._imageBasedLighting.luminanceAtZenith=e}},sphericalHarmonicCoefficients:{get:function(){return this._imageBasedLighting.sphericalHarmonicCoefficients},set:function(e){this._imageBasedLighting.sphericalHarmonicCoefficients=e}},specularEnvironmentMaps:{get:function(){return this._imageBasedLighting.specularEnvironmentMaps},set:function(e){this._imageBasedLighting.specularEnvironmentMaps=e}}});const z=new a["a"],P=new h["a"];function R(e,t,n,i){return function(a,o){const r=a.semantic;if(Object(m["a"])(r)&&e.indexOf(r)>-1){if(!(t.indexOf(r)>-1))throw new g["a"](`Shader program cannot be optimized for instancing. Uniform "${o}" in program "${n}" uses unsupported semantic "${r}"`);i[o]=r}}}function k(e,t){if(Object(m["a"])(e._instancedUniformsByProgram))return e._instancedUniformsByProgram[t];const n={};e._instancedUniformsByProgram=n;const i=["MODEL","MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELINVERSE","MODELVIEWINVERSE","MODELVIEWPROJECTIONINVERSE","MODELINVERSETRANSPOSE","MODELVIEWINVERSETRANSPOSE"],a=["MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELVIEWINVERSETRANSPOSE"],o=e._model._sourceTechniques;for(const r in o)if(o.hasOwnProperty(r)){const e=o[r],s=e.program;if(!Object(m["a"])(n[s])){const o={};n[s]=o,B["a"].techniqueUniform(e,R(i,a,t,o))}}return n[t]}function j(e){return function(t,n){const i=k(e,n),a=Object(m["a"])(e._batchTable);let o=I["a"].replaceMain(t,"czm_instancing_main"),r="",s="";for(const e in i)if(i.hasOwnProperty(e)){const t=i[e];let n;"MODELVIEW"===t||"CESIUM_RTC_MODELVIEW"===t?n="czm_instanced_modelView":"MODELVIEWPROJECTION"===t?(n="czm_instanced_modelViewProjection",r+="mat4 czm_instanced_modelViewProjection;\n",s+="czm_instanced_modelViewProjection = czm_projection * czm_instanced_modelView;\n"):"MODELVIEWINVERSETRANSPOSE"===t&&(n="czm_instanced_modelViewInverseTranspose",r+="mat3 czm_instanced_modelViewInverseTranspose;\n",s+="czm_instanced_modelViewInverseTranspose = mat3(czm_instanced_modelView);\n");let a=new RegExp(`uniform.*${e}.*`);o=o.replace(a,""),a=new RegExp(e+"\\b","g"),o=o.replace(a,n)}const c="uniform mat4 czm_instanced_modifiedModelView;\nuniform mat4 czm_instanced_nodeTransform;\n";let d,l,u;a?(d="attribute float a_batchId;\n",l="",u=""):(d="",l="attribute vec4 pickColor;\nvarying vec4 v_pickColor;\n",u="    v_pickColor = pickColor;\n");let h=c+r+"mat4 czm_instanced_modelView;\nattribute vec4 czm_modelMatrixRow0;\nattribute vec4 czm_modelMatrixRow1;\n"+`attribute vec4 czm_modelMatrixRow2;\n${d}${l}${o}void main()\n{\n    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0, czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0);\n`+`    czm_instanced_modelView = czm_instanced_modifiedModelView * czm_instanced_model * czm_instanced_nodeTransform;\n${s}    czm_instancing_main();\n${u}}\n`;if(a){const t=e._model.gltf,i=L["a"].getDiffuseAttributeOrUniform(t,n);h=e._batchTable.getVertexShaderCallback(!0,"a_batchId",i)(h)}return h}}function N(e){return function(t,n){const i=e._batchTable;if(Object(m["a"])(i)){const a=e._model.gltf,o=L["a"].getDiffuseAttributeOrUniform(a,n);t=i.getFragmentShaderCallback(!0,o,!1)(t)}else t="varying vec4 v_pickColor;\n"+t;return t}}function W(e,t){return function(){return h["a"].multiply(t.uniformState.view,e._rtcTransform,e._rtcModelView)}}function F(e){return function(){return e.computedMatrix}}function U(e,t){return function(n,i,a){n=Object(o["a"])(n),n.czm_instanced_modifiedModelView=W(e,t),n.czm_instanced_nodeTransform=F(a);const r=k(e,i);for(const e in r)r.hasOwnProperty(e)&&delete n[e];return Object(m["a"])(e._batchTable)&&(n=e._batchTable.getUniformMapCallback()(n)),n}}function q(e){return function(t,n){if(Object(m["a"])(e._batchTable)){const i=e._model.gltf,a=L["a"].getDiffuseAttributeOrUniform(i,n);t=e._batchTable.getVertexShaderCallback(!0,"a_batchId",a)(t),t="uniform float a_batchId\n;"+t}return t}}function $(e){return function(t,n){const i=e._batchTable;if(Object(m["a"])(i)){const a=e._model.gltf,o=L["a"].getDiffuseAttributeOrUniform(a,n);t=i.getFragmentShaderCallback(!0,o,!1)(t)}else t="uniform vec4 czm_pickColor;\n"+t;return t}}function G(e){return function(t){return Object(m["a"])(e._batchTable)&&(t=e._batchTable.getUniformMapCallback()(t)),t}}function H(e){const t=e._instances,n=e.length,i=e._center,a=12;let o=e._vertexBufferTypedArray;Object(m["a"])(o)||(o=new Float32Array(n*a)),e._dynamic&&(e._vertexBufferTypedArray=o);for(let r=0;r<n;++r){const e=t[r]._modelMatrix,n=h["a"].clone(e,P);n[12]-=i.x,n[13]-=i.y,n[14]-=i.z;const s=r*a;o[s+0]=n[0],o[s+1]=n[4],o[s+2]=n[8],o[s+3]=n[12],o[s+4]=n[1],o[s+5]=n[5],o[s+6]=n[9],o[s+7]=n[13],o[s+8]=n[2],o[s+9]=n[6],o[s+10]=n[10],o[s+11]=n[14]}return o}function J(e,t){let n;const i=e._instances,a=e.length,o=e._dynamic,s=Object(m["a"])(e._batchTable);if(s){const o=new Uint16Array(a);for(n=0;n<a;++n)o[n]=i[n]._instanceId;e._batchIdBuffer=p["a"].createVertexBuffer({context:t,typedArray:o,usage:w["a"].STATIC_DRAW})}if(!s){const i=new Uint8Array(4*a);for(n=0;n<a;++n){const t=e._pickIds[n],a=t.color,o=4*n;i[o]=r["a"].floatToByte(a.red),i[o+1]=r["a"].floatToByte(a.green),i[o+2]=r["a"].floatToByte(a.blue),i[o+3]=r["a"].floatToByte(a.alpha)}e._pickIdBuffer=p["a"].createVertexBuffer({context:t,typedArray:i,usage:w["a"].STATIC_DRAW})}const c=H(e);e._vertexBuffer=p["a"].createVertexBuffer({context:t,typedArray:c,usage:o?w["a"].STREAM_DRAW:w["a"].STATIC_DRAW})}function Z(e){const t=H(e);e._vertexBuffer.copyFromArrayView(t)}function Y(e,t){const n=e._instances,i=n.length,a=new Array(i);for(let o=0;o<i;++o)a[o]=t.createPickId(n[o]);return a}function K(e,t){const n=e._instancingSupported,i=Object(m["a"])(e._batchTable),a=e._allowPicking,o={url:e._url,requestType:e._requestType,gltf:e._gltf,basePath:e._basePath,shadows:e._shadows,cacheKey:void 0,asynchronous:e._asynchronous,allowPicking:a,incrementallyLoadTextures:e._incrementallyLoadTextures,upAxis:e._upAxis,forwardAxis:e._forwardAxis,precreatedAttributes:void 0,vertexShaderLoaded:void 0,fragmentShaderLoaded:void 0,uniformMapLoaded:void 0,pickIdLoaded:e._pickIdLoaded,ignoreCommands:!0,opaquePass:e._opaquePass,imageBasedLighting:e._imageBasedLighting,showOutline:e.showOutline,showCreditsOnScreen:e.showCreditsOnScreen};if(i||(e._pickIds=Y(e,t)),n){J(e,t);const n=12,a=s["a"].getSizeInBytes(s["a"].FLOAT),r={czm_modelMatrixRow0:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:s["a"].FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:a*n,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:s["a"].FLOAT,normalize:!1,offsetInBytes:4*a,strideInBytes:a*n,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:s["a"].FLOAT,normalize:!1,offsetInBytes:8*a,strideInBytes:a*n,instanceDivisor:1}};i&&(r.a_batchId={index:0,vertexBuffer:e._batchIdBuffer,componentsPerAttribute:1,componentDatatype:s["a"].UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),i||(r.pickColor={index:0,vertexBuffer:e._pickIdBuffer,componentsPerAttribute:4,componentDatatype:s["a"].UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),o.precreatedAttributes=r,o.vertexShaderLoaded=j(e),o.fragmentShaderLoaded=N(e),o.uniformMapLoaded=U(e,t),Object(m["a"])(e._url)&&(o.cacheKey=e._url.getUrlComponent()+"#instanced")}else o.vertexShaderLoaded=q(e),o.fragmentShaderLoaded=$(e),o.uniformMapLoaded=G(e,t);Object(m["a"])(e._url)?e._model=E["a"].fromGltf(o):e._model=new E["a"](o)}function Q(e,t){if(e._debugWireframe!==e.debugWireframe||t){e._debugWireframe=e.debugWireframe;const t=e.debugWireframe?_["a"].LINES:_["a"].TRIANGLES,n=e._drawCommands,i=n.length;for(let e=0;e<i;++e)n[e].primitiveType=t}}function X(e){const t=Object(o["a"])(e,!0);return t.cull.enabled=!1,x["a"].fromCache(t)}function ee(e,t){if(e._backFaceCulling!==e.backFaceCulling||t){e._backFaceCulling=e.backFaceCulling;const t=e._drawCommands,n=t.length;let i;if(!Object(m["a"])(e._disableCullingRenderStates))for(e._disableCullingRenderStates=new Array(n),e._renderStates=new Array(n),i=0;i<n;++i){const n=t[i].renderState,a=X(n);e._disableCullingRenderStates[i]=a,e._renderStates[i]=n}for(i=0;i<n;++i)t[i].renderState=e._backFaceCulling?e._renderStates[i]:e._disableCullingRenderStates[i]}}function te(e,t){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume||t){e._debugShowBoundingVolume=e.debugShowBoundingVolume;const t=e._drawCommands,n=t.length;for(let i=0;i<n;++i)t[i].debugShowBoundingVolume=e.debugShowBoundingVolume}}function ne(e,t){const n=t.length,i=e.length,a=e._boundingSphere,o=e._cull;for(let r=0;r<n;++r){const n=y["a"].shallowClone(t[r]);n.instanceCount=i,n.boundingVolume=a,n.cull=o,Object(m["a"])(e._batchTable)?n.pickId=e._batchTable.getPickId():n.pickId="v_pickColor",e._drawCommands.push(n)}}function ie(e){return function(){return e}}function ae(e){return function(){return e}}function oe(e,t){const n=e._instances,a=t.length,r=e.length,s=e._batchTable,c=Object(m["a"])(s),d=e._cull;for(let m=0;m<a;++m)for(let a=0;a<r;++a){const r=y["a"].shallowClone(t[m]);if(r.modelMatrix=new h["a"],r.boundingVolume=new i["a"],r.cull=d,r.uniformMap=Object(o["a"])(r.uniformMap),c)r.uniformMap.a_batchId=ie(n[a]._instanceId);else{const t=e._pickIds[a];r.uniformMap.czm_pickColor=ae(t.color)}e._drawCommands.push(r)}}function re(e){const t=e._modelCommands,n=t.length,a=e.length,o=e._rtcTransform,r=e._center;for(let s=0;s<n;++s){const n=t[s];for(let t=0;t<a;++t){const c=s*a+t,d=e._drawCommands[c];let m=h["a"].clone(e._instances[t]._modelMatrix,P);m[12]-=r.x,m[13]-=r.y,m[14]-=r.z,m=h["a"].multiply(o,m,P);const l=n.modelMatrix,u=d.modelMatrix;h["a"].multiply(m,l,u);const _=n.boundingVolume,f=d.boundingVolume;i["a"].transform(_,m,f)}}}function se(e){const t=e._nodeCommands,n=t.length,i=[];for(let a=0;a<n;++a){const e=t[a];e.show&&i.push(e.command)}return i}function ce(e){const t=e._nodeCommands,n=t.length;let i=!1;for(let a=0;a<n;a++){const e=t[a];e.command.dirty&&(e.command.dirty=!1,i=!0)}return i}function de(e,t){e._drawCommands=[];const n=se(e._model);t?ne(e,n):(oe(e,n),re(e))}function me(e,t){if(e.shadows!==e._shadows||t){e._shadows=e.shadows;const t=T["a"].castShadows(e.shadows),n=T["a"].receiveShadows(e.shadows),i=e._drawCommands,a=i.length;for(let e=0;e<a;++e){const a=i[e];a.castShadows=t,a.receiveShadows=n}}}A.prototype.expandBoundingSphere=function(e){const t=h["a"].getTranslation(e,z);i["a"].expand(this._boundingSphere,t,this._boundingSphere)},A.prototype.update=function(e){if(e.mode===M["a"].MORPHING)return;if(!this.show)return;if(0===this.length)return;const t=e.context;if(this._state===v.NEEDS_LOAD){this._state=v.LOADING,this._instancingSupported=t.instancedArrays,K(this,t);const e=this;this._model.readyPromise.catch((function(t){e._state=v.FAILED,e._readyPromise.reject(t)}))}const n=this._instancingSupported,i=this._model;if(i.imageBasedLighting=this._imageBasedLighting,i.showCreditsOnScreen=this.showCreditsOnScreen,i.splitDirection=this.splitDirection,i.update(e),i.ready&&this._state===v.LOADING){this._state=v.LOADED,this._ready=!0;const e=i.boundingSphere.radius+a["a"].magnitude(i.boundingSphere.center);return this._boundingSphere.radius+=e,this._modelCommands=se(i),de(this,n),void this._readyPromise.resolve(this)}if(this._state!==v.LOADED)return;const o=e.mode!==this._mode,r=this.modelMatrix,s=!h["a"].equals(this._modelMatrix,r);if(o||s){this._mode=e.mode,h["a"].clone(r,this._modelMatrix);let t=h["a"].multiplyByTranslation(this._modelMatrix,this._center,this._rtcTransform);this._mode!==M["a"].SCENE3D&&(t=b["a"].basisTo2D(e.mapProjection,t,t)),h["a"].getTranslation(t,this._boundingSphere.center)}n&&this._dirty&&(this._dynamic=!0,this._dirty=!1,Z(this));const c=ce(i);c&&de(this,n),!n&&(i.dirty||this._dirty||o||s)&&re(this),me(this,c),Q(this,c),ee(this,c),te(this,c);const d=e.passes;if(!d.render&&!d.pick)return;const m=e.commandList,l=this._drawCommands,u=l.length;for(let a=0;a<u;++a)m.push(l[a])},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){this._model=this._model&&this._model.destroy();const e=this._pickIds;if(Object(m["a"])(e)){const t=e.length;for(let n=0;n<t;++n)e[n].destroy()}return this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,Object(l["a"])(this)},t["a"]=A}}]);