(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~0f3ba690"],{"054e":function(e,t,i){"use strict";var n=i("1d87"),o=i("be18"),a=i("bd8d"),s=i("535a"),r=i("9c35"),c=i("2f63"),d=i("7d62"),l=i("c52f"),h=i("0123"),u=i("78e5"),_=i("eace"),f=i("6a29"),p=i("5a6c"),b=i("d8f6"),m=i("27aa");function g(e){this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._counts=e.counts,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._batchedPositions=void 0,this._transferrableBatchIds=void 0,this._vertexBatchIds=void 0,this._ellipsoid=Object(s["a"])(e.ellipsoid,l["a"].WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._polygonMinimumHeights=e.polygonMinimumHeights,this._polygonMaximumHeights=e.polygonMaximumHeights,this._center=Object(s["a"])(e.center,o["a"].ZERO),this._rectangle=e.rectangle,this._center=void 0,this._boundingVolume=e.boundingVolume,this._boundingVolumes=void 0,this._batchedIndices=void 0,this._ready=!1,this._readyPromise=Object(r["a"])(),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=p["a"].BOTH}function y(e){const t=new Float64Array(3+o["a"].packedLength+l["a"].packedLength+_["a"].packedLength);let i=0;return t[i++]=e._indices.BYTES_PER_ELEMENT,t[i++]=e._minimumHeight,t[i++]=e._maximumHeight,o["a"].pack(e._center,t,i),i+=o["a"].packedLength,l["a"].pack(e._ellipsoid,t,i),i+=l["a"].packedLength,_["a"].pack(e._rectangle,t,i),t}function O(e,t){let i=1;const n=t[i++],o=e._boundingVolumes=new Array(n);for(let a=0;a<n;++a)o[a]=u["a"].unpack(t,i),i+=u["a"].packedLength;const s=t[i++],r=e._batchedIndices=new Array(s);for(let c=0;c<s;++c){const e=a["a"].unpack(t,i);i+=a["a"].packedLength;const n=t[i++],o=t[i++],s=t[i++],d=new Array(s);for(let a=0;a<s;++a)d[a]=t[i++];r[c]=new b["a"]({color:e,offset:n,count:o,batchIds:d})}}Object.defineProperties(g.prototype,{trianglesLength:{get:function(){return Object(c["a"])(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return Object(c["a"])(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise.promise}}});const v=new f["a"]("createVectorTilePolygons",5),I=new a["a"];function T(e){if(!Object(c["a"])(e._primitive)){if(!Object(c["a"])(e._verticesPromise)){let t=e._positions,i=e._counts,o=e._indexCounts,a=e._indices,s=e._transferrableBatchIds,r=e._batchTableColors,d=e._packedBuffer;if(!Object(c["a"])(r)){t=e._positions=Object(n["a"])(e._positions),i=e._counts=Object(n["a"])(e._counts),o=e._indexCounts=Object(n["a"])(e._indexCounts),a=e._indices=Object(n["a"])(e._indices),e._center=e._ellipsoid.cartographicToCartesian(_["a"].center(e._rectangle)),s=e._transferrableBatchIds=new Uint32Array(e._batchIds),r=e._batchTableColors=new Uint32Array(s.length);const c=e._batchTable,l=r.length;for(let e=0;e<l;++e){const t=c.getColor(e,I);r[e]=t.toRgba()}d=e._packedBuffer=y(e)}const l=[t.buffer,i.buffer,o.buffer,a.buffer,s.buffer,r.buffer,d.buffer],u={packedBuffer:d.buffer,positions:t.buffer,counts:i.buffer,indexCounts:o.buffer,indices:a.buffer,batchIds:s.buffer,batchTableColors:r.buffer};let f=e._polygonMinimumHeights,p=e._polygonMaximumHeights;Object(c["a"])(f)&&Object(c["a"])(p)&&(f=Object(n["a"])(f),p=Object(n["a"])(p),l.push(f.buffer,p.buffer),u.minimumHeights=f,u.maximumHeights=p);const b=e._verticesPromise=v.scheduleTask(u,l);if(!Object(c["a"])(b))return;b.then((function(t){e._positions=void 0,e._counts=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0;const i=new Float64Array(t.packedBuffer),n=i[0];O(e,i),e._indices=2===h["a"].getSizeInBytes(n)?new Uint16Array(t.indices):new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._batchedPositions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.batchIds),e._ready=!0}))}e._ready&&!Object(c["a"])(e._primitive)&&(e._primitive=new m["a"]({batchTable:e._batchTable,positions:e._batchedPositions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center}),e._batchTable=void 0,e._batchIds=void 0,e._positions=void 0,e._counts=void 0,e._indices=void 0,e._indexCounts=void 0,e._indexOffsets=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0,e._center=void 0,e._rectangle=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0,e._verticesPromise=void 0,e._readyPromise.resolve())}}g.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},g.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},g.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},g.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},g.prototype.update=function(e){T(this),this._ready&&(this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e))},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),Object(d["a"])(this)},t["a"]=g},"05e5":function(e,t,i){"use strict";const n={CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1};t["a"]=Object.freeze(n)},"27aa":function(e,t,i){"use strict";var n=i("be18"),o=i("bd8d"),a=i("abab"),s=i("535a"),r=i("2f63"),c=i("7d62"),d=i("0123"),l=i("52f0"),h=i("1b8d"),u=i("f20a"),_=i("8b68"),f=i("a894"),p=i("d289"),b=i("6dc0"),m=i("e90c"),g=i("5770"),y=i("7c5e"),O=i("ae16"),v=i("8fa0"),I=i("b7c8"),T=i("5af0"),C=i("5a6c"),S=i("06f0"),x=i("6928"),P=i("3626"),A=i("6102"),w=i("25ef"),j=i("d8f6");function E(e){e=Object(s["a"])(e,s["a"].EMPTY_OBJECT),this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._vertexBatchIds=e.vertexBatchIds,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=e.indexOffsets,this._batchedIndices=e.batchedIndices,this._boundingVolume=e.boundingVolume,this._boundingVolumes=e.boundingVolumes,this._center=Object(s["a"])(e.center,n["a"].ZERO),this._va=void 0,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._uniformMap=void 0,this._vaSwap=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._rsWireframe=void 0,this._commands=[],this._commandsIgnoreShow=[],this._pickCommands=[],this._constantColor=o["a"].clone(o["a"].WHITE),this._highlightColor=this._constantColor,this._batchDirty=!0,this._pickCommandsDirty=!0,this._framesSinceLastRebatch=0,this._updatingAllCommands=!1,this._trianglesLength=this._indices.length/3,this._geometryByteLength=this._indices.byteLength+this._positions.byteLength+this._vertexBatchIds.byteLength,this.debugWireframe=!1,this._debugWireframe=this.debugWireframe,this._wireframeDirty=!1,this.forceRebatch=!1,this.classificationType=Object(s["a"])(e.classificationType,C["a"].BOTH),this._vertexShaderSource=e._vertexShaderSource,this._fragmentShaderSource=e._fragmentShaderSource,this._attributeLocations=e._attributeLocations,this._uniformMap=e._uniformMap,this._pickId=e._pickId,this._modelMatrix=e._modelMatrix,this._boundingSphere=e._boundingSphere,this._batchIdLookUp={};const t=this._batchIds.length;for(let i=0;i<t;++i){const e=this._batchIds[i];this._batchIdLookUp[e]=i}}Object.defineProperties(E.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}}});const L={position:0,a_batchId:1};function D(e,t){if(Object(r["a"])(e._va))return;const i=u["a"].createVertexBuffer({context:t,typedArray:e._positions,usage:_["a"].STATIC_DRAW}),n=u["a"].createVertexBuffer({context:t,typedArray:e._vertexBatchIds,usage:_["a"].STATIC_DRAW}),o=u["a"].createIndexBuffer({context:t,typedArray:e._indices,usage:_["a"].DYNAMIC_DRAW,indexDatatype:2===e._indices.BYTES_PER_ELEMENT?d["a"].UNSIGNED_SHORT:d["a"].UNSIGNED_INT}),s=[{index:0,vertexBuffer:i,componentDatatype:a["a"].fromTypedArray(e._positions),componentsPerAttribute:3},{index:1,vertexBuffer:n,componentDatatype:a["a"].fromTypedArray(e._vertexBatchIds),componentsPerAttribute:1}];e._va=new y["a"]({context:t,attributes:s,indexBuffer:o}),t.webgl2&&(e._vaSwap=new y["a"]({context:t,attributes:s,indexBuffer:u["a"].createIndexBuffer({context:t,sizeInBytes:o.sizeInBytes,usage:_["a"].DYNAMIC_DRAW,indexDatatype:o.indexDatatype})})),e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._verticesPromise=void 0}function N(e,t){if(Object(r["a"])(e._sp))return;const i=e._batchTable,n=Object(s["a"])(e._attributeLocations,L);let o=e._pickId;const a=e._vertexShaderSource;let c=e._fragmentShaderSource;if(Object(r["a"])(a))return e._sp=m["a"].fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:c,attributeLocations:n}),e._spStencil=e._sp,c=g["a"].replaceMain(c,"czm_non_pick_main"),c=c+"void main() \n{ \n    czm_non_pick_main(); \n"+`    gl_FragColor = ${o}; \n} \n`,void(e._spPick=m["a"].fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:c,attributeLocations:n}));const d=i.getVertexShaderCallback(!1,"a_batchId",void 0)(v["a"]);let l=i.getFragmentShaderCallback(!1,void 0,!0)(O["a"]);o=i.getPickId();let h=new g["a"]({sources:[d]}),u=new g["a"]({defines:["VECTOR_TILE"],sources:[l]});e._sp=m["a"].fromCache({context:t,vertexShaderSource:h,fragmentShaderSource:u,attributeLocations:n}),h=new g["a"]({sources:[v["a"]]}),u=new g["a"]({defines:["VECTOR_TILE"],sources:[O["a"]]}),e._spStencil=m["a"].fromCache({context:t,vertexShaderSource:h,fragmentShaderSource:u,attributeLocations:n}),l=g["a"].replaceMain(l,"czm_non_pick_main"),l=l+"\nvoid main() \n{ \n    czm_non_pick_main(); \n"+`    gl_FragColor = ${o}; \n} \n`;const _=new g["a"]({sources:[d]}),f=new g["a"]({defines:["VECTOR_TILE"],sources:[l]});e._spPick=m["a"].fromCache({context:t,vertexShaderSource:_,fragmentShaderSource:f,attributeLocations:n})}function B(e){const t=e?A["a"].EQUAL:A["a"].ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:t,frontOperation:{fail:w["a"].KEEP,zFail:w["a"].DECREMENT_WRAP,zPass:w["a"].KEEP},backFunction:t,backOperation:{fail:w["a"].KEEP,zFail:w["a"].INCREMENT_WRAP,zPass:w["a"].KEEP},reference:P["a"].CESIUM_3D_TILE_MASK,mask:P["a"].CESIUM_3D_TILE_MASK},stencilMask:P["a"].CLASSIFICATION_MASK,depthTest:{enabled:!0,func:S["a"].LESS_OR_EQUAL},depthMask:!1}}const k={stencilTest:{enabled:!0,frontFunction:A["a"].NOT_EQUAL,frontOperation:{fail:w["a"].ZERO,zFail:w["a"].ZERO,zPass:w["a"].ZERO},backFunction:A["a"].NOT_EQUAL,backOperation:{fail:w["a"].ZERO,zFail:w["a"].ZERO,zPass:w["a"].ZERO},reference:0,mask:P["a"].CLASSIFICATION_MASK},stencilMask:P["a"].CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:I["a"].PRE_MULTIPLIED_ALPHA_BLEND},F={stencilTest:{enabled:!0,frontFunction:A["a"].NOT_EQUAL,frontOperation:{fail:w["a"].ZERO,zFail:w["a"].ZERO,zPass:w["a"].ZERO},backFunction:A["a"].NOT_EQUAL,backOperation:{fail:w["a"].ZERO,zFail:w["a"].ZERO,zPass:w["a"].ZERO},reference:0,mask:P["a"].CLASSIFICATION_MASK},stencilMask:P["a"].CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function R(e){Object(r["a"])(e._rsStencilDepthPass)||(e._rsStencilDepthPass=b["a"].fromCache(B(!1)),e._rsStencilDepthPass3DTiles=b["a"].fromCache(B(!0)),e._rsColorPass=b["a"].fromCache(k),e._rsPickPass=b["a"].fromCache(F))}const H=new l["a"],M=new n["a"];function U(e,t){if(Object(r["a"])(e._uniformMap))return;const i={u_modifiedModelViewProjection:function(){const i=t.uniformState.view,n=t.uniformState.projection;return l["a"].clone(i,H),l["a"].multiplyByPoint(H,e._center,M),l["a"].setTranslation(H,M,H),l["a"].multiply(n,H,H),H},u_highlightColor:function(){return e._highlightColor}};e._uniformMap=e._batchTable.getUniformMapCallback()(i)}function V(e,t,i,n,o,a,s){const r=e.constructor.BYTES_PER_ELEMENT,c=a.length;for(let d=0;d<c;++d){const c=a[d],l=s[c],h=n[l],u=o[l],_=new e.constructor(e.buffer,r*h,u);t.set(_,i),n[l]=i,i+=u}return i}function W(e,t){const i=e._indices,n=e._indexOffsets,a=e._indexCounts,s=e._batchIdLookUp,r=new i.constructor(i.length);let c=t.pop();const d=[c];let l=V(i,r,0,n,a,c.batchIds,s);c.offset=0,c.count=l;while(t.length>0){const e=t.pop();if(o["a"].equals(e.color,c.color))l=V(i,r,l,n,a,e.batchIds,s),c.batchIds=c.batchIds.concat(e.batchIds),c.count=l-c.offset;else{const t=l;l=V(i,r,l,n,a,e.batchIds,s),e.offset=t,e.count=l-t,d.push(e),c=e}}e._va.indexBuffer.copyFromArrayView(r),e._indices=r,e._batchedIndices=d}function G(e,t,i,n,o,a,s){const r=e.bytesPerIndex,c=a.length;for(let d=0;d<c;++d){const c=a[d],l=s[c],h=n[l],u=o[l];t.copyFromBuffer(e,h*r,i*r,u*r),n[l]=i,i+=u}return i}function z(e,t){const i=e._indexOffsets,n=e._indexCounts,a=e._batchIdLookUp;let s=t.pop();const r=[s],c=e._va.indexBuffer,d=e._vaSwap.indexBuffer;let l=G(c,d,0,i,n,s.batchIds,a);s.offset=0,s.count=l;while(t.length>0){const e=t.pop();if(o["a"].equals(e.color,s.color))l=G(c,d,l,i,n,e.batchIds,a),s.batchIds=s.batchIds.concat(e.batchIds),s.count=l-s.offset;else{const t=l;l=G(c,d,l,i,n,e.batchIds,a),e.offset=t,e.count=l-t,r.push(e),s=e}}const h=e._va;e._va=e._vaSwap,e._vaSwap=h,e._batchedIndices=r}function Y(e,t){return t.color.toRgba()-e.color.toRgba()}function Z(e,t){if(!e._batchDirty)return!1;const i=e._batchedIndices,n=i.length;let o=!1;const a={};for(let s=0;s<n;++s){const e=i[s].color,t=e.toRgba();if(Object(r["a"])(a[t])){o=!0;break}a[t]=!0}return o?o&&!e.forceRebatch&&e._framesSinceLastRebatch<120?void++e._framesSinceLastRebatch:(i.sort(Y),t.webgl2?z(e,i):W(e,i),e._framesSinceLastRebatch=0,e._batchDirty=!1,e._pickCommandsDirty=!0,e._wireframeDirty=!0,!0):(e._batchDirty=!1,!1)}function K(e,t){const i=Z(e,t),n=e._commands,o=e._batchedIndices,a=o.length,c=2*a;if(Object(r["a"])(n)&&!i&&n.length===c)return;n.length=c;const d=e._va,h=e._sp,u=Object(s["a"])(e._modelMatrix,l["a"].IDENTITY),_=e._uniformMap,b=e._boundingVolume;for(let s=0;s<a;++s){const t=o[s].offset,i=o[s].count;let a=n[2*s];Object(r["a"])(a)||(a=n[2*s]=new f["a"]({owner:e})),a.vertexArray=d,a.modelMatrix=u,a.offset=t,a.count=i,a.renderState=e._rsStencilDepthPass,a.shaderProgram=h,a.uniformMap=_,a.boundingVolume=b,a.cull=!1,a.pass=p["a"].TERRAIN_CLASSIFICATION;const c=f["a"].shallowClone(a,a.derivedCommands.tileset);c.renderState=e._rsStencilDepthPass3DTiles,c.pass=p["a"].CESIUM_3D_TILE_CLASSIFICATION,a.derivedCommands.tileset=c;let l=n[2*s+1];Object(r["a"])(l)||(l=n[2*s+1]=new f["a"]({owner:e})),l.vertexArray=d,l.modelMatrix=u,l.offset=t,l.count=i,l.renderState=e._rsColorPass,l.shaderProgram=h,l.uniformMap=_,l.boundingVolume=b,l.cull=!1,l.pass=p["a"].TERRAIN_CLASSIFICATION;const m=f["a"].shallowClone(l,l.derivedCommands.tileset);m.pass=p["a"].CESIUM_3D_TILE_CLASSIFICATION,l.derivedCommands.tileset=m}e._commandsDirty=!0}function X(e,t){if(e.classificationType===C["a"].TERRAIN||!t.invertClassification||Object(r["a"])(e._commandsIgnoreShow)&&!e._commandsDirty)return;const i=e._commands,n=e._commandsIgnoreShow,o=e._spStencil,a=i.length,s=n.length=a/2;let c=0;for(let r=0;r<s;++r){const e=n[r]=f["a"].shallowClone(i[c],n[r]);e.shaderProgram=o,e.pass=p["a"].CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,c+=2}e._commandsDirty=!1}function J(e){if(!e._pickCommandsDirty)return;const t=e._indexOffsets.length,i=e._pickCommands;i.length=2*t;const n=e._va,o=e._spStencil,a=e._spPick,c=Object(s["a"])(e._modelMatrix,l["a"].IDENTITY),d=e._uniformMap;for(let s=0;s<t;++s){const t=e._indexOffsets[s],l=e._indexCounts[s],h=Object(r["a"])(e._boundingVolumes)?e._boundingVolumes[s]:e.boundingVolume;let u=i[2*s];Object(r["a"])(u)||(u=i[2*s]=new f["a"]({owner:e,pickOnly:!0})),u.vertexArray=n,u.modelMatrix=c,u.offset=t,u.count=l,u.renderState=e._rsStencilDepthPass,u.shaderProgram=o,u.uniformMap=d,u.boundingVolume=h,u.pass=p["a"].TERRAIN_CLASSIFICATION;const _=f["a"].shallowClone(u,u.derivedCommands.tileset);_.renderState=e._rsStencilDepthPass3DTiles,_.pass=p["a"].CESIUM_3D_TILE_CLASSIFICATION,u.derivedCommands.tileset=_;let b=i[2*s+1];Object(r["a"])(b)||(b=i[2*s+1]=new f["a"]({owner:e,pickOnly:!0})),b.vertexArray=n,b.modelMatrix=c,b.offset=t,b.count=l,b.renderState=e._rsPickPass,b.shaderProgram=a,b.uniformMap=d,b.boundingVolume=h,b.pass=p["a"].TERRAIN_CLASSIFICATION;const m=f["a"].shallowClone(b,b.derivedCommands.tileset);m.pass=p["a"].CESIUM_3D_TILE_CLASSIFICATION,b.derivedCommands.tileset=m}e._pickCommandsDirty=!1}function q(e,t){e._updatingAllCommands=!0;const i=e._batchIds;let n,a=i.length;for(n=0;n<a;++n){const e=i[n],a=t[e];a.show=!0,a.color=o["a"].WHITE}const s=e._batchedIndices;for(a=s.length,n=0;n<a;++n)s[n].color=o["a"].clone(o["a"].WHITE);e._updatingAllCommands=!1,e._batchDirty=!0}E.prototype.createFeatures=function(e,t){const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=i[o];t[n]=new T["a"](e,n)}},E.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};const Q=new o["a"],$=o["a"].WHITE,ee=!0,te=/\$/;function ie(e,t,i,n){const o=e.classificationType,a=o!==C["a"].CESIUM_3D_TILE,s=o!==C["a"].TERRAIN,c=t.commandList;let d,l,h=i.length;for(l=0;l<h;++l)a&&(d=i[l],d.pass=p["a"].TERRAIN_CLASSIFICATION,c.push(d)),s&&(d=i[l].derivedCommands.tileset,d.pass=p["a"].CESIUM_3D_TILE_CLASSIFICATION,c.push(d));if(t.invertClassification&&Object(r["a"])(n))for(h=n.length,l=0;l<h;++l)c.push(n[l])}function ne(e,t){const i=e.commandList,n=t.length;for(let o=0;o<n;o+=2){const e=t[o+1];e.pass=p["a"].OPAQUE,i.push(e)}}function oe(e){let t,i,n=e.debugWireframe===e._debugWireframe;if(n=n&&!(e.debugWireframe&&e._wireframeDirty),n)return;Object(r["a"])(e._rsWireframe)||(e._rsWireframe=b["a"].fromCache({})),e.debugWireframe?(t=e._rsWireframe,i=h["a"].LINES):(t=e._rsColorPass,i=h["a"].TRIANGLES);const o=e._commands,a=o.length;for(let s=0;s<a;s+=2){const e=o[s+1];e.renderState=t,e.primitiveType=i}e._debugWireframe=e.debugWireframe,e._wireframeDirty=!1}E.prototype.applyStyle=function(e,t){if(!Object(r["a"])(e))return void q(this,t);const i=e.color,n=i instanceof x["a"]&&!te.test(i.expression);this._updatingAllCommands=n;const a=this._batchIds;let s,c=a.length;for(s=0;s<c;++s){const i=a[s],n=t[i];n.color=Object(r["a"])(e.color)?e.color.evaluateColor(n,Q):$,n.show=Object(r["a"])(e.show)?e.show.evaluate(n):ee}if(n){const e=this._batchedIndices;for(c=e.length,s=0;s<c;++s)e[s].color=o["a"].clone(o["a"].WHITE);this._updatingAllCommands=!1,this._batchDirty=!0}},E.prototype.updateCommands=function(e,t){if(this._updatingAllCommands)return;const i=this._batchIdLookUp,n=i[e];if(!Object(r["a"])(n))return;const a=this._indexOffsets,s=this._indexCounts,c=a[n],d=s[n],l=this._batchedIndices,h=l.length;let u;for(u=0;u<h;++u){const e=l[u].offset,t=l[u].count;if(c>=e&&c<e+t)break}l.push(new j["a"]({color:o["a"].clone(t),offset:c,count:d,batchIds:[e]}));const _=[],f=[],p=l[u].batchIds,b=p.length;for(let o=0;o<b;++o){const t=p[o];if(t===e)continue;const n=i[t];a[n]<c?_.push(t):f.push(t)}0!==f.length&&l.push(new j["a"]({color:o["a"].clone(l[u].color),offset:c+d,count:l[u].offset+l[u].count-(c+d),batchIds:f})),0!==_.length?(l[u].count=c-l[u].offset,l[u].batchIds=_):l.splice(u,1),this._batchDirty=!0},E.prototype.update=function(e){const t=e.context;D(this,t),N(this,t),R(this),U(this,t);const i=e.passes;i.render&&(K(this,t),X(this,e),oe(this),this._debugWireframe?ne(e,this._commands):ie(this,e,this._commands,this._commandsIgnoreShow)),i.pick&&(J(this),ie(this,e,this._pickCommands))},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaSwap=this._vaSwap&&this._vaSwap.destroy(),Object(c["a"])(this)},t["a"]=E},"364c":function(e,t,i){"use strict";var n=i("be18"),o=i("535a"),a=i("9c35"),s=i("2f63"),r=i("7d62"),c=i("c52f"),d=i("e856"),l=i("abab"),h=i("93da"),u=i("52f0"),_=i("eace"),f=i("283e"),p=i("6596"),b=i("9889"),m=i("db4b"),g=i("054e"),y=i("a230"),O=i("b61c"),v=i("713c");function I(e,t,i,n,o){this._tileset=e,this._tile=t,this._resource=i,this._polygons=void 0,this._polylines=void 0,this._points=void 0,this._contentReadyPromise=void 0,this._readyPromise=Object(a["a"])(),this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,A(this,n,o)}function T(e){return function(t,i){Object(s["a"])(e._polygons)&&e._polygons.updateCommands(t,i)}}function C(e,t){let i,n,a,r;const c=Object(o["a"])(e.POLYGONS_LENGTH,0),d=Object(o["a"])(e.POLYLINES_LENGTH,0),l=Object(o["a"])(e.POINTS_LENGTH,0);if(c>0&&Object(s["a"])(e.POLYGON_BATCH_IDS)){const n=t.byteOffset+e.POLYGON_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,n,c)}if(d>0&&Object(s["a"])(e.POLYLINE_BATCH_IDS)){const i=t.byteOffset+e.POLYLINE_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,i,d)}if(l>0&&Object(s["a"])(e.POINT_BATCH_IDS)){const i=t.byteOffset+e.POINT_BATCH_IDS.byteOffset;a=new Uint16Array(t.buffer,i,l)}const h=Object(s["a"])(i)||Object(s["a"])(n)||Object(s["a"])(a),u=c>0&&!Object(s["a"])(i)||d>0&&!Object(s["a"])(n)||l>0&&!Object(s["a"])(a);if(h&&u)throw new f["a"]("If one group of batch ids is defined, then all batch ids must be defined.");const _=!Object(s["a"])(i)&&!Object(s["a"])(n)&&!Object(s["a"])(a);if(_){let e=0;if(!Object(s["a"])(i)&&c>0)for(i=new Uint16Array(c),r=0;r<c;++r)i[r]=e++;if(!Object(s["a"])(n)&&d>0)for(n=new Uint16Array(d),r=0;r<d;++r)n[r]=e++;if(!Object(s["a"])(a)&&l>0)for(a=new Uint16Array(l),r=0;r<l;++r)a[r]=e++}return{polygons:i,polylines:n,points:a}}Object.defineProperties(I.prototype,{featuresLength:{get:function(){return Object(s["a"])(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return Object(s["a"])(this._points)?this._points.pointsLength:0}},trianglesLength:{get:function(){let e=0;return Object(s["a"])(this._polygons)&&(e+=this._polygons.trianglesLength),Object(s["a"])(this._polylines)&&(e+=this._polylines.trianglesLength),e}},geometryByteLength:{get:function(){let e=0;return Object(s["a"])(this._polygons)&&(e+=this._polygons.geometryByteLength),Object(s["a"])(this._polylines)&&(e+=this._polylines.geometryByteLength),e}},texturesByteLength:{get:function(){return Object(s["a"])(this._points)?this._points.texturesByteLength:0}},batchTableByteLength:{get:function(){return Object(s["a"])(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(e){this._group=e}}});const S=Uint32Array.BYTES_PER_ELEMENT;function x(e){return new y["a"](e)}function P(e){return new O["a"](e)}function A(e,t,i){i=Object(o["a"])(i,0);const a=new Uint8Array(t),r=new DataView(t);i+=S;const y=r.getUint32(i,!0);if(1!==y)throw new f["a"](`Only Vector tile version 1 is supported.  Version ${y} is not.`);i+=S;const O=r.getUint32(i,!0);if(i+=S,0===O)return void e._readyPromise.resolve(e);const I=r.getUint32(i,!0);if(i+=S,0===I)throw new f["a"]("Feature table must have a byte length greater than zero");const A=r.getUint32(i,!0);i+=S;const w=r.getUint32(i,!0);i+=S;const E=r.getUint32(i,!0);i+=S;const L=r.getUint32(i,!0);i+=S;const D=r.getUint32(i,!0);i+=S;const N=r.getUint32(i,!0);i+=S;const B=r.getUint32(i,!0);i+=S;const k=Object(d["a"])(a,i,I);i+=I;const F=new Uint8Array(t,i,A);let R,H;i+=A,w>0&&(R=Object(d["a"])(a,i,w),i+=w,E>0&&(H=new Uint8Array(t,i,E),H=new Uint8Array(H),i+=E));const M=Object(o["a"])(k.POLYGONS_LENGTH,0),U=Object(o["a"])(k.POLYLINES_LENGTH,0),V=Object(o["a"])(k.POINTS_LENGTH,0),W=M+U+V,G=new p["a"](e,W,R,H,T(e));if(e._batchTable=G,0===W)return;const z=new b["a"](k,F),Y=z.getGlobalProperty("REGION");if(!Object(s["a"])(Y))throw new f["a"]("Feature table global property: REGION must be defined");const Z=_["a"].unpack(Y),K=Y[4],X=Y[5],J=e._tile.computedTransform;let q=z.getGlobalProperty("RTC_CENTER",l["a"].FLOAT,3);Object(s["a"])(q)?(q=n["a"].unpack(q),u["a"].multiplyByPoint(J,q,q)):(q=_["a"].center(Z),q.height=h["a"].lerp(K,X,.5),q=c["a"].WGS84.cartographicToCartesian(q));const Q=C(k,F);if(i+=(4-i%4)%4,M>0){z.featuresLength=M;const n=Object(o["a"])(z.getPropertyArray("POLYGON_COUNTS",l["a"].UNSIGNED_INT,1),z.getPropertyArray("POLYGON_COUNT",l["a"].UNSIGNED_INT,1));if(!Object(s["a"])(n))throw new f["a"]("Feature table property: POLYGON_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");const a=Object(o["a"])(z.getPropertyArray("POLYGON_INDEX_COUNTS",l["a"].UNSIGNED_INT,1),z.getPropertyArray("POLYGON_INDEX_COUNT",l["a"].UNSIGNED_INT,1));if(!Object(s["a"])(a))throw new f["a"]("Feature table property: POLYGON_INDEX_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");const r=n.reduce((function(e,t){return e+2*t}),0),c=a.reduce((function(e,t){return e+t}),0),d=new Uint32Array(t,i,c);i+=L;const h=new Uint16Array(t,i,r);let u,_;i+=D,Object(s["a"])(k.POLYGON_MINIMUM_HEIGHTS)&&Object(s["a"])(k.POLYGON_MAXIMUM_HEIGHTS)&&(u=z.getPropertyArray("POLYGON_MINIMUM_HEIGHTS",l["a"].FLOAT,1),_=z.getPropertyArray("POLYGON_MAXIMUM_HEIGHTS",l["a"].FLOAT,1)),e._polygons=new g["a"]({positions:h,counts:n,indexCounts:a,indices:d,minimumHeight:K,maximumHeight:X,polygonMinimumHeights:u,polygonMaximumHeights:_,center:q,rectangle:Z,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:G,batchIds:Q.polygons,modelMatrix:J})}if(U>0){z.featuresLength=U;const n=Object(o["a"])(z.getPropertyArray("POLYLINE_COUNTS",l["a"].UNSIGNED_INT,1),z.getPropertyArray("POLYLINE_COUNT",l["a"].UNSIGNED_INT,1));if(!Object(s["a"])(n))throw new f["a"]("Feature table property: POLYLINE_COUNTS must be defined when POLYLINES_LENGTH is greater than 0");let a=z.getPropertyArray("POLYLINE_WIDTHS",l["a"].UNSIGNED_SHORT,1);if(!Object(s["a"])(a)){a=new Uint16Array(U);for(let e=0;e<U;++e)a[e]=2}const r=n.reduce((function(e,t){return e+3*t}),0),d=new Uint16Array(t,i,r);i+=N;const h=e._tileset,u=h.examineVectorLinesFunction;if(Object(s["a"])(u)){const t=Object(v["a"])(new Uint16Array(d),Z,K,X,c["a"].WGS84);j(t,n,Q.polylines,G,e.url,u)}let _=x;Object(s["a"])(h.classificationType)&&(_=P),e._polylines=_({positions:d,widths:a,counts:n,batchIds:Q.polylines,minimumHeight:K,maximumHeight:X,center:q,rectangle:Z,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:G,classificationType:h.classificationType,keepDecodedPositions:h.vectorKeepDecodedPositions})}if(V>0){const n=new Uint16Array(t,i,3*V);i+=B,e._points=new m["a"]({positions:n,batchIds:Q.points,minimumHeight:K,maximumHeight:X,rectangle:Z,batchTable:G})}}function w(e){const t=e.featuresLength;if(!Object(s["a"])(e._features)&&t>0){const i=new Array(t);Object(s["a"])(e._polygons)&&e._polygons.createFeatures(e,i),Object(s["a"])(e._polylines)&&e._polylines.createFeatures(e,i),Object(s["a"])(e._points)&&e._points.createFeatures(e,i),e._features=i}}function j(e,t,i,n,o,a){const s=t.length;let r=0;for(let c=0;c<s;c++){const s=3*t[c],d=e.slice(r,r+s);r+=s,a(d,i[c],o,n)}}I.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},I.prototype.getFeature=function(e){return w(this),this._features[e]},I.prototype.applyDebugSettings=function(e,t){Object(s["a"])(this._polygons)&&this._polygons.applyDebugSettings(e,t),Object(s["a"])(this._polylines)&&this._polylines.applyDebugSettings(e,t),Object(s["a"])(this._points)&&this._points.applyDebugSettings(e,t)},I.prototype.applyStyle=function(e){w(this),Object(s["a"])(this._polygons)&&this._polygons.applyStyle(e,this._features),Object(s["a"])(this._polylines)&&this._polylines.applyStyle(e,this._features),Object(s["a"])(this._points)&&this._points.applyStyle(e,this._features)},I.prototype.update=function(e,t){let i=!0;if(Object(s["a"])(this._polygons)&&(this._polygons.classificationType=this._tileset.classificationType,this._polygons.debugWireframe=this._tileset.debugWireframe,this._polygons.update(t),i=i&&this._polygons._ready),Object(s["a"])(this._polylines)&&(this._polylines.update(t),i=i&&this._polylines._ready),Object(s["a"])(this._points)&&(this._points.update(t),i=i&&this._points._ready),Object(s["a"])(this._batchTable)&&i&&this._batchTable.update(e,t),!Object(s["a"])(this._contentReadyPromise)){const e=Object(s["a"])(this._points)?this._points.readyPromise:void 0,t=Object(s["a"])(this._polygons)?this._polygons.readyPromise:void 0,i=Object(s["a"])(this._polylines)?this._polylines.readyPromise:void 0,n=this;this._contentReadyPromise=Promise.all([e,t,i]).then((function(){n._readyPromise.resolve(n)})).catch((function(e){n._readyPromise.reject(e)}))}},I.prototype.getPolylinePositions=function(e){const t=this._polylines;if(Object(s["a"])(t))return t.getPositions(e)},I.prototype.isDestroyed=function(){return!1},I.prototype.destroy=function(){return this._polygons=this._polygons&&this._polygons.destroy(),this._polylines=this._polylines&&this._polylines.destroy(),this._points=this._points&&this._points.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),Object(r["a"])(this)},t["a"]=I},"51a0":function(e,t,i){"use strict";var n=i("1d87"),o=i("cef5"),a=i("be18"),s=i("bd8d"),r=i("535a"),c=i("9c35"),d=i("2f63"),l=i("7d62"),h=i("52f0"),u=i("6a29"),_=i("5a6c"),f=i("d8f6"),p=i("27aa");function b(e){this._boxes=e.boxes,this._boxBatchIds=e.boxBatchIds,this._cylinders=e.cylinders,this._cylinderBatchIds=e.cylinderBatchIds,this._ellipsoids=e.ellipsoids,this._ellipsoidBatchIds=e.ellipsoidBatchIds,this._spheres=e.spheres,this._sphereBatchIds=e.sphereBatchIds,this._modelMatrix=e.modelMatrix,this._batchTable=e.batchTable,this._boundingVolume=e.boundingVolume,this._center=e.center,Object(d["a"])(this._center)||(Object(d["a"])(this._boundingVolume)?this._center=a["a"].clone(this._boundingVolume.center):this._center=a["a"].clone(a["a"].ZERO)),this._boundingVolumes=void 0,this._batchedIndices=void 0,this._indices=void 0,this._indexOffsets=void 0,this._indexCounts=void 0,this._positions=void 0,this._vertexBatchIds=void 0,this._batchIds=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._ready=!1,this._readyPromise=Object(c["a"])(),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=_["a"].BOTH}function m(e){const t=new Float64Array(h["a"].packedLength+a["a"].packedLength);let i=0;return a["a"].pack(e._center,t,i),i+=a["a"].packedLength,h["a"].pack(e._modelMatrix,t,i),t}function g(e,t){let i=0;const n=t[i++],a=t[i++],r=e._boundingVolumes=new Array(a);for(let s=0;s<a;++s)r[s]=o["a"].unpack(t,i),i+=o["a"].packedLength;const c=t[i++],d=e._batchedIndices=new Array(c);for(let o=0;o<c;++o){const e=s["a"].unpack(t,i);i+=s["a"].packedLength;const n=t[i++],a=t[i++],r=t[i++],c=new Array(r);for(let o=0;o<r;++o)c[o]=t[i++];d[o]=new f["a"]({color:e,offset:n,count:a,batchIds:c})}return n}Object.defineProperties(b.prototype,{trianglesLength:{get:function(){return Object(d["a"])(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return Object(d["a"])(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise.promise}}}),b.packedBoxLength=h["a"].packedLength+a["a"].packedLength,b.packedCylinderLength=h["a"].packedLength+2,b.packedEllipsoidLength=h["a"].packedLength+a["a"].packedLength,b.packedSphereLength=a["a"].packedLength+1;const y=new u["a"]("createVectorTileGeometries",5),O=new s["a"];function v(e){if(!Object(d["a"])(e._primitive)){if(!Object(d["a"])(e._verticesPromise)){let t=e._boxes,i=e._boxBatchIds,o=e._cylinders,a=e._cylinderBatchIds,s=e._ellipsoids,r=e._ellipsoidBatchIds,c=e._spheres,l=e._sphereBatchIds,h=e._batchTableColors,u=e._packedBuffer;if(!Object(d["a"])(h)){let _=0;Object(d["a"])(e._boxes)&&(t=e._boxes=Object(n["a"])(t),i=e._boxBatchIds=Object(n["a"])(i),_+=i.length),Object(d["a"])(e._cylinders)&&(o=e._cylinders=Object(n["a"])(o),a=e._cylinderBatchIds=Object(n["a"])(a),_+=a.length),Object(d["a"])(e._ellipsoids)&&(s=e._ellipsoids=Object(n["a"])(s),r=e._ellipsoidBatchIds=Object(n["a"])(r),_+=r.length),Object(d["a"])(e._spheres)&&(c=e._sphere=Object(n["a"])(c),l=e._sphereBatchIds=Object(n["a"])(l),_+=l.length),h=e._batchTableColors=new Uint32Array(_);const f=e._batchTable;for(let e=0;e<_;++e){const t=f.getColor(e,O);h[e]=t.toRgba()}u=e._packedBuffer=m(e)}const _=[];Object(d["a"])(t)&&_.push(t.buffer,i.buffer),Object(d["a"])(o)&&_.push(o.buffer,a.buffer),Object(d["a"])(s)&&_.push(s.buffer,r.buffer),Object(d["a"])(c)&&_.push(c.buffer,l.buffer),_.push(h.buffer,u.buffer);const f={boxes:Object(d["a"])(t)?t.buffer:void 0,boxBatchIds:Object(d["a"])(t)?i.buffer:void 0,cylinders:Object(d["a"])(o)?o.buffer:void 0,cylinderBatchIds:Object(d["a"])(o)?a.buffer:void 0,ellipsoids:Object(d["a"])(s)?s.buffer:void 0,ellipsoidBatchIds:Object(d["a"])(s)?r.buffer:void 0,spheres:Object(d["a"])(c)?c.buffer:void 0,sphereBatchIds:Object(d["a"])(c)?l.buffer:void 0,batchTableColors:h.buffer,packedBuffer:u.buffer},p=e._verticesPromise=y.scheduleTask(f,_);if(!Object(d["a"])(p))return;p.then((function(t){const i=new Float64Array(t.packedBuffer),n=g(e,i);e._indices=2===n?new Uint16Array(t.indices):new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._positions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.vertexBatchIds),e._batchIds=new Uint16Array(t.batchIds),e._ready=!0}))}e._ready&&!Object(d["a"])(e._primitive)&&(e._primitive=new p["a"]({batchTable:e._batchTable,positions:e._positions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center,pickObject:Object(r["a"])(e._pickObject,e)}),e._boxes=void 0,e._boxBatchIds=void 0,e._cylinders=void 0,e._cylinderBatchIds=void 0,e._ellipsoids=void 0,e._ellipsoidBatchIds=void 0,e._spheres=void 0,e._sphereBatchIds=void 0,e._center=void 0,e._modelMatrix=void 0,e._batchTable=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0,e._indices=void 0,e._indexOffsets=void 0,e._indexCounts=void 0,e._positions=void 0,e._vertexBatchIds=void 0,e._batchIds=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._verticesPromise=void 0,e._readyPromise.resolve())}}b.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},b.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},b.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},b.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},b.prototype.update=function(e){v(this),this._ready&&(this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e))},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),Object(l["a"])(this)},t["a"]=b},"619f":function(e,t,i){"use strict";var n=i("dc1c"),o=i("535a"),a=i("2f63"),s=i("55f9"),r=i("ddf7"),c=i("dd17"),d=i("fa1c");function l(e,t,i,o,a,s,r,c,d,l){this._tweens=e,this._tweenjs=t,this._startObject=Object(n["a"])(i),this._stopObject=Object(n["a"])(o),this._duration=a,this._delay=s,this._easingFunction=r,this._update=c,this._complete=d,this.cancel=l,this.needsStart=!0}function h(){this._tweens=[]}Object.defineProperties(l.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}}),l.prototype.cancelTween=function(){this._tweens.remove(this)},Object.defineProperties(h.prototype,{length:{get:function(){return this._tweens.length}}}),h.prototype.add=function(e){if(e=Object(o["a"])(e,o["a"].EMPTY_OBJECT),0===e.duration)return Object(a["a"])(e.complete)&&e.complete(),new l(this);const t=e.duration/c["a"].SECONDS_PER_MILLISECOND,i=Object(o["a"])(e.delay,0),r=i/c["a"].SECONDS_PER_MILLISECOND,h=Object(o["a"])(e.easingFunction,s["a"].LINEAR_NONE),u=e.startObject,_=new d["a"].Tween(u);_.to(Object(n["a"])(e.stopObject),t),_.delay(r),_.easing(h),Object(a["a"])(e.update)&&_.onUpdate((function(){e.update(u)})),_.onComplete(Object(o["a"])(e.complete,null)),_.repeat(Object(o["a"])(e._repeat,0));const f=new l(this,_,e.startObject,e.stopObject,e.duration,i,h,e.update,e.complete,e.cancel);return this._tweens.push(f),f},h.prototype.addProperty=function(e){e=Object(o["a"])(e,o["a"].EMPTY_OBJECT);const t=e.object,i=e.property,n=e.startValue,a=e.stopValue;function s(e){t[i]=e.value}return this.add({startObject:{value:n},stopObject:{value:a},duration:Object(o["a"])(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:s,complete:e.complete,cancel:e.cancel,_repeat:e._repeat})},h.prototype.addAlpha=function(e){e=Object(o["a"])(e,o["a"].EMPTY_OBJECT);const t=e.material,i=[];for(const o in t.uniforms)t.uniforms.hasOwnProperty(o)&&Object(a["a"])(t.uniforms[o])&&Object(a["a"])(t.uniforms[o].alpha)&&i.push(o);function n(e){const n=i.length;for(let o=0;o<n;++o)t.uniforms[i[o]].alpha=e.alpha}return this.add({startObject:{alpha:Object(o["a"])(e.startValue,0)},stopObject:{alpha:Object(o["a"])(e.stopValue,1)},duration:Object(o["a"])(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:n,complete:e.complete,cancel:e.cancel})},h.prototype.addOffsetIncrement=function(e){e=Object(o["a"])(e,o["a"].EMPTY_OBJECT);const t=e.material,i=t.uniforms;return this.addProperty({object:i,property:"offset",startValue:i.offset,stopValue:i.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:1/0})},h.prototype.remove=function(e){if(!Object(a["a"])(e))return!1;const t=this._tweens.indexOf(e);return-1!==t&&(e.tweenjs.stop(),Object(a["a"])(e.cancel)&&e.cancel(),this._tweens.splice(t,1),!0)},h.prototype.removeAll=function(){const e=this._tweens;for(let t=0;t<e.length;++t){const i=e[t];i.tweenjs.stop(),Object(a["a"])(i.cancel)&&i.cancel()}e.length=0},h.prototype.contains=function(e){return Object(a["a"])(e)&&-1!==this._tweens.indexOf(e)},h.prototype.get=function(e){return this._tweens[e]},h.prototype.update=function(e){const t=this._tweens;let i=0;e=Object(a["a"])(e)?e/c["a"].SECONDS_PER_MILLISECOND:Object(r["a"])();while(i<t.length){const n=t[i],o=n.tweenjs;n.needsStart?(n.needsStart=!1,o.start(e)):o.update(e)?i++:(o.stop(),t.splice(i,1))}},t["a"]=h},a141:function(e,t,i){"use strict";var n=i("2f63");const o={POSITION:"POSITION",NORMAL:"NORMAL",TANGENT:"TANGENT",TEXCOORD:"TEXCOORD",COLOR:"COLOR",JOINTS:"JOINTS",WEIGHTS:"WEIGHTS",FEATURE_ID:"_FEATURE_ID"};function a(e){switch(e){case o.POSITION:return"positionMC";case o.NORMAL:return"normalMC";case o.TANGENT:return"tangentMC";case o.TEXCOORD:return"texCoord";case o.COLOR:return"color";case o.JOINTS:return"joints";case o.WEIGHTS:return"weights";case o.FEATURE_ID:return"featureId"}}o.hasSetIndex=function(e){switch(e){case o.POSITION:case o.NORMAL:case o.TANGENT:return!1;case o.TEXCOORD:case o.COLOR:case o.JOINTS:case o.WEIGHTS:case o.FEATURE_ID:return!0}},o.fromGltfSemantic=function(e){let t=e;const i=/^(\w+)_\d+$/,n=i.exec(e);switch(null!==n&&(t=n[1]),t){case"POSITION":return o.POSITION;case"NORMAL":return o.NORMAL;case"TANGENT":return o.TANGENT;case"TEXCOORD":return o.TEXCOORD;case"COLOR":return o.COLOR;case"JOINTS":return o.JOINTS;case"WEIGHTS":return o.WEIGHTS;case"_FEATURE_ID":return o.FEATURE_ID}},o.fromPntsSemantic=function(e){switch(e){case"POSITION":case"POSITION_QUANTIZED":return o.POSITION;case"RGBA":case"RGB":case"RGB565":return o.COLOR;case"NORMAL":case"NORMAL_OCT16P":return o.NORMAL;case"BATCH_ID":return o.FEATURE_ID}},o.getGlslType=function(e){switch(e){case o.POSITION:case o.NORMAL:case o.TANGENT:return"vec3";case o.TEXCOORD:return"vec2";case o.COLOR:return"vec4";case o.JOINTS:return"ivec4";case o.WEIGHTS:return"vec4";case o.FEATURE_ID:return"int"}},o.getVariableName=function(e,t){let i=a(e);return Object(n["a"])(t)&&(i+="_"+t),i},t["a"]=Object.freeze(o)},a230:function(e,t,i){"use strict";var n=i("1d87"),o=i("be18"),a=i("bd8d"),s=i("abab"),r=i("535a"),c=i("9c35"),d=i("2f63"),l=i("7d62"),h=i("c52f"),u=i("5e57"),_=i("0123"),f=i("52f0"),p=i("eace"),b=i("6a29"),m=i("f20a"),g=i("8b68"),y=i("a894"),O=i("d289"),v=i("6dc0"),I=i("e90c"),T=i("5770"),C=i("7c5e"),S=i("b71e"),x=i("95fee"),P=i("b7c8"),A=i("5af0");function w(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=Object(r["a"])(e.ellipsoid,h["a"].WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._boundingVolume=e.boundingVolume,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._currentPositions=void 0,this._previousPositions=void 0,this._nextPositions=void 0,this._expandAndWidth=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=a["a"].clone(a["a"].WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._readyPromise=Object(c["a"])(),this._verticesPromise=void 0}function j(e){const t=e._rectangle,i=e._minimumHeight,n=e._maximumHeight,a=e._ellipsoid,s=e._center,r=2+p["a"].packedLength+h["a"].packedLength+o["a"].packedLength,c=new Float64Array(r);let d=0;return c[d++]=i,c[d++]=n,p["a"].pack(t,c,d),d+=p["a"].packedLength,h["a"].pack(a,c,d),d+=h["a"].packedLength,o["a"].pack(s,c,d),c}Object.defineProperties(w.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},readyPromise:{get:function(){return this._readyPromise.promise}}});const E=new b["a"]("createVectorTilePolylines",5),L={previousPosition:0,currentPosition:1,nextPosition:2,expandAndWidth:3,a_batchId:4};function D(e,t){if(!Object(d["a"])(e._va)){if(!Object(d["a"])(e._verticesPromise)){let t=e._positions,i=e._widths,o=e._counts,a=e._transferrableBatchIds,s=e._packedBuffer;Object(d["a"])(s)||(t=e._positions=Object(n["a"])(t),i=e._widths=Object(n["a"])(i),o=e._counts=Object(n["a"])(o),a=e._transferrableBatchIds=Object(n["a"])(e._batchIds),s=e._packedBuffer=j(e));const r=[t.buffer,i.buffer,o.buffer,a.buffer,s.buffer],c={positions:t.buffer,widths:i.buffer,counts:o.buffer,batchIds:a.buffer,packedBuffer:s.buffer,keepDecodedPositions:e._keepDecodedPositions},l=e._verticesPromise=E.scheduleTask(c,r);if(!Object(d["a"])(l))return;l.then((function(t){e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(t.decodedPositions),e._decodedPositionOffsets=new Uint32Array(t.decodedPositionOffsets)),e._currentPositions=new Float32Array(t.currentPositions),e._previousPositions=new Float32Array(t.previousPositions),e._nextPositions=new Float32Array(t.nextPositions),e._expandAndWidth=new Float32Array(t.expandAndWidth),e._vertexBatchIds=new Uint16Array(t.batchIds);const i=t.indexDatatype;e._indices=i===_["a"].UNSIGNED_SHORT?new Uint16Array(t.indices):new Uint32Array(t.indices),e._ready=!0})).catch((function(t){e._readyPromise.reject(t)}))}if(e._ready&&!Object(d["a"])(e._va)){const i=e._currentPositions,n=e._previousPositions,o=e._nextPositions,a=e._expandAndWidth,r=e._vertexBatchIds,c=e._indices;let d=n.byteLength+i.byteLength+o.byteLength;d+=a.byteLength+r.byteLength+c.byteLength,e._trianglesLength=c.length/3,e._geometryByteLength=d;const l=m["a"].createVertexBuffer({context:t,typedArray:n,usage:g["a"].STATIC_DRAW}),h=m["a"].createVertexBuffer({context:t,typedArray:i,usage:g["a"].STATIC_DRAW}),u=m["a"].createVertexBuffer({context:t,typedArray:o,usage:g["a"].STATIC_DRAW}),f=m["a"].createVertexBuffer({context:t,typedArray:a,usage:g["a"].STATIC_DRAW}),p=m["a"].createVertexBuffer({context:t,typedArray:r,usage:g["a"].STATIC_DRAW}),b=m["a"].createIndexBuffer({context:t,typedArray:c,usage:g["a"].STATIC_DRAW,indexDatatype:2===c.BYTES_PER_ELEMENT?_["a"].UNSIGNED_SHORT:_["a"].UNSIGNED_INT}),y=[{index:L.previousPosition,vertexBuffer:l,componentDatatype:s["a"].FLOAT,componentsPerAttribute:3},{index:L.currentPosition,vertexBuffer:h,componentDatatype:s["a"].FLOAT,componentsPerAttribute:3},{index:L.nextPosition,vertexBuffer:u,componentDatatype:s["a"].FLOAT,componentsPerAttribute:3},{index:L.expandAndWidth,vertexBuffer:f,componentDatatype:s["a"].FLOAT,componentsPerAttribute:2},{index:L.a_batchId,vertexBuffer:p,componentDatatype:s["a"].UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new C["a"]({context:t,attributes:y,indexBuffer:b}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._currentPositions=void 0,e._previousPositions=void 0,e._nextPositions=void 0,e._expandAndWidth=void 0,e._vertexBatchIds=void 0,e._indices=void 0,e._readyPromise.resolve()}}}const N=new f["a"],B=new o["a"];function k(e,t){Object(d["a"])(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){const i=t.uniformState.view;return f["a"].clone(i,N),f["a"].multiplyByPoint(N,e._center,B),f["a"].setTranslation(N,B,N),N},u_highlightColor:function(){return e._highlightColor}})}function F(e){if(Object(d["a"])(e._rs))return;const t={enabled:!0,factor:-5,units:-5};e._rs=v["a"].fromCache({blending:P["a"].ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0},polygonOffset:t})}const R="uniform vec4 u_highlightColor; \nvoid main()\n{\n    gl_FragColor = u_highlightColor;\n}\n";function H(e,t){if(Object(d["a"])(e._sp))return;const i=e._batchTable,n=i.getVertexShaderCallback(!1,"a_batchId",void 0)(x["a"]),o=i.getFragmentShaderCallback(!1,void 0,!1)(R),a=new T["a"]({defines:["VECTOR_TILE",u["a"].isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[S["a"],n]}),s=new T["a"]({defines:["VECTOR_TILE"],sources:[o]});e._sp=I["a"].fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:s,attributeLocations:L})}function M(e,t){if(!Object(d["a"])(e._command)){const t=e._batchTable.getUniformMapCallback()(e._uniformMap);e._command=new y["a"]({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:t,boundingVolume:e._boundingVolume,pass:O["a"].TRANSLUCENT,pickId:e._batchTable.getPickId()})}t.commandList.push(e._command)}function U(e,t){const i=e._batchIds,n=i.length;for(let o=0;o<n;++o){const e=i[o],n=t[e];n.show=!0,n.color=a["a"].WHITE}}w.getPolylinePositions=function(e,t){const i=e._batchIds,n=e._decodedPositions,o=e._decodedPositionOffsets;if(!Object(d["a"])(i)||!Object(d["a"])(n))return;let a,s;const r=i.length;let c=0,l=0;for(a=0;a<r;++a)i[a]===t&&(c+=o[a+1]-o[a]);if(0===c)return;const h=new Float64Array(3*c);for(a=0;a<r;++a)if(i[a]===t){const e=o[a],t=o[a+1]-e;for(s=0;s<t;++s){const t=3*(e+s);h[l++]=n[t],h[l++]=n[t+1],h[l++]=n[t+2]}}return h},w.prototype.getPositions=function(e){return w.getPolylinePositions(this,e)},w.prototype.createFeatures=function(e,t){const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=i[o];t[n]=new A["a"](e,n)}},w.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};const V=new a["a"],W=a["a"].WHITE,G=!0;w.prototype.applyStyle=function(e,t){if(!Object(d["a"])(e))return void U(this,t);const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=i[o],a=t[n];a.color=Object(d["a"])(e.color)?e.color.evaluateColor(a,V):W,a.show=Object(d["a"])(e.show)?e.show.evaluate(a):G}},w.prototype.update=function(e){const t=e.context;if(D(this,t),k(this,t),H(this,t),F(this),!this._ready)return;const i=e.passes;(i.render||i.pick)&&M(this,e)},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),Object(l["a"])(this)},t["a"]=w},b61c:function(e,t,i){"use strict";var n=i("dd06"),o=i("1d87"),a=i("670c"),s=i("be18"),r=i("bd8d"),c=i("abab"),d=i("535a"),l=i("9c35"),h=i("2f63"),u=i("7d62"),_=i("c52f"),f=i("5e57"),p=i("0123"),b=i("78e5"),m=i("52f0"),g=i("eace"),y=i("6a29"),O=i("f20a"),v=i("8b68"),I=i("a894"),T=i("d289"),C=i("6dc0"),S=i("e90c"),x=i("5770"),P=i("7c5e"),A=i("b71e"),w=i("28ac"),j=i("3e7b"),E=i("b7c8"),L=i("5af0"),D=i("5a6c"),N=i("29ab"),B=i("3626"),k=i("6102"),F=i("25ef"),R=i("a230");function H(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=Object(d["a"])(e.ellipsoid,_["a"].WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._minimumMaximumVectorHeights=new a["a"](n["a"]._defaultMinTerrainHeight,n["a"]._defaultMaxTerrainHeight),this._boundingVolume=b["a"].fromRectangle(e.rectangle,n["a"]._defaultMinTerrainHeight,n["a"]._defaultMaxTerrainHeight,this._ellipsoid),this._classificationType=e.classificationType,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._startEllipsoidNormals=void 0,this._endEllipsoidNormals=void 0,this._startPositionAndHeights=void 0,this._startFaceNormalAndVertexCornerIds=void 0,this._endPositionAndHeights=void 0,this._endFaceNormalAndHalfWidths=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=r["a"].clone(r["a"].WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._readyPromise=Object(l["a"])(),this._verticesPromise=void 0;const t=this;n["a"].initialize().then((function(){M(t,t._rectangle,t._ellipsoid)})).catch((function(e){this._readyPromise.reject(e)}))}function M(e,t,i){const o=n["a"].getMinimumMaximumHeights(t,i),a=o.minimumTerrainHeight,s=o.maximumTerrainHeight,r=e._minimumMaximumVectorHeights;r.x=a,r.y=s;const c=e._boundingVolume,d=e._rectangle;b["a"].fromRectangle(d,a,s,i,c)}function U(e){const t=e._rectangle,i=e._minimumHeight,n=e._maximumHeight,o=e._ellipsoid,a=e._center,r=2+g["a"].packedLength+_["a"].packedLength+s["a"].packedLength,c=new Float64Array(r);let d=0;return c[d++]=i,c[d++]=n,g["a"].pack(t,c,d),d+=g["a"].packedLength,_["a"].pack(o,c,d),d+=_["a"].packedLength,s["a"].pack(a,c,d),c}Object.defineProperties(H.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},readyPromise:{get:function(){return this._readyPromise.promise}}});const V=new y["a"]("createVectorTileClampedPolylines"),W={startEllipsoidNormal:0,endEllipsoidNormal:1,startPositionAndHeight:2,endPositionAndHeight:3,startFaceNormalAndVertexCorner:4,endFaceNormalAndHalfWidth:5,a_batchId:6};function G(e,t){if(!Object(h["a"])(e._va)){if(!Object(h["a"])(e._verticesPromise)){let t=e._positions,i=e._widths,n=e._counts,a=e._transferrableBatchIds,s=e._packedBuffer;Object(h["a"])(s)||(t=e._positions=Object(o["a"])(t),i=e._widths=Object(o["a"])(i),n=e._counts=Object(o["a"])(n),a=e._transferrableBatchIds=Object(o["a"])(e._batchIds),s=e._packedBuffer=U(e));const r=[t.buffer,i.buffer,n.buffer,a.buffer,s.buffer],c={positions:t.buffer,widths:i.buffer,counts:n.buffer,batchIds:a.buffer,packedBuffer:s.buffer,keepDecodedPositions:e._keepDecodedPositions},d=e._verticesPromise=V.scheduleTask(c,r);if(!Object(h["a"])(d))return;Promise.resolve(d).then((function(t){e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(t.decodedPositions),e._decodedPositionOffsets=new Uint32Array(t.decodedPositionOffsets)),e._startEllipsoidNormals=new Float32Array(t.startEllipsoidNormals),e._endEllipsoidNormals=new Float32Array(t.endEllipsoidNormals),e._startPositionAndHeights=new Float32Array(t.startPositionAndHeights),e._startFaceNormalAndVertexCornerIds=new Float32Array(t.startFaceNormalAndVertexCornerIds),e._endPositionAndHeights=new Float32Array(t.endPositionAndHeights),e._endFaceNormalAndHalfWidths=new Float32Array(t.endFaceNormalAndHalfWidths),e._vertexBatchIds=new Uint16Array(t.vertexBatchIds);const i=t.indexDatatype;e._indices=i===p["a"].UNSIGNED_SHORT?new Uint16Array(t.indices):new Uint32Array(t.indices),e._ready=!0})).catch((function(t){e._readyPromise.reject(t)}))}if(e._ready&&!Object(h["a"])(e._va)){const i=e._startEllipsoidNormals,n=e._endEllipsoidNormals,o=e._startPositionAndHeights,a=e._endPositionAndHeights,s=e._startFaceNormalAndVertexCornerIds,r=e._endFaceNormalAndHalfWidths,d=e._vertexBatchIds,l=e._indices;let h=i.byteLength+n.byteLength;h+=o.byteLength+a.byteLength,h+=s.byteLength+r.byteLength,h+=d.byteLength+l.byteLength,e._trianglesLength=l.length/3,e._geometryByteLength=h;const u=O["a"].createVertexBuffer({context:t,typedArray:i,usage:v["a"].STATIC_DRAW}),_=O["a"].createVertexBuffer({context:t,typedArray:n,usage:v["a"].STATIC_DRAW}),f=O["a"].createVertexBuffer({context:t,typedArray:o,usage:v["a"].STATIC_DRAW}),b=O["a"].createVertexBuffer({context:t,typedArray:a,usage:v["a"].STATIC_DRAW}),m=O["a"].createVertexBuffer({context:t,typedArray:s,usage:v["a"].STATIC_DRAW}),g=O["a"].createVertexBuffer({context:t,typedArray:r,usage:v["a"].STATIC_DRAW}),y=O["a"].createVertexBuffer({context:t,typedArray:d,usage:v["a"].STATIC_DRAW}),I=O["a"].createIndexBuffer({context:t,typedArray:l,usage:v["a"].STATIC_DRAW,indexDatatype:2===l.BYTES_PER_ELEMENT?p["a"].UNSIGNED_SHORT:p["a"].UNSIGNED_INT}),T=[{index:W.startEllipsoidNormal,vertexBuffer:u,componentDatatype:c["a"].FLOAT,componentsPerAttribute:3},{index:W.endEllipsoidNormal,vertexBuffer:_,componentDatatype:c["a"].FLOAT,componentsPerAttribute:3},{index:W.startPositionAndHeight,vertexBuffer:f,componentDatatype:c["a"].FLOAT,componentsPerAttribute:4},{index:W.endPositionAndHeight,vertexBuffer:b,componentDatatype:c["a"].FLOAT,componentsPerAttribute:4},{index:W.startFaceNormalAndVertexCorner,vertexBuffer:m,componentDatatype:c["a"].FLOAT,componentsPerAttribute:4},{index:W.endFaceNormalAndHalfWidth,vertexBuffer:g,componentDatatype:c["a"].FLOAT,componentsPerAttribute:4},{index:W.a_batchId,vertexBuffer:y,componentDatatype:c["a"].UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new P["a"]({context:t,attributes:T,indexBuffer:I}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._startEllipsoidNormals=void 0,e._endEllipsoidNormals=void 0,e._startPositionAndHeights=void 0,e._startFaceNormalAndVertexCornerIds=void 0,e._endPositionAndHeights=void 0,e._endFaceNormalAndHalfWidths=void 0,e._vertexBatchIds=void 0,e._indices=void 0,e._readyPromise.resolve()}}}const z=new m["a"],Y=new s["a"];function Z(e,t){Object(h["a"])(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){const i=t.uniformState.view;return m["a"].clone(i,z),m["a"].multiplyByPoint(z,e._center,Y),m["a"].setTranslation(z,Y,z),z},u_highlightColor:function(){return e._highlightColor},u_minimumMaximumVectorHeights:function(){return e._minimumMaximumVectorHeights}})}function K(e){return C["a"].fromCache({cull:{enabled:!0,face:N["a"].FRONT},blending:E["a"].PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:k["a"].EQUAL,frontOperation:{fail:F["a"].KEEP,zFail:F["a"].KEEP,zPass:F["a"].KEEP},backFunction:k["a"].EQUAL,backOperation:{fail:F["a"].KEEP,zFail:F["a"].KEEP,zPass:F["a"].KEEP},reference:B["a"].CESIUM_3D_TILE_MASK,mask:B["a"].CESIUM_3D_TILE_MASK}})}function X(e){Object(h["a"])(e._rs)||(e._rs=K(!1),e._rs3DTiles=K(!0))}function J(e,t){if(Object(h["a"])(e._sp))return;const i=e._batchTable,n=i.getVertexShaderCallback(!1,"a_batchId",void 0)(w["a"]),o=i.getFragmentShaderCallback(!1,void 0,!0)(j["a"]),a=new x["a"]({defines:["VECTOR_TILE",f["a"].isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[A["a"],n]}),s=new x["a"]({defines:["VECTOR_TILE"],sources:[o]});e._sp=S["a"].fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:s,attributeLocations:W})}function q(e,t){let i=e._command;if(!Object(h["a"])(e._command)){const t=e._batchTable.getUniformMapCallback()(e._uniformMap);i=e._command=new I["a"]({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:t,boundingVolume:e._boundingVolume,pass:T["a"].TERRAIN_CLASSIFICATION,pickId:e._batchTable.getPickId()});const n=I["a"].shallowClone(i,i.derivedCommands.tileset);n.renderState=e._rs3DTiles,n.pass=T["a"].CESIUM_3D_TILE_CLASSIFICATION,i.derivedCommands.tileset=n}const n=e._classificationType;n!==D["a"].TERRAIN&&n!==D["a"].BOTH||t.commandList.push(i),n!==D["a"].CESIUM_3D_TILE&&n!==D["a"].BOTH||t.commandList.push(i.derivedCommands.tileset)}function Q(e,t){const i=e._batchIds,n=i.length;for(let o=0;o<n;++o){const e=i[o],n=t[e];n.show=!0,n.color=r["a"].WHITE}}H.prototype.getPositions=function(e){return R["a"].getPolylinePositions(this,e)},H.prototype.createFeatures=function(e,t){const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=i[o];t[n]=new L["a"](e,n)}},H.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};const $=new r["a"],ee=r["a"].WHITE,te=!0;H.prototype.applyStyle=function(e,t){if(!Object(h["a"])(e))return void Q(this,t);const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=i[o],a=t[n];a.color=Object(h["a"])(e.color)?e.color.evaluateColor(a,$):ee,a.show=Object(h["a"])(e.show)?e.show.evaluate(a):te}},H.prototype.update=function(e){const t=e.context;if(G(this,t),Z(this,t),J(this,t),X(this),!this._ready)return;const i=e.passes;(i.render||i.pick)&&q(this,e)},H.prototype.isDestroyed=function(){return!1},H.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),Object(u["a"])(this)},t["a"]=H},c3f4:function(e,t,i){"use strict";const n={REINHARD:0,MODIFIED_REINHARD:1,FILMIC:2,ACES:3,validate:function(e){return e===n.REINHARD||e===n.MODIFIED_REINHARD||e===n.FILMIC||e===n.ACES}};t["a"]=Object.freeze(n)},d8f6:function(e,t,i){"use strict";function n(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}t["a"]=n},db4b:function(e,t,i){"use strict";var n=i("1d87"),o=i("670c"),a=i("be18"),s=i("bd8d"),r=i("2f63"),c=i("9c35"),d=i("7d62"),l=i("aee6"),h=i("c52f"),u=i("6dfc"),_=i("eace"),f=i("6a29"),p=i("8f7c"),b=i("7950"),m=i("f61d"),g=i("04e1"),y=i("4626"),O=i("4082"),v=i("05e5");function I(e){this._positions=e.positions,this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._rectangle=e.rectangle,this._minHeight=e.minimumHeight,this._maxHeight=e.maximumHeight,this._billboardCollection=void 0,this._labelCollection=void 0,this._polylineCollection=void 0,this._verticesPromise=void 0,this._packedBuffer=void 0,this._ready=!1,this._readyPromise=Object(c["a"])(),this._resolvedPromise=!1}function T(e,t){const i=e._rectangle,n=e._minHeight,o=e._maxHeight,a=2+_["a"].packedLength+h["a"].packedLength,s=new Float64Array(a);let r=0;return s[r++]=n,s[r++]=o,_["a"].pack(i,s,r),r+=_["a"].packedLength,h["a"].pack(t,s,r),s}Object.defineProperties(I.prototype,{pointsLength:{get:function(){return this._billboardCollection.length}},texturesByteLength:{get:function(){const e=this._billboardCollection.textureAtlas.texture.sizeInBytes,t=this._labelCollection._textureAtlas.texture.sizeInBytes;return e+t}},readyPromise:{get:function(){return this._readyPromise.promise}}});const C=new f["a"]("createVectorTilePoints",5),S=new a["a"];function x(e,t){if(Object(r["a"])(e._billboardCollection))return;let i;if(!Object(r["a"])(e._verticesPromise)){i=e._positions;let o=e._packedBuffer;Object(r["a"])(o)||(i=e._positions=Object(n["a"])(i),e._batchIds=Object(n["a"])(e._batchIds),o=e._packedBuffer=T(e,t));const a=[i.buffer,o.buffer],s={positions:i.buffer,packedBuffer:o.buffer},c=e._verticesPromise=C.scheduleTask(s,a);if(!Object(r["a"])(c))return;c.then((function(t){e._positions=new Float64Array(t.positions),e._ready=!0}))}if(e._ready&&!Object(r["a"])(e._billboardCollection)){i=e._positions;const t=e._batchTable,n=e._batchIds,o=e._billboardCollection=new p["a"]({batchTable:t}),s=e._labelCollection=new g["a"]({batchTable:t}),r=e._polylineCollection=new O["a"];r._useHighlightColor=!0;const c=i.length/3;for(let e=0;e<c;++e){const t=n[e],c=a["a"].unpack(i,3*e,S),d=o.add();d.position=c,d._batchIndex=t;const l=s.add();l.text=" ",l.position=c,l._batchIndex=t;const h=r.add();h.positions=[a["a"].clone(c),a["a"].clone(c)]}e._positions=void 0,e._packedBuffer=void 0}}function P(e,t){const i=e._batchIds,n=i.length;for(let a=0;a<n;++a){const e=i[a],n=t[e];n.show=!0,n.pointSize=b["a"].defaultPointSize,n.color=b["a"].defaultColor,n.pointOutlineColor=b["a"].defaultPointOutlineColor,n.pointOutlineWidth=b["a"].defaultPointOutlineWidth,n.labelColor=s["a"].WHITE,n.labelOutlineColor=s["a"].WHITE,n.labelOutlineWidth=1,n.font="30px sans-serif",n.labelStyle=y["a"].FILL,n.labelText=void 0,n.backgroundColor=new s["a"](.165,.165,.165,.8),n.backgroundPadding=new o["a"](7,5),n.backgroundEnabled=!1,n.scaleByDistance=void 0,n.translucencyByDistance=void 0,n.distanceDisplayCondition=void 0,n.heightOffset=0,n.anchorLineEnabled=!1,n.anchorLineColor=s["a"].WHITE,n.image=void 0,n.disableDepthTestDistance=0,n.horizontalOrigin=m["a"].CENTER,n.verticalOrigin=v["a"].CENTER,n.labelHorizontalOrigin=m["a"].RIGHT,n.labelVerticalOrigin=v["a"].BASELINE}}I.prototype.createFeatures=function(e,t){const i=this._billboardCollection,n=this._labelCollection,o=this._polylineCollection,a=this._batchIds,s=a.length;for(let r=0;r<s;++r){const s=a[r],c=i.get(r),d=n.get(r),l=o.get(r);t[s]=new b["a"](e,s,c,d,l)}},I.prototype.applyDebugSettings=function(e,t){e?(s["a"].clone(t,this._billboardCollection._highlightColor),s["a"].clone(t,this._labelCollection._highlightColor),s["a"].clone(t,this._polylineCollection._highlightColor)):(s["a"].clone(s["a"].WHITE,this._billboardCollection._highlightColor),s["a"].clone(s["a"].WHITE,this._labelCollection._highlightColor),s["a"].clone(s["a"].WHITE,this._polylineCollection._highlightColor))};const A=new s["a"],w=new s["a"],j=new s["a"],E=new s["a"],L=new s["a"],D=new s["a"],N=new u["a"],B=new u["a"],k=new l["a"];I.prototype.applyStyle=function(e,t){if(!Object(r["a"])(e))return void P(this,t);const i=this._batchIds,n=i.length;for(let o=0;o<n;++o){const n=i[o],a=t[n];if(Object(r["a"])(e.show)&&(a.show=e.show.evaluate(a)),Object(r["a"])(e.pointSize)&&(a.pointSize=e.pointSize.evaluate(a)),Object(r["a"])(e.color)&&(a.color=e.color.evaluateColor(a,A)),Object(r["a"])(e.pointOutlineColor)&&(a.pointOutlineColor=e.pointOutlineColor.evaluateColor(a,w)),Object(r["a"])(e.pointOutlineWidth)&&(a.pointOutlineWidth=e.pointOutlineWidth.evaluate(a)),Object(r["a"])(e.labelColor)&&(a.labelColor=e.labelColor.evaluateColor(a,j)),Object(r["a"])(e.labelOutlineColor)&&(a.labelOutlineColor=e.labelOutlineColor.evaluateColor(a,E)),Object(r["a"])(e.labelOutlineWidth)&&(a.labelOutlineWidth=e.labelOutlineWidth.evaluate(a)),Object(r["a"])(e.font)&&(a.font=e.font.evaluate(a)),Object(r["a"])(e.labelStyle)&&(a.labelStyle=e.labelStyle.evaluate(a)),Object(r["a"])(e.labelText)?a.labelText=e.labelText.evaluate(a):a.labelText=void 0,Object(r["a"])(e.backgroundColor)&&(a.backgroundColor=e.backgroundColor.evaluateColor(a,L)),Object(r["a"])(e.backgroundPadding)&&(a.backgroundPadding=e.backgroundPadding.evaluate(a)),Object(r["a"])(e.backgroundEnabled)&&(a.backgroundEnabled=e.backgroundEnabled.evaluate(a)),Object(r["a"])(e.scaleByDistance)){const t=e.scaleByDistance.evaluate(a);N.near=t.x,N.nearValue=t.y,N.far=t.z,N.farValue=t.w,a.scaleByDistance=N}else a.scaleByDistance=void 0;if(Object(r["a"])(e.translucencyByDistance)){const t=e.translucencyByDistance.evaluate(a);B.near=t.x,B.nearValue=t.y,B.far=t.z,B.farValue=t.w,a.translucencyByDistance=B}else a.translucencyByDistance=void 0;if(Object(r["a"])(e.distanceDisplayCondition)){const t=e.distanceDisplayCondition.evaluate(a);k.near=t.x,k.far=t.y,a.distanceDisplayCondition=k}else a.distanceDisplayCondition=void 0;Object(r["a"])(e.heightOffset)&&(a.heightOffset=e.heightOffset.evaluate(a)),Object(r["a"])(e.anchorLineEnabled)&&(a.anchorLineEnabled=e.anchorLineEnabled.evaluate(a)),Object(r["a"])(e.anchorLineColor)&&(a.anchorLineColor=e.anchorLineColor.evaluateColor(a,D)),Object(r["a"])(e.image)?a.image=e.image.evaluate(a):a.image=void 0,Object(r["a"])(e.disableDepthTestDistance)&&(a.disableDepthTestDistance=e.disableDepthTestDistance.evaluate(a)),Object(r["a"])(e.horizontalOrigin)&&(a.horizontalOrigin=e.horizontalOrigin.evaluate(a)),Object(r["a"])(e.verticalOrigin)&&(a.verticalOrigin=e.verticalOrigin.evaluate(a)),Object(r["a"])(e.labelHorizontalOrigin)&&(a.labelHorizontalOrigin=e.labelHorizontalOrigin.evaluate(a)),Object(r["a"])(e.labelVerticalOrigin)&&(a.labelVerticalOrigin=e.labelVerticalOrigin.evaluate(a))}},I.prototype.update=function(e){x(this,e.mapProjection.ellipsoid),this._ready&&(this._polylineCollection.update(e),this._billboardCollection.update(e),this._labelCollection.update(e),this._resolvedPromise||(this._readyPromise.resolve(),this._resolvedPromise=!0))},I.prototype.isDestroyed=function(){return!1},I.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._polylineCollection=this._polylineCollection&&this._polylineCollection.destroy(),Object(d["a"])(this)},t["a"]=I},e288:function(e,t,i){"use strict";var n=i("670c"),o=i("be18"),a=i("bef8"),s=i("2bb9"),r=i("8dfe"),c=i("535a"),d=i("2f63"),l=i("21d7"),h=i("3d7f"),u=i("93da"),_=i("eace"),f=i("d4ed"),p=i("d3a0"),b=i("64ac");const m=/{[^}]+}/g,g={x:E,y:D,z:k,s:F,reverseX:L,reverseY:N,reverseZ:B,westDegrees:H,southDegrees:M,eastDegrees:U,northDegrees:V,westProjected:G,southProjected:z,eastProjected:Y,northProjected:Z,width:K,height:X},y=Object(s["a"])(g,{i:J,j:q,reverseI:Q,reverseJ:$,longitudeDegrees:ne,latitudeDegrees:oe,longitudeProjected:ae,latitudeProjected:se,format:de});function O(e){this._errorEvent=new l["a"],this._resource=void 0,this._urlSchemeZeroPadding=void 0,this._pickFeaturesResource=void 0,this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._minimumLevel=void 0,this._tilingScheme=void 0,this._rectangle=void 0,this._tileDiscardPolicy=void 0,this._credit=void 0,this._hasAlphaChannel=void 0,this._readyPromise=void 0,this._tags=void 0,this._pickFeaturesTags=void 0,this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this.enablePickFeatures=!0,this.reinitialize(e)}Object.defineProperties(O.prototype,{url:{get:function(){return this._resource.url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesResource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return Object(d["a"])(this._resource)}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return this._hasAlphaChannel}}}),O.prototype.reinitialize=function(e){const t=this;t._readyPromise=Promise.resolve(e).then((function(e){const i=e.customTags,n=Object(s["a"])(g,i),o=Object(s["a"])(y,i),a=f["a"].createIfNeeded(e.url),l=f["a"].createIfNeeded(e.pickFeaturesUrl);t.enablePickFeatures=Object(c["a"])(e.enablePickFeatures,t.enablePickFeatures),t._urlSchemeZeroPadding=Object(c["a"])(e.urlSchemeZeroPadding,t.urlSchemeZeroPadding),t._tileDiscardPolicy=e.tileDiscardPolicy,t._getFeatureInfoFormats=e.getFeatureInfoFormats,t._subdomains=e.subdomains,Array.isArray(t._subdomains)?t._subdomains=t._subdomains.slice():Object(d["a"])(t._subdomains)&&t._subdomains.length>0?t._subdomains=t._subdomains.split(""):t._subdomains=["a","b","c"],t._tileWidth=Object(c["a"])(e.tileWidth,256),t._tileHeight=Object(c["a"])(e.tileHeight,256),t._minimumLevel=Object(c["a"])(e.minimumLevel,0),t._maximumLevel=e.maximumLevel,t._tilingScheme=Object(c["a"])(e.tilingScheme,new p["a"]({ellipsoid:e.ellipsoid})),t._rectangle=Object(c["a"])(e.rectangle,t._tilingScheme.rectangle),t._rectangle=_["a"].intersection(t._rectangle,t._tilingScheme.rectangle),t._hasAlphaChannel=Object(c["a"])(e.hasAlphaChannel,!0);let h=e.credit;return"string"===typeof h&&(h=new r["a"](h)),t._credit=h,t._resource=a,t._tags=n,t._pickFeaturesResource=l,t._pickFeaturesTags=o,!0}))},O.prototype.getTileCredits=function(e,t,i){},O.prototype.requestImage=function(e,t,i,n){return b["a"].loadImage(this,S(this,e,t,i,n))},O.prototype.pickFeatures=function(e,t,i,n,o){if(!this.enablePickFeatures||!Object(d["a"])(this._pickFeaturesResource)||0===this._getFeatureInfoFormats.length)return;let a=0;const s=this;function r(e,t){return e.callback(t)}function c(){if(a>=s._getFeatureInfoFormats.length)return Promise.resolve([]);const d=s._getFeatureInfoFormats[a],l=w(s,e,t,i,n,o,d.format);return++a,"json"===d.type?l.fetchJson().then(d.callback).catch(c):"xml"===d.type?l.fetchXML().then(d.callback).catch(c):"text"===d.type||"html"===d.type?l.fetchText().then(d.callback).catch(c):l.fetch({responseType:d.format}).then(r.bind(void 0,d)).catch(c)}return c()};let v=!1;const I=new _["a"];let T=!1;const C=new _["a"];function S(e,t,i,n,o){v=!1,T=!1;const a=e._resource,s=a.getUrlComponent(!0),r=e._tags,c={},l=s.match(m);return Object(d["a"])(l)&&l.forEach((function(o){const a=o.substring(1,o.length-1);Object(d["a"])(r[a])&&(c[a]=r[a](e,t,i,n))})),a.getDerivedResource({request:o,templateValues:c})}let x=!1;const P=new n["a"];let A=!1;function w(e,t,i,n,o,a,s){v=!1,T=!1,x=!1,A=!1;const r=e._pickFeaturesResource,c=r.getUrlComponent(!0),l=e._pickFeaturesTags,h={},u=c.match(m);return Object(d["a"])(u)&&u.forEach((function(r){const c=r.substring(1,r.length-1);Object(d["a"])(l[c])&&(h[c]=l[c](e,t,i,n,o,a,s))})),r.getDerivedResource({templateValues:h})}function j(e,t,i){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){const n=e.urlSchemeZeroPadding[t];if("string"===typeof n){const e=n.length;e>1&&(i=i.length>=e?i:new Array(e-i.toString().length+1).join("0")+i)}}return i}function E(e,t,i,n){return j(e,"{x}",t)}function L(e,t,i,n){const o=e.tilingScheme.getNumberOfXTilesAtLevel(n)-t-1;return j(e,"{reverseX}",o)}function D(e,t,i,n){return j(e,"{y}",i)}function N(e,t,i,n){const o=e.tilingScheme.getNumberOfYTilesAtLevel(n)-i-1;return j(e,"{reverseY}",o)}function B(e,t,i,n){const o=e.maximumLevel,a=Object(d["a"])(o)&&n<o?o-n-1:n;return j(e,"{reverseZ}",a)}function k(e,t,i,n){return j(e,"{z}",n)}function F(e,t,i,n){const o=(t+i+n)%e._subdomains.length;return e._subdomains[o]}function R(e,t,i,n){v||(e.tilingScheme.tileXYToRectangle(t,i,n,I),I.west=u["a"].toDegrees(I.west),I.south=u["a"].toDegrees(I.south),I.east=u["a"].toDegrees(I.east),I.north=u["a"].toDegrees(I.north),v=!0)}function H(e,t,i,n){return R(e,t,i,n),I.west}function M(e,t,i,n){return R(e,t,i,n),I.south}function U(e,t,i,n){return R(e,t,i,n),I.east}function V(e,t,i,n){return R(e,t,i,n),I.north}function W(e,t,i,n){T||(e.tilingScheme.tileXYToNativeRectangle(t,i,n,C),T=!0)}function G(e,t,i,n){return W(e,t,i,n),C.west}function z(e,t,i,n){return W(e,t,i,n),C.south}function Y(e,t,i,n){return W(e,t,i,n),C.east}function Z(e,t,i,n){return W(e,t,i,n),C.north}function K(e,t,i,n){return e.tileWidth}function X(e,t,i,n){return e.tileHeight}function J(e,t,i,n,o,a,s){return ie(e,t,i,n,o,a),P.x}function q(e,t,i,n,o,a,s){return ie(e,t,i,n,o,a),P.y}function Q(e,t,i,n,o,a,s){return ie(e,t,i,n,o,a),e.tileWidth-P.x-1}function $(e,t,i,n,o,a,s){return ie(e,t,i,n,o,a),e.tileHeight-P.y-1}const ee=new _["a"],te=new o["a"];function ie(e,t,i,n,o,a,s){if(x)return;ce(e,t,i,n,o,a);const r=te,c=e.tilingScheme.tileXYToNativeRectangle(t,i,n,ee);P.x=e.tileWidth*(r.x-c.west)/c.width|0,P.y=e.tileHeight*(c.north-r.y)/c.height|0,x=!0}function ne(e,t,i,n,o,a,s){return u["a"].toDegrees(o)}function oe(e,t,i,n,o,a,s){return u["a"].toDegrees(a)}function ae(e,t,i,n,o,a,s){return ce(e,t,i,n,o,a),te.x}function se(e,t,i,n,o,a,s){return ce(e,t,i,n,o,a),te.y}const re=new a["a"];function ce(e,t,i,n,o,a,s){if(!A){if(e.tilingScheme.projection instanceof h["a"])te.x=u["a"].toDegrees(o),te.y=u["a"].toDegrees(a);else{const t=re;t.longitude=o,t.latitude=a,e.tilingScheme.projection.project(t,te)}A=!0}}function de(e,t,i,n,o,a,s){return s}t["a"]=O},ee05:function(e,t,i){"use strict";var n=i("77af"),o=i("bd8d"),a=i("2f63"),s=i("7d62"),r=i("e42d"),c=i("f845"),d=i("a894"),l=i("f630"),h=i("d289"),u=i("6ef5"),_=i("6dc0"),f=i("6c84"),p=i("5770"),b=i("a913"),m=i("e1f5"),g=i("6bd8"),y=i("b7c8"),O=i("3626"),v=i("6102");const I=!1;function T(e){this._drawClassificationFBO=new l["a"]({createDepthAttachments:!1}),this._accumulationFBO=new l["a"]({createDepthAttachments:!1}),this._packFBO=new l["a"],this._opaqueDepthStencilTexture=void 0,this._textureToComposite=void 0,this._translucentDepthStencilTexture=void 0,this._packDepthCommand=void 0,this._accumulateCommand=void 0,this._compositeCommand=void 0,this._copyCommand=void 0,this._clearColorCommand=new c["a"]({color:new o["a"](0,0,0,0),owner:this}),this._clearDepthStencilCommand=new c["a"]({depth:1,stencil:0,owner:this}),this._supported=e.depthTexture,this._viewport=new n["a"],this._rsDepth=void 0,this._rsAccumulate=void 0,this._rsComp=void 0,this._useScissorTest=void 0,this._scissorRectangle=void 0,this._hasTranslucentDepth=!1,this._frustumsDrawn=0}function C(e){e._textureToComposite=void 0,e._translucentDepthStencilTexture=e._translucentDepthStencilTexture&&!e._translucentDepthStencilTexture.isDestroyed()&&e._translucentDepthStencilTexture.destroy()}function S(e){e._drawClassificationFBO.destroy(),e._accumulationFBO.destroy(),e._packFBO.destroy()}function x(e,t,i,n){C(e),e._translucentDepthStencilTexture=new b["a"]({context:t,width:i,height:n,pixelFormat:r["a"].DEPTH_STENCIL,pixelDatatype:u["a"].UNSIGNED_INT_24_8,sampler:f["a"].NEAREST})}function P(e,t,i,n){S(e),e._drawClassificationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._drawClassificationFBO.update(t,i,n),e._accumulationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._accumulationFBO.update(t,i,n),e._packFBO.update(t,i,n)}function A(e,t,i,o){if(!e.isSupported())return;e._opaqueDepthStencilTexture=o;const s=e._opaqueDepthStencilTexture.width,r=e._opaqueDepthStencilTexture.height;let c,l;if(e._drawClassificationFBO.isDirty(s,r)&&(x(e,t,s,r),P(e,t,s,r)),Object(a["a"])(e._packDepthCommand)||(c=new p["a"]({sources:[m["a"]]}),l={u_opaqueDepthTexture:function(){return e._opaqueDepthStencilTexture},u_translucentDepthTexture:function(){return e._translucentDepthStencilTexture}},e._packDepthCommand=t.createViewportQuadCommand(c,{uniformMap:l,owner:e})),!Object(a["a"])(e._compositeCommand)){c=new p["a"]({sources:[g["a"]]}),l={colorTexture:function(){return e._textureToComposite}},I&&(c.defines=["DEBUG_SHOW_DEPTH"],l.u_packedTranslucentDepth=function(){return e._packFBO.getColorTexture()}),e._compositeCommand=t.createViewportQuadCommand(c,{uniformMap:l,owner:e});const i=e._compositeCommand,n=i.shaderProgram,o=t.shaderCache.createDerivedShaderProgram(n,"pick",{vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:new p["a"]({sources:c.sources,defines:["PICK"]}),attributeLocations:n._attributeLocations}),a=d["a"].shallowClone(i);a.shaderProgram=o,i.derivedCommands.pick=a}Object(a["a"])(e._copyCommand)||(c=new p["a"]({sources:[g["a"]]}),l={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._copyCommand=t.createViewportQuadCommand(c,{uniformMap:l,owner:e})),Object(a["a"])(e._accumulateCommand)||(c=new p["a"]({sources:[g["a"]]}),l={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._accumulateCommand=t.createViewportQuadCommand(c,{uniformMap:l,owner:e})),e._viewport.width=s,e._viewport.height=r;const h=!n["a"].equals(e._viewport,i.viewport);let u=h!==e._useScissorTest;e._useScissorTest=h,n["a"].equals(e._scissorRectangle,i.viewport)||(e._scissorRectangle=n["a"].clone(i.viewport,e._scissorRectangle),u=!0),Object(a["a"])(e._rsDepth)&&n["a"].equals(e._viewport,e._rsDepth.viewport)&&!u||(e._rsDepth=_["a"].fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),Object(a["a"])(e._packDepthCommand)&&(e._packDepthCommand.renderState=e._rsDepth),Object(a["a"])(e._rsAccumulate)&&n["a"].equals(e._viewport,e._rsAccumulate.viewport)&&!u||(e._rsAccumulate=_["a"].fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:v["a"].EQUAL,reference:O["a"].CESIUM_3D_TILE_MASK}})),Object(a["a"])(e._accumulateCommand)&&(e._accumulateCommand.renderState=e._rsAccumulate),Object(a["a"])(e._rsComp)&&n["a"].equals(e._viewport,e._rsComp.viewport)&&!u||(e._rsComp=_["a"].fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},blending:y["a"].ALPHA_BLEND})),Object(a["a"])(e._compositeCommand)&&(e._compositeCommand.renderState=e._rsComp,e._compositeCommand.derivedCommands.pick.renderState=e._rsComp)}function w(e,t,i){if(!e._hasTranslucentDepth)return;const n=i.framebuffer;i.framebuffer=e._drawClassificationFBO.framebuffer,e._clearColorCommand.execute(t._context,i),i.framebuffer=n,e._frustumsDrawn>1&&(i.framebuffer=e._accumulationFBO.framebuffer,e._clearColorCommand.execute(t._context,i)),e._hasTranslucentDepth=!1,e._frustumsDrawn=0}Object.defineProperties(T.prototype,{hasTranslucentDepth:{get:function(){return this._hasTranslucentDepth}}}),T.prototype.executeTranslucentCommands=function(e,t,i,n,o){const a=n.length;let s,r;const c=e.frameState.useLogDepth,d=e.context,l=i.framebuffer;for(r=0;r<a;++r)if(s=n[r],s=c?s.derivedCommands.logDepth.command:s,s.depthForTranslucentClassification){this._hasTranslucentDepth=!0;break}if(this._hasTranslucentDepth){for(A(this,d,i,o),i.framebuffer=this._drawClassificationFBO.framebuffer,this._clearDepthStencilCommand.execute(d,i),r=0;r<a;++r){if(s=n[r],s=c?s.derivedCommands.logDepth.command:s,!s.depthForTranslucentClassification)continue;const o=s.derivedCommands.depth.depthOnlyCommand;t(o,e,d,i)}this._frustumsDrawn+=this._hasTranslucentDepth?1:0,this._hasTranslucentDepth&&(i.framebuffer=this._packFBO.framebuffer,this._packDepthCommand.execute(d,i)),i.framebuffer=l}},T.prototype.executeClassificationCommands=function(e,t,i,n){if(!this._hasTranslucentDepth)return;const o=e.context,a=o.uniformState,s=i.framebuffer;2===this._frustumsDrawn&&(i.framebuffer=this._accumulationFBO.framebuffer,this._copyCommand.execute(o,i)),i.framebuffer=this._drawClassificationFBO.framebuffer,this._frustumsDrawn>1&&this._clearColorCommand.execute(o,i),a.updatePass(h["a"].CESIUM_3D_TILE_CLASSIFICATION);const r=a.globeDepthTexture;a.globeDepthTexture=this._packFBO.getColorTexture();const c=n.commands[h["a"].CESIUM_3D_TILE_CLASSIFICATION],d=n.indices[h["a"].CESIUM_3D_TILE_CLASSIFICATION];for(let l=0;l<d;++l)t(c[l],e,o,i);a.globeDepthTexture=r,i.framebuffer=s,1!==this._frustumsDrawn&&(i.framebuffer=this._accumulationFBO.framebuffer,this._accumulateCommand.execute(o,i),i.framebuffer=s)},T.prototype.execute=function(e,t){if(!this._hasTranslucentDepth)return;1===this._frustumsDrawn?this._textureToComposite=this._drawClassificationFBO.getColorTexture():this._textureToComposite=this._accumulationFBO.getColorTexture();const i=e.frameState.passes.pick?this._compositeCommand.derivedCommands.pick:this._compositeCommand;i.execute(e.context,t),w(this,e,t)},T.prototype.isSupported=function(){return this._supported},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return C(this),S(this),Object(a["a"])(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),Object(a["a"])(this._packDepthCommand)&&(this._packDepthCommand.shaderProgram=this._packDepthCommand.shaderProgram&&this._packDepthCommand.shaderProgram.destroy()),Object(s["a"])(this)},t["a"]=T}}]);