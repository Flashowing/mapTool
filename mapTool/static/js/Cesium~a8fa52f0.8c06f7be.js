(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~a8fa52f0"],{ce35:function(e,t,n){"use strict";var i=n("cef5"),a=n("be18"),r=n("a561"),o=n("bef8"),s=n("dc1c"),c=n("bd8d"),u=n("2bb9"),l=n("71ce"),d=n("8dfe"),h=n("535a"),m=n("9c35"),f=n("2f63"),g=n("45c5"),_=n("7d62"),p=n("aee6"),b=n("5e57"),x=n("a734"),y=n("e856"),O=n("974b"),S=n("129b"),C=n("0123"),R=n("8bd8"),w=n("d69d"),j=n("7ceb"),E=n("93da"),M=n("df07"),v=n("52f0"),T=n("e42d"),L=n("1b8d"),A=n("0260"),P=n("d4ed"),B=n("f806"),I=n("daa2"),N=n("f20a"),D=n("8b68"),F=n("a894"),U=n("d289"),k=n("6dc0"),z=n("6c84"),V=n("e90c"),q=n("5770"),H=n("a913"),G=n("03f1"),W=n("23b6"),K=n("7c5e"),Z=n("555f"),$=n("0523"),J=n("9937"),Y=n("c293"),X=n("352a"),Q=n("8586"),ee=n("89f5"),te=n("bc46"),ne=n("b08e"),ie=n("b7c8"),ae=n("43ee"),re=n("c1f7"),oe=n("06f0"),se=n("08b8"),ce=n("d663"),ue=n("0249"),le=n("2d75"),de=n("568a"),he=n("fbf1"),me=n("442b"),fe=n("6289"),ge=n("1195"),_e=n("e1d8"),pe=n("e8d6"),be=n("5128"),xe=n("e349"),ye=n("1b40"),Oe=n("082a"),Se=n("d007"),Ce=n("a307"),Re=n("c86b"),we=n("3de6"),je=n("b85c"),Ee=n("3626");const Me=new a["a"],ve=xe["a"].ModelState,Te="model/gltf-binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01",Le=E["a"].EPSILON16;function Ae(e,t){e._cachedGltf=t}function Pe(e){this._gltf=e.gltf,this.ready=e.ready,this.modelsToLoad=[],this.count=0}Object.defineProperties(Pe.prototype,{gltf:{set:function(e){this._gltf=e},get:function(){return this._gltf}}}),Pe.prototype.makeReady=function(e){this.gltf=e;const t=this.modelsToLoad,n=t.length;for(let i=0;i<n;++i){const e=t[i];e.isDestroyed()||Ae(e,this)}this.modelsToLoad=void 0,this.ready=!0};const Be={},Ie={};function Ne(e){e=Object(h["a"])(e,h["a"].EMPTY_OBJECT);const t=e.cacheKey;let n;if(this._cacheKey=t,this._cachedGltf=void 0,this._releaseGltfJson=Object(h["a"])(e.releaseGltfJson,!1),Object(f["a"])(t)&&Object(f["a"])(Be[t])&&Be[t].ready)n=Be[t],++n.count;else{let i=e.gltf;if(Object(f["a"])(i)){if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),i instanceof Uint8Array){const e=Object(ee["a"])(i);n=new Pe({gltf:e,ready:!0})}else n=new Pe({gltf:e.gltf,ready:!0});n.count=1,Object(f["a"])(t)&&(Be[t]=n)}}Ae(this,n);const r=Object(h["a"])(e.basePath,"");this._resource=P["a"].createIfNeeded(r);let o=e.credit;"string"===typeof o&&(o=new d["a"](o)),this._credit=o,this._resourceCredits=[],this._gltfCredits=[],this._showCreditsOnScreen=Object(h["a"])(e.showCreditsOnScreen,!1),this.show=Object(h["a"])(e.show,!0),this.silhouetteColor=Object(h["a"])(e.silhouetteColor,c["a"].RED),this._silhouetteColor=new c["a"],this._silhouetteColorPreviousAlpha=1,this._normalAttributeName=void 0,this.silhouetteSize=Object(h["a"])(e.silhouetteSize,0),this.modelMatrix=v["a"].clone(Object(h["a"])(e.modelMatrix,v["a"].IDENTITY)),this._modelMatrix=v["a"].clone(this.modelMatrix),this._clampedModelMatrix=void 0,this.scale=Object(h["a"])(e.scale,1),this._scale=this.scale,this.minimumPixelSize=Object(h["a"])(e.minimumPixelSize,0),this._minimumPixelSize=this.minimumPixelSize,this.maximumScale=e.maximumScale,this._maximumScale=this.maximumScale,this.id=e.id,this._id=e.id,this.heightReference=Object(h["a"])(e.heightReference,le["a"].NONE),this._heightReference=this.heightReference,this._heightChanged=!1,this._removeUpdateHeightCallback=void 0;const s=e.scene;this._scene=s,Object(f["a"])(s)&&Object(f["a"])(s.terrainProviderChanged)&&(this._terrainProviderChangedCallback=s.terrainProviderChanged.addEventListener((function(){this._heightChanged=!0}),this)),this._pickObject=e.pickObject,this._allowPicking=Object(h["a"])(e.allowPicking,!0),this._ready=!1,this._readyPromise=Object(m["a"])(),this.activeAnimations=new me["a"](this),this.clampAnimations=Object(h["a"])(e.clampAnimations,!0),this._defaultTexture=void 0,this._incrementallyLoadTextures=Object(h["a"])(e.incrementallyLoadTextures,!0),this._asynchronous=Object(h["a"])(e.asynchronous,!0),this.shadows=Object(h["a"])(e.shadows,Re["a"].ENABLED),this._shadows=this.shadows,this.color=c["a"].clone(Object(h["a"])(e.color,c["a"].WHITE)),this._colorPreviousAlpha=1,this.colorBlendMode=Object(h["a"])(e.colorBlendMode,re["a"].HIGHLIGHT),this.colorBlendAmount=Object(h["a"])(e.colorBlendAmount,.5),this._colorShadingEnabled=!1,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._clippingPlanesState=0,this.referenceMatrix=void 0,this.backFaceCulling=Object(h["a"])(e.backFaceCulling,!0),this.showOutline=Object(h["a"])(e.showOutline,!0),this.splitDirection=Object(h["a"])(e.splitDirection,we["a"].NONE),this._splittingEnabled=!1,this.debugShowBoundingVolume=Object(h["a"])(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=Object(h["a"])(e.debugWireframe,!1),this._debugWireframe=!1,this._distanceDisplayCondition=e.distanceDisplayCondition,this._addBatchIdToGeneratedShaders=e.addBatchIdToGeneratedShaders,this._precreatedAttributes=e.precreatedAttributes,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickIdLoaded=e.pickIdLoaded,this._ignoreCommands=Object(h["a"])(e.ignoreCommands,!1),this._requestType=e.requestType,this._upAxis=Object(h["a"])(e.upAxis,ne["a"].Y),this._gltfForwardAxis=ne["a"].Z,this._forwardAxis=e.forwardAxis,this.cull=Object(h["a"])(e.cull,!0),this.opaquePass=Object(h["a"])(e.opaquePass,U["a"].OPAQUE),this._computedModelMatrix=new v["a"],this._clippingPlanesMatrix=v["a"].clone(v["a"].IDENTITY),this._iblReferenceFrameMatrix=M["a"].clone(M["a"].IDENTITY),this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new i["a"],this._state=ve.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._perNodeShowDirty=!1,this._cesiumAnimationsDirty=!1,this._dirty=!1,this._maxDirtyNumber=0,this._runtime={animations:void 0,articulationsByName:void 0,articulationsByStageKey:void 0,stagesByKey:void 0,rootNodes:void 0,nodes:void 0,nodesByName:void 0,skinnedNodes:void 0,meshesByName:void 0,materialsByName:void 0,materialsById:void 0},this._uniformMaps={},this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms={},this._programPrimitives={},this._rendererResources={buffers:{},vertexArrays:{},programs:{},sourceShaders:{},silhouettePrograms:{},textures:{},samplers:{},renderStates:{}},this._cachedRendererResources=void 0,this._loadRendererResourcesFromCache=!1,this._dequantizeInShader=Object(h["a"])(e.dequantizeInShader,!0),this._decodedData={},this._cachedGeometryByteLength=0,this._cachedTexturesByteLength=0,this._geometryByteLength=0,this._texturesByteLength=0,this._trianglesLength=0,this._pointsLength=0,this._sourceTechniques={},this._sourcePrograms={},this._quantizedVertexShaders={},this._nodeCommands=[],this._pickIds=[],this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0,this._sourceVersion=void 0,this._sourceKHRTechniquesWebGL=void 0,this._lightColor=a["a"].clone(e.lightColor);const u=Object(f["a"])(e.imageBasedLightingFactor)||Object(f["a"])(e.luminanceAtZenith)||Object(f["a"])(e.sphericalHarmonicCoefficients)||Object(f["a"])(e.specularEnvironmentMaps);Object(f["a"])(e.imageBasedLighting)?(this._imageBasedLighting=e.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):u?(Object(g["a"])("ImageBasedLightingConstructor","Individual image-based lighting parameters were deprecated in Cesium 1.92. They will be removed in version 1.94. Use options.imageBasedLighting instead."),this._imageBasedLighting=new R["a"]({imageBasedLightingFactor:e.imageBasedLightingFactor,luminanceAtZenith:e.luminanceAtZenith,sphericalHarmonicCoefficients:e.sphericalHarmonicCoefficients,specularEnvironmentMaps:e.specularEnvironmentMaps}),this._shouldDestroyImageBasedLighting=!0):(this._imageBasedLighting=new R["a"],this._shouldDestroyImageBasedLighting=!0),this._shouldRegenerateShaders=!1}function De(e){return e.stencilBuffer}function Fe(e){return!c["a"].equals(e.color,c["a"].WHITE)||e.colorBlendMode!==re["a"].HIGHLIGHT}function Ue(e){const t=e._clippingPlanes;return Object(f["a"])(t)&&t.enabled&&0!==t.length}function ke(e){const t=Object(O["a"])(e);return"glTF"===t}function ze(e,t,n){return e._runtime[t][n]}Object.defineProperties(Ne.prototype,{gltf:{get:function(){return Object(f["a"])(this._cachedGltf)?this._cachedGltf.gltf:void 0}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return this._resource.url}},boundingSphere:{get:function(){let e=this.modelMatrix;this.heightReference!==le["a"].NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);const t=v["a"].getScale(e,Me),n=Object(f["a"])(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;a["a"].multiplyByScalar(t,n,t);const i=this._scaledBoundingSphere;return i.center=a["a"].multiplyComponents(this._boundingSphere.center,t,i.center),i.radius=a["a"].maximumComponent(t)*this._initialRadius,Object(f["a"])(this._rtcCenter)&&a["a"].add(this._rtcCenter,i.center,i.center),i}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return Object(f["a"])(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=p["a"].clone(e,this._distanceDisplayCondition)}},extensionsUsed:{get:function(){return Object(f["a"])(this._extensionsUsed)||(this._extensionsUsed=xe["a"].getUsedExtensions(this.gltf)),this._extensionsUsed}},extensionsRequired:{get:function(){return Object(f["a"])(this._extensionsRequired)||(this._extensionsRequired=xe["a"].getRequiredExtensions(this.gltf)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},forwardAxis:{get:function(){return Object(f["a"])(this._forwardAxis)?this._forwardAxis:this._gltfForwardAxis}},trianglesLength:{get:function(){return this._trianglesLength}},pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return this._texturesByteLength}},cachedGeometryByteLength:{get:function(){return this._cachedGeometryByteLength}},cachedTexturesByteLength:{get:function(){return this._cachedTexturesByteLength}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&ae["a"].setOwner(e,this,"_clippingPlanes")}},pickIds:{get:function(){return this._pickIds}},lightColor:{get:function(){return this._lightColor},set:function(e){const t=this._lightColor;e===t||a["a"].equals(e,t)||(this._shouldRegenerateShaders=this._shouldRegenerateShaders||Object(f["a"])(t)&&!Object(f["a"])(e)||Object(f["a"])(e)&&!Object(f["a"])(t),this._lightColor=a["a"].clone(e,t))}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1,this._shouldRegenerateShaders=!0)}},imageBasedLightingFactor:{get:function(){return this._imageBasedLighting.imageBasedLightingFactor},set:function(e){this._imageBasedLighting.imageBasedLightingFactor=e}},luminanceAtZenith:{get:function(){return this._imageBasedLighting.luminanceAtZenith},set:function(e){this._imageBasedLighting.luminanceAtZenith=e}},sphericalHarmonicCoefficients:{get:function(){return this._imageBasedLighting.sphericalHarmonicCoefficients},set:function(e){this._imageBasedLighting.sphericalHarmonicCoefficients=e}},specularEnvironmentMaps:{get:function(){return this._imageBasedLighting.specularEnvironmentMaps},set:function(e){this._imageBasedLighting.specularEnvironmentMaps=e}},credit:{get:function(){return this._credit}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){if(this._showCreditsOnScreen!==e){Object(f["a"])(this._credit)&&(this._credit.showOnScreen=e);const t=this._resourceCredits.length;for(let i=0;i<t;i++)this._resourceCredits[i].showOnScreen=e;const n=this._gltfCredits.length;for(let i=0;i<n;i++)this._gltfCredits[i].showOnScreen=e}this._showCreditsOnScreen=e}}}),Ne.silhouetteSupported=function(e){return De(e.context)},Ne.fromGltf=function(e){const t=e.url;e=Object(s["a"])(e);const n=P["a"].createIfNeeded(t),i=Object(h["a"])(e.basePath,n.clone()),a=P["a"].createIfNeeded(i);let r=Object(h["a"])(e.cacheKey,Ie[Object(x["a"])(n.url)]);Object(f["a"])(r)||(r=Object(l["a"])(),Ie[Object(x["a"])(n.url)]=r),Object(f["a"])(e.basePath)&&!Object(f["a"])(e.cacheKey)&&(r+=a.url),e.cacheKey=r,e.basePath=a;const o=new Ne(e);let c=Be[r];return Object(f["a"])(c)?c.ready||(++c.count,c.modelsToLoad.push(o)):(c=new Pe({ready:!1}),c.count=1,c.modelsToLoad.push(o),Ae(o,c),Be[r]=c,Object(f["a"])(n.headers.Accept)||(n.headers.Accept=Te),n.fetchArrayBuffer().then((function(e){const t=new Uint8Array(e);if(ke(t)){const e=Object(ee["a"])(t);c.makeReady(e)}else{const e=Object(y["a"])(t);c.makeReady(e)}const i=o._resourceCredits,a=n.credits;if(Object(f["a"])(a)){const e=a.length;for(let t=0;t<e;t++)i.push(a[t])}})).catch(xe["a"].getFailedLoadFunction(o,"model",n.url))),o},Ne._gltfCache=Be,Ne.prototype.getNode=function(e){const t=ze(this,"nodesByName",e);return Object(f["a"])(t)?t.publicNode:void 0},Ne.prototype.getMesh=function(e){return ze(this,"meshesByName",e)},Ne.prototype.getMaterial=function(e){return ze(this,"materialsByName",e)},Ne.prototype.setArticulationStage=function(e,t){const n=ze(this,"stagesByKey",e),i=ze(this,"articulationsByStageKey",e);Object(f["a"])(n)&&Object(f["a"])(i)&&(t=E["a"].clamp(t,n.minimumValue,n.maximumValue),E["a"].equalsEpsilon(n.currentValue,t,Le)||(n.currentValue=t,i.isDirty=!0))};const Ve=new a["a"],qe=new M["a"];function He(e,t){const n=e.currentValue,i=Ve;let a;switch(e.type){case"xRotate":a=M["a"].fromRotationX(E["a"].toRadians(n),qe),v["a"].multiplyByMatrix3(t,a,t);break;case"yRotate":a=M["a"].fromRotationY(E["a"].toRadians(n),qe),v["a"].multiplyByMatrix3(t,a,t);break;case"zRotate":a=M["a"].fromRotationZ(E["a"].toRadians(n),qe),v["a"].multiplyByMatrix3(t,a,t);break;case"xTranslate":i.x=n,i.y=0,i.z=0,v["a"].multiplyByTranslation(t,i,t);break;case"yTranslate":i.x=0,i.y=n,i.z=0,v["a"].multiplyByTranslation(t,i,t);break;case"zTranslate":i.x=0,i.y=0,i.z=n,v["a"].multiplyByTranslation(t,i,t);break;case"xScale":i.x=n,i.y=1,i.z=1,v["a"].multiplyByScale(t,i,t);break;case"yScale":i.x=1,i.y=n,i.z=1,v["a"].multiplyByScale(t,i,t);break;case"zScale":i.x=1,i.y=1,i.z=n,v["a"].multiplyByScale(t,i,t);break;case"uniformScale":v["a"].multiplyByUniformScale(t,n,t);break;default:break}return t}const Ge=new v["a"];function We(e){const t=e.gltf,n=e._loadResources;J["a"].buffer(t,(function(e,t){n.buffers[t]=e.extras._pipeline.source}))}function Ke(e,t){return function(n){const i=e._loadResources,a=new Uint8Array(n);--i.pendingBufferLoads,e.gltf.buffers[t].extras._pipeline.source=a}}function Ze(e){const t=e.gltf.bufferViews,n=e._loadResources.vertexBuffersToCreate;J["a"].bufferView(e.gltf,(function(e,t){e.target===I["a"].ARRAY_BUFFER&&n.enqueue(t)}));const i=e._loadResources.indexBuffersToCreate,a={};J["a"].accessor(e.gltf,(function(e){const n=e.bufferView;if(!Object(f["a"])(n))return;const r=t[n];r.target!==I["a"].ELEMENT_ARRAY_BUFFER||Object(f["a"])(a[n])||(a[n]=!0,i.enqueue({id:n,componentType:e.componentType}))}))}function $e(e){const t=e.gltf;if(!Object(X["a"])(t,"KHR_techniques_webgl"))return;const n=e._sourcePrograms,i=e._sourceTechniques,a=t.extensions.KHR_techniques_webgl.programs;J["a"].technique(t,(function(e,t){i[t]=Object(s["a"])(e);const r=e.program;Object(f["a"])(n[r])||(n[r]=Object(s["a"])(a[r]))}))}function Je(e,t,n){return function(i){const a=e._loadResources;a.shaders[n]={source:i,type:t,bufferView:void 0},--a.pendingShaderLoads,e._rendererResources.sourceShaders[n]=i}}function Ye(e){const t=e.gltf,n=t.buffers,i=t.bufferViews,a=e._rendererResources.sourceShaders;J["a"].shader(t,(function(t,r){if(Object(f["a"])(t.bufferView)){const e=t.bufferView,o=i[e],s=o.buffer,c=n[s],u=Object(S["a"])(c.extras._pipeline.source,o.byteOffset,o.byteLength);a[r]=u}else if(Object(f["a"])(t.extras._pipeline.source))a[r]=t.extras._pipeline.source;else{++e._loadResources.pendingShaderLoads;const n=e._resource.getDerivedResource({url:t.uri});n.fetchText().then(Je(e,t.type,r)).catch(xe["a"].getFailedLoadFunction(e,"shader",n.url))}}))}function Xe(e){const t=e._sourceTechniques;for(const n in t)if(t.hasOwnProperty(n)){const i=t[n];e._loadResources.programsToCreate.enqueue({programId:i.program,techniqueId:n})}}function Qe(e){const t={},n={},i={};e._runtime.articulationsByName=t,e._runtime.articulationsByStageKey=n,e._runtime.stagesByKey=i;const a=e.gltf;if(!Object(X["a"])(a,"AGI_articulations")||!Object(f["a"])(a.extensions)||!Object(f["a"])(a.extensions.AGI_articulations))return;const r=a.extensions.AGI_articulations.articulations;if(!Object(f["a"])(r))return;const o=r.length;for(let c=0;c<o;++c){const e=Object(s["a"])(r[c]);e.nodes=[],e.isDirty=!0,t[e.name]=e;const a=e.stages.length;for(let t=0;t<a;++t){const a=e.stages[t];a.currentValue=a.initialValue;const r=`${e.name} ${a.name}`;n[r]=e,i[r]=a}}}function et(e,t){return function(n){const i=e._loadResources;let a;--i.pendingTextureLoads,Array.isArray(n)&&(a=n.slice(1,n.length).map((function(e){return e.bufferView})),n=n[0]),i.texturesToCreate.enqueue({id:t,image:n,bufferView:n.bufferView,width:n.width,height:n.height,internalFormat:n.internalFormat,mipLevels:a})}}Ne.prototype.applyArticulations=function(){const e=this._runtime.articulationsByName;for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];if(n.isDirty){n.isDirty=!1;const e=n.nodes.length;for(let t=0;t<e;++t){const e=n.nodes[t];let i=v["a"].clone(e.originalMatrix,Ge);const a=n.stages.length;for(let t=0;t<a;++t){const e=n.stages[t];i=He(e,i)}e.matrix=i}}}};const tt=/(^data:image\/ktx2)|(\.ktx2$)/i;function nt(e,t,n){const i=e.gltf,a=i.images;let r;J["a"].texture(i,(function(i,o){let s=i.source;Object(f["a"])(i.extensions)&&Object(f["a"])(i.extensions.EXT_texture_webp)&&n?s=i.extensions.EXT_texture_webp.source:Object(f["a"])(i.extensions)&&Object(f["a"])(i.extensions.KHR_texture_basisu)&&t.supportsBasis&&(s=i.extensions.KHR_texture_basisu.source);const c=a[s],u=c.bufferView,l=c.mimeType;if(r=c.uri,Object(f["a"])(u))e._loadResources.texturesToCreateFromBufferView.enqueue({id:o,image:void 0,bufferView:u,mimeType:l});else{++e._loadResources.pendingTextureLoads;const t=e._resource.getDerivedResource({url:r});let n;n=tt.test(r)?Object(j["a"])(t):t.fetchImage({skipColorSpaceConversion:!0,preferImageBitmap:!0}),n.then(et(e,o,s)).catch(xe["a"].getFailedLoadFunction(e,"image",t.url))}}))}const it=new v["a"];function at(e){const t={},n={},i=[],a=e._loadResources.skinnedNodesIds,r=e._runtime.articulationsByName;J["a"].node(e.gltf,(function(o,s){const c={matrix:void 0,translation:void 0,rotation:void 0,scale:void 0,computedShow:!0,transformToRoot:new v["a"],computedMatrix:new v["a"],dirtyNumber:0,commands:[],inverseBindMatrices:void 0,bindShapeMatrix:void 0,joints:[],computedJointMatrices:[],jointName:o.jointName,weights:[],children:[],parents:[],publicNode:void 0};if(c.publicNode=new pe["a"](e,o,c,s,xe["a"].getTransform(o)),t[s]=c,n[o.name]=c,Object(f["a"])(o.skin)&&(a.push(s),i.push(c)),Object(f["a"])(o.extensions)&&Object(f["a"])(o.extensions.AGI_articulations)){const e=o.extensions.AGI_articulations.articulationName;if(Object(f["a"])(e)){let t=v["a"].clone(c.publicNode.originalMatrix,it);const n=r[e];n.nodes.push(c.publicNode);const i=n.stages.length;for(let e=0;e<i;++e){const i=n.stages[e];t=He(i,t)}c.publicNode.matrix=t}}})),e._runtime.nodes=t,e._runtime.nodesByName=n,e._runtime.skinnedNodes=i}function rt(e){const t=e.gltf,n=e._sourceTechniques,i={},a={},r=e._uniformMaps;J["a"].material(t,(function(t,o){r[o]={uniformMap:void 0,values:void 0,jointMatrixUniformName:void 0,morphWeightsUniformName:void 0};const c=new ge["a"](e,t,o);if(Object(f["a"])(t.extensions)&&Object(f["a"])(t.extensions.KHR_techniques_webgl)){const e=t.extensions.KHR_techniques_webgl.technique;c._technique=e,c._program=n[e].program,J["a"].materialValue(t,(function(e,t){Object(f["a"])(c._values)||(c._values={}),c._values[t]=Object(s["a"])(e)}))}i[t.name]=c,a[o]=c})),e._runtime.materialsByName=i,e._runtime.materialsById=a}function ot(e){const t={},n=e._runtime.materialsById;J["a"].mesh(e.gltf,(function(i,a){t[i.name]=new _e["a"](i,n,a),(Object(f["a"])(e.extensionsUsed.WEB3D_quantized_attributes)||e._dequantizeInShader)&&J["a"].meshPrimitive(i,(function(t,n){const i=gt(e,t);let r=e._programPrimitives[i];Object(f["a"])(r)||(r={},e._programPrimitives[i]=r),r[`${a}.primitive.${n}`]=t}))})),e._runtime.meshesByName=t}function st(e){const t=e.gltf.asset,n=t.copyright;if(!Object(f["a"])(n))return;const i=e._showCreditsOnScreen,a=n.split(";").map((function(e){return new d["a"](e.trim(),i)}));e._gltfCredits=a}const ct=function(){this.id=void 0,this.model=void 0,this.context=void 0};function ut(e,t,n){const i=t._loadResources,a=t.gltf.bufferViews;let r=a[e];Object(f["a"])(r)||(r=i.createdBufferViews[e]);const o=N["a"].createVertexBuffer({context:n,typedArray:i.getBuffer(r),usage:D["a"].STATIC_DRAW});o.vertexArrayDestroyable=!1,t._rendererResources.buffers[e]=o,t._geometryByteLength+=o.sizeInBytes}ct.prototype.set=function(e,t,n){this.id=e,this.model=t,this.context=n},ct.prototype.execute=function(){ut(this.id,this.model,this.context)};const lt=function(){this.id=void 0,this.componentType=void 0,this.model=void 0,this.context=void 0};function dt(e,t,n,i){const a=n._loadResources,r=n.gltf.bufferViews;let o=r[e];Object(f["a"])(o)||(o=a.createdBufferViews[e]);const s=N["a"].createIndexBuffer({context:i,typedArray:a.getBuffer(o),usage:D["a"].STATIC_DRAW,indexDatatype:t});s.vertexArrayDestroyable=!1,n._rendererResources.buffers[e]=s,n._geometryByteLength+=s.sizeInBytes}lt.prototype.set=function(e,t,n,i){this.id=e,this.componentType=t,this.model=n,this.context=i},lt.prototype.execute=function(){dt(this.id,this.componentType,this.model,this.context)};const ht=new ct,mt=new lt;function ft(e,t){const n=e._loadResources;if(0!==n.pendingBufferLoads)return;const i=t.context,a=n.vertexBuffersToCreate,r=n.indexBuffersToCreate;let o;if(e.asynchronous){while(a.length>0){if(ht.set(a.peek(),e,i),!t.jobScheduler.execute(ht,de["a"].BUFFER))break;a.dequeue()}while(r.length>0){if(o=r.peek(),mt.set(o.id,o.componentType,e,i),!t.jobScheduler.execute(mt,de["a"].BUFFER))break;r.dequeue()}}else{while(a.length>0)ut(a.dequeue(),e,i);while(r.length>0)o=r.dequeue(),dt(o.id,o.componentType,e,i)}}function gt(e,t){const n=e._runtime.materialsById[t.material];if(Object(f["a"])(n))return n._program}function _t(e,t,n){let i;const a=n._programPrimitives[t];if(!Object(f["a"])(a))return e;let r,o;for(r in a)if(a.hasOwnProperty(r)&&(i=a[r],gt(n,i)===t))break;if(n._programPrimitives[t]=void 0,n.extensionsUsed.WEB3D_quantized_attributes)o=xe["a"].modifyShaderForQuantizedAttributes(n.gltf,i,e),n._quantizedUniforms[t]=o.uniforms;else{const t=n._decodedData[r];if(!Object(f["a"])(t))return e;o=xe["a"].modifyShaderForDracoQuantizedAttributes(n.gltf,i,e,t.attributes)}return o.shader}function pt(e){return e=q["a"].replaceMain(e,"gltf_blend_main"),e+="uniform vec4 gltf_color; \nuniform float gltf_colorBlend; \nvoid main() \n{ \n    gltf_blend_main(); \n    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); \n    float highlight = ceil(gltf_colorBlend); \n    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); \n    gl_FragColor.a *= gltf_color.a; \n} \n",e}function bt(e,t,n){return Object(f["a"])(n)&&(e=n(e,t)),e}const xt=function(){this.programToCreate=void 0,this.model=void 0,this.context=void 0};function yt(e,t,n){const i=e.programId,a=e.techniqueId,r=t._sourcePrograms[i],o=t._rendererResources.sourceShaders;let s=o[r.vertexShader];const c=o[r.fragmentShader],u=t._quantizedVertexShaders;if(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader){let e=u[i];Object(f["a"])(e)||(e=_t(s,i,t),u[i]=e),s=e}const l=bt(s,i,t._vertexShaderLoaded);let d=bt(c,i,t._fragmentShaderLoaded);Object(f["a"])(t._uniformMapLoaded)||(d="uniform vec4 czm_pickColor;\n"+d);const h=t._imageBasedLighting,m=h.enabled;if(m&&(d="#define USE_IBL_LIGHTING \n\n"+d),Object(f["a"])(t._lightColor)&&(d="#define USE_CUSTOM_LIGHT_COLOR \n\n"+d),("2.0"!==t._sourceVersion||t._sourceKHRTechniquesWebGL)&&(d=q["a"].replaceMain(d,"non_gamma_corrected_main"),d+="\nvoid main() { \n    non_gamma_corrected_main(); \n    gl_FragColor = czm_gammaCorrect(gl_FragColor); \n} \n"),ye["a"].isSupported(n)){const e=h.useSphericalHarmonicCoefficients,t=h.useSpecularEnvironmentMaps,n=e||t||m;n&&(d="uniform mat3 gltf_iblReferenceFrameMatrix; \n"+d),Object(f["a"])(h.sphericalHarmonicCoefficients)?d="#define DIFFUSE_IBL \n#define CUSTOM_SPHERICAL_HARMONICS \nuniform vec3 gltf_sphericalHarmonicCoefficients[9]; \n"+d:h.useDefaultSphericalHarmonics&&(d="#define DIFFUSE_IBL \n"+d),Object(f["a"])(h.specularEnvironmentMapAtlas)&&h.specularEnvironmentMapAtlas.ready?d="#define SPECULAR_IBL \n#define CUSTOM_SPECULAR_IBL \nuniform sampler2D gltf_specularMap; \nuniform vec2 gltf_specularMapSize; \nuniform float gltf_maxSpecularLOD; \n"+d:h.useDefaultSpecularMaps&&(d="#define SPECULAR_IBL \n"+d)}Object(f["a"])(h.luminanceAtZenith)&&(d="#define USE_SUN_LUMINANCE \nuniform float gltf_luminanceAtZenith;\n"+d),St(i,a,d,l,t,n)}function Ot(e,t,n){const i=e.programId,a=e.techniqueId,r=t._sourcePrograms[i],o=t._rendererResources.sourceShaders,s=t._quantizedVertexShaders,c=t.clippingPlanes,u=Ue(t);let l=o[r.vertexShader];const d=o[r.fragmentShader];(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader)&&(l=s[i]);let h=d;Fe(t)&&(h=Ne._modifyShaderForColor(h)),u&&(h=Hn(h,c,n)),t.splitDirection!==we["a"].NONE&&(h=je["a"].modifyFragmentShader(h));const m=bt(l,i,t._vertexShaderLoaded);let g=bt(h,i,t._fragmentShaderLoaded);Object(f["a"])(t._uniformMapLoaded)||(g="uniform vec4 czm_pickColor;\n"+g);const _=t._imageBasedLighting,p=_.enabled;if(p&&(g="#define USE_IBL_LIGHTING \n\n"+g),Object(f["a"])(t._lightColor)&&(g="#define USE_CUSTOM_LIGHT_COLOR \n\n"+g),("2.0"!==t._sourceVersion||t._sourceKHRTechniquesWebGL)&&(g=q["a"].replaceMain(g,"non_gamma_corrected_main"),g+="\nvoid main() { \n    non_gamma_corrected_main(); \n    gl_FragColor = czm_gammaCorrect(gl_FragColor); \n} \n"),ye["a"].isSupported(n)){const e=_.useSphericalHarmonicCoefficients,t=_.useSpecularEnvironmentMaps,n=e||t||p;n&&(g="uniform mat3 gltf_iblReferenceFrameMatrix; \n"+g),Object(f["a"])(_.sphericalHarmonicCoefficients)?g="#define DIFFUSE_IBL \n#define CUSTOM_SPHERICAL_HARMONICS \nuniform vec3 gltf_sphericalHarmonicCoefficients[9]; \n"+g:_.useDefaultSphericalHarmonics&&(g="#define DIFFUSE_IBL \n"+g),Object(f["a"])(_.specularEnvironmentMapAtlas)&&_.specularEnvironmentMapAtlas.ready?g="#define SPECULAR_IBL \n#define CUSTOM_SPECULAR_IBL \nuniform sampler2D gltf_specularMap; \nuniform vec2 gltf_specularMapSize; \nuniform float gltf_maxSpecularLOD; \n"+g:_.useDefaultSpecularMaps&&(g="#define SPECULAR_IBL \n"+g)}Object(f["a"])(_.luminanceAtZenith)&&(g="#define USE_SUN_LUMINANCE \nuniform float gltf_luminanceAtZenith;\n"+g),St(i,a,g,m,t,n)}function St(e,t,n,i,a,r){const o=a._sourceTechniques[t],s=xe["a"].createAttributeLocations(o,a._precreatedAttributes);a._rendererResources.programs[e]=V["a"].fromCache({context:r,vertexShaderSource:i,fragmentShaderSource:n,attributeLocations:s})}xt.prototype.set=function(e,t,n){this.programToCreate=e,this.model=t,this.context=n},xt.prototype.execute=function(){yt(this.programToCreate,this.model,this.context)};const Ct=new xt;function Rt(e,t){const n=e._loadResources,i=n.programsToCreate;if(0!==n.pendingShaderLoads)return;if(0!==n.pendingBufferLoads)return;const a=t.context;if(e.asynchronous)while(i.length>0){if(Ct.set(i.peek(),e,a),!t.jobScheduler.execute(Ct,de["a"].PROGRAM))break;i.dequeue()}else while(i.length>0)yt(i.dequeue(),e,a)}function wt(e,t){return function(n){e.texturesToCreate.enqueue({id:t.id,image:n,bufferView:void 0}),--e.pendingBufferViewToImage}}function jt(e){const t=e._loadResources;if(0===t.pendingBufferLoads)while(t.texturesToCreateFromBufferView.length>0){const n=t.texturesToCreateFromBufferView.dequeue(),i=e.gltf,a=i.bufferViews[n.bufferView],r=i.textures[n.id].source,o=xe["a"].getFailedLoadFunction(e,"image",`id: ${n.id}, bufferView: ${n.bufferView}`);if("image/ktx2"===n.mimeType){const i=new Uint8Array(t.getBuffer(a));Object(j["a"])(i).then(et(e,n.id,r)).catch(o),++e._loadResources.pendingTextureLoads}else{const e=wt(t,n);Object(w["a"])({uint8Array:t.getBuffer(a),format:n.mimeType,flipY:!1,skipColorSpaceConversion:!0}).then(e).catch(o),++t.pendingBufferViewToImage}}}function Et(e){const t=e._loadResources;if(t.createSamplers){t.createSamplers=!1;const n=e._rendererResources.samplers;J["a"].sampler(e.gltf,(function(e,t){n[t]=new z["a"]({wrapS:e.wrapS,wrapT:e.wrapT,minificationFilter:e.minFilter,magnificationFilter:e.magFilter})}))}}const Mt=function(){this.gltfTexture=void 0,this.model=void 0,this.context=void 0};function vt(e,t,n){const i=t.gltf.textures,a=i[e.id],r=t._rendererResources.samplers;let o=r[a.sampler];Object(f["a"])(o)||(o=new z["a"]({wrapS:W["a"].REPEAT,wrapT:W["a"].REPEAT}));let s=!1;const c=t.gltf.materials,u=c.length;for(let y=0;y<u;++y){const t=c[y];if(Object(f["a"])(t.extensions)&&Object(f["a"])(t.extensions.KHR_techniques_webgl)){const n=t.extensions.KHR_techniques_webgl.values;for(const t in n)if(n.hasOwnProperty(t)&&-1!==t.indexOf("Texture")){const i=n[t];if(i.index===e.id&&Object(f["a"])(i.extensions)&&Object(f["a"])(i.extensions.KHR_texture_transform)){s=!0;break}}}if(s)break}const l=o.wrapS,d=o.wrapT;let h=o.minificationFilter;s&&h!==G["a"].LINEAR&&h!==G["a"].NEAREST&&(h=h===G["a"].NEAREST_MIPMAP_NEAREST||h===G["a"].NEAREST_MIPMAP_LINEAR?G["a"].NEAREST:G["a"].LINEAR,o=new z["a"]({wrapS:o.wrapS,wrapT:o.wrapT,minificationFilter:h,magnificationFilter:o.magnificationFilter}));const m=e.internalFormat,g=!(Object(f["a"])(m)&&T["a"].isCompressedFormat(m))&&(h===G["a"].NEAREST_MIPMAP_NEAREST||h===G["a"].NEAREST_MIPMAP_LINEAR||h===G["a"].LINEAR_MIPMAP_NEAREST||h===G["a"].LINEAR_MIPMAP_LINEAR),_=g||l===W["a"].REPEAT||l===W["a"].MIRRORED_REPEAT||d===W["a"].REPEAT||d===W["a"].MIRRORED_REPEAT;let p,b,x=e.image;if(Object(f["a"])(m)){p=!E["a"].isPowerOfTwo(e.width)||!E["a"].isPowerOfTwo(e.height),!n.webgl2&&T["a"].isCompressedFormat(m)&&p&&_&&console.warn("Compressed texture uses REPEAT or MIRRORED_REPEAT texture wrap mode and dimensions are not powers of two. The texture may be rendered incorrectly. See the Model.js constructor documentation for more information.");let t=o.minificationFilter;Object(f["a"])(e.mipLevels)||h!==G["a"].NEAREST_MIPMAP_NEAREST&&h!==G["a"].NEAREST_MIPMAP_LINEAR?Object(f["a"])(e.mipLevels)||h!==G["a"].LINEAR_MIPMAP_NEAREST&&h!==G["a"].LINEAR_MIPMAP_LINEAR||(t=G["a"].LINEAR):t=G["a"].NEAREST,o=new z["a"]({wrapS:o.wrapS,wrapT:o.wrapT,minificationFilter:t,magnificationFilter:o.magnificationFilter}),b=new H["a"]({context:n,source:{arrayBufferView:e.bufferView,mipLevels:e.mipLevels},width:e.width,height:e.height,pixelFormat:m,sampler:o})}else if(Object(f["a"])(x)){if(p=!E["a"].isPowerOfTwo(x.width)||!E["a"].isPowerOfTwo(x.height),_&&p){const e=document.createElement("canvas");e.width=E["a"].nextPowerOfTwo(x.width),e.height=E["a"].nextPowerOfTwo(x.height);const t=e.getContext("2d");t.drawImage(x,0,0,x.width,x.height,0,0,e.width,e.height),x=e}b=new H["a"]({context:n,source:x,pixelFormat:a.internalFormat,pixelDatatype:a.type,sampler:o,flipY:!1,skipColorSpaceConversion:!0}),g&&b.generateMipmap()}Object(f["a"])(b)&&(t._rendererResources.textures[e.id]=b,t._texturesByteLength+=b.sizeInBytes)}Mt.prototype.set=function(e,t,n){this.gltfTexture=e,this.model=t,this.context=n},Mt.prototype.execute=function(){vt(this.gltfTexture,this.model,this.context)};const Tt=new Mt;function Lt(e,t){const n=t.context,i=e._loadResources.texturesToCreate;if(e.asynchronous)while(i.length>0){if(Tt.set(i.peek(),e,n),!t.jobScheduler.execute(Tt,de["a"].TEXTURE))break;i.dequeue()}else while(i.length>0)vt(i.dequeue(),e,n)}function At(e,t){const n=e._sourceTechniques,i={};let a,r;const o=e._runtime.materialsById[t.material];if(!Object(f["a"])(o))return i;const s=n[o._technique];if(!Object(f["a"])(s))return i;const c=s.attributes,u=e._rendererResources.programs[s.program],l=u._attributeLocations;for(a in l)if(l.hasOwnProperty(a)){const e=c[a];Object(f["a"])(e)&&(r=l[a],i[e.semantic]=r)}const d=e._precreatedAttributes;if(Object(f["a"])(d))for(a in d)d.hasOwnProperty(a)&&(r=l[a],i[a]=r);return i}function Pt(e,t){const n=e.gltf,i=n.skins,a=n.nodes,r=e._runtime.nodes,o=e._loadResources.skinnedNodesIds,s=o.length;for(let c=0;c<s;++c){const e=o[c],n=r[e],s=a[e],u=t[s.skin];n.inverseBindMatrices=u.inverseBindMatrices,n.bindShapeMatrix=u.bindShapeMatrix;const l=i[s.skin].joints,d=l.length;for(let t=0;t<d;++t){const e=l[t],i=r[e];n.joints.push(i)}}}function Bt(e){const t=e._loadResources;if(0!==t.pendingBufferLoads)return;if(!t.createSkins)return;t.createSkins=!1;const n=e.gltf,i=n.accessors,a={};J["a"].skin(n,(function(t,n){const r=i[t.inverseBindMatrices];let o;v["a"].equals(t.bindShapeMatrix,v["a"].IDENTITY)||(o=v["a"].clone(t.bindShapeMatrix)),a[n]={inverseBindMatrices:he["a"].getSkinInverseBindMatrices(e,r),bindShapeMatrix:o}})),Pt(e,a)}function It(e,t,n,i){return function(a){Object(f["a"])(i)&&(a=e.clampAnimations?i.clampTime(a):i.wrapTime(a),t[n]=i.evaluate(a,t[n]),t.dirtyNumber=e._maxDirtyNumber)}}function Nt(e){const t=e._loadResources;if(!t.finishedPendingBufferLoads())return;if(!t.createRuntimeAnimations)return;t.createRuntimeAnimations=!1,e._runtime.animations=[];const n=e._runtime.nodes,i=e.gltf.accessors;J["a"].animation(e.gltf,(function(t,a){const r=t.channels,o=t.samplers;let s=Number.MAX_VALUE,c=-Number.MAX_VALUE;const u=r.length,l=new Array(u);for(let d=0;d<u;++d){const u=r[d],h=u.target,m=h.path,f=o[u.sampler],g=he["a"].getAnimationParameterValues(e,i[f.input]),_=he["a"].getAnimationParameterValues(e,i[f.output]);s=Math.min(s,g[0]),c=Math.max(c,g[g.length-1]);const p=he["a"].getAnimationSpline(e,a,t,u.sampler,f,g,m,_);l[d]=It(e,n[h.node],h.path,p)}e._runtime.animations[a]={name:t.name,startTime:s,stopTime:c,channelEvaluators:l}}))}function Dt(e,t){const n=e._loadResources;if(!n.finishedBuffersCreation()||!n.finishedProgramCreation()||!n.createVertexArrays)return;n.createVertexArrays=!1;const i=e._rendererResources.buffers,a=e._rendererResources.vertexArrays,r=e.gltf,o=r.accessors;J["a"].mesh(r,(function(n,s){J["a"].meshPrimitive(n,(function(n,c){const u=[];let l;const d=At(e,n),h=e._decodedData[`${s}.primitive.${c}`];let m,g;J["a"].meshPrimitiveAttribute(n,(function(e,t){if(l=d[t],Object(f["a"])(l)){if(Object(f["a"])(h)){const e=h.attributes;if(e.hasOwnProperty(t)){const n=e[t];return void u.push({index:l,vertexBuffer:i[n.bufferView],componentsPerAttribute:n.componentsPerAttribute,componentDatatype:n.componentDatatype,normalize:n.normalized,offsetInBytes:n.byteOffset,strideInBytes:n.byteStride})}}const n=o[e],a=Object(f["a"])(n.normalized)&&n.normalized;u.push({index:l,vertexBuffer:i[n.bufferView],componentsPerAttribute:Object(Q["a"])(n.type),componentDatatype:n.componentType,normalize:a,offsetInBytes:n.byteOffset,strideInBytes:Object(Y["a"])(r,n)})}}));const _=e._precreatedAttributes;if(Object(f["a"])(_))for(g in _)_.hasOwnProperty(g)&&(l=d[g],Object(f["a"])(l)&&(m=_[g],m.index=l,u.push(m)));let p;if(Object(f["a"])(n.indices)){const e=o[n.indices];let t=e.bufferView;Object(f["a"])(h)&&(t=h.bufferView),p=i[t]}a[`${s}.primitive.${c}`]=new K["a"]({context:t,attributes:u,indexBuffer:p})}))}))}function Ft(e){const t=e._loadResources;t.createRenderStates&&(t.createRenderStates=!1,J["a"].material(e.gltf,(function(t,n){Ut(e,t,n)})))}function Ut(e,t,n){const i=e._rendererResources.renderStates;let a=[I["a"].FUNC_ADD,I["a"].FUNC_ADD],r=[I["a"].ONE,I["a"].ONE_MINUS_SRC_ALPHA,I["a"].ONE,I["a"].ONE_MINUS_SRC_ALPHA];Object(f["a"])(t.extensions)&&Object(f["a"])(t.extensions.KHR_blend)&&(a=t.extensions.KHR_blend.blendEquation,r=t.extensions.KHR_blend.blendFactors);const o=!t.doubleSided,s="BLEND"===t.alphaMode;i[n]=k["a"].fromCache({cull:{enabled:o},depthTest:{enabled:!0,func:oe["a"].LESS_OR_EQUAL},depthMask:!s,blending:{enabled:s,equationRgb:a[0],equationAlpha:a[1],functionSourceRgb:r[0],functionDestinationRgb:r[1],functionSourceAlpha:r[2],functionDestinationAlpha:r[3]}})}const kt={MODEL:function(e,t,n){return function(){return n.computedMatrix}},VIEW:function(e,t,n){return function(){return e.view}},PROJECTION:function(e,t,n){return function(){return e.projection}},MODELVIEW:function(e,t,n){const i=new v["a"];return function(){return v["a"].multiplyTransformation(e.view,n.computedMatrix,i)}},CESIUM_RTC_MODELVIEW:function(e,t,n){const i=new v["a"];return function(){return v["a"].multiplyTransformation(e.view,n.computedMatrix,i),v["a"].setTranslation(i,t._rtcCenterEye,i)}},MODELVIEWPROJECTION:function(e,t,n){const i=new v["a"];return function(){return v["a"].multiplyTransformation(e.view,n.computedMatrix,i),v["a"].multiply(e._projection,i,i)}},MODELINVERSE:function(e,t,n){const i=new v["a"];return function(){return v["a"].inverse(n.computedMatrix,i)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,n){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,n){const i=new v["a"],a=new v["a"];return function(){return v["a"].multiplyTransformation(e.view,n.computedMatrix,i),v["a"].inverse(i,a)}},MODELVIEWPROJECTIONINVERSE:function(e,t,n){const i=new v["a"],a=new v["a"];return function(){return v["a"].multiplyTransformation(e.view,n.computedMatrix,i),v["a"].multiply(e._projection,i,i),v["a"].inverse(i,a)}},MODELINVERSETRANSPOSE:function(e,t,n){const i=new v["a"],a=new M["a"];return function(){return v["a"].inverse(n.computedMatrix,i),v["a"].getMatrix3(i,a),M["a"].transpose(a,a)}},MODELVIEWINVERSETRANSPOSE:function(e,t,n){const i=new v["a"],a=new v["a"],r=new M["a"];return function(){return v["a"].multiplyTransformation(e.view,n.computedMatrix,i),v["a"].inverse(i,a),v["a"].getMatrix3(a,r),M["a"].transpose(r,r)}},VIEWPORT:function(e,t,n){return function(){return e.viewportCartesian4}}};function zt(e,t,n,i){const a=t._runtime.nodes[e];return kt[n](i,t,a)}function Vt(e,t,n,i,a,r,o){const s={},c={};let u,l;return J["a"].techniqueUniform(n,(function(n,d){let m;if(Object(f["a"])(i)&&Object(f["a"])(i[d]))m=xe["a"].createUniformFunction(n.type,i[d],r,o),s[d]=m.func,c[d]=m;else if(Object(f["a"])(n.node))s[d]=zt(n.node,e,n.semantic,a.uniformState);else if(Object(f["a"])(n.semantic))if("JOINTMATRIX"===n.semantic)u=d;else if("MORPHWEIGHTS"===n.semantic)l=d;else if("ALPHACUTOFF"===n.semantic){const e=t.alphaMode;if(Object(f["a"])(e)&&"MASK"===e){const e=Object(h["a"])(t.alphaCutoff,.5);m=xe["a"].createUniformFunction(n.type,e,r,o),s[d]=m.func,c[d]=m}}else s[d]=xe["a"].getGltfSemanticUniforms()[n.semantic](a.uniformState,e);else if(Object(f["a"])(n.value)){const e=xe["a"].createUniformFunction(n.type,n.value,r,o);s[d]=e.func,c[d]=e}})),{map:s,values:c,jointMatrixUniformName:u,morphWeightsUniformName:l}}function qt(e,t){const n=e._loadResources;if(!n.finishedProgramCreation())return;if(!n.createUniformMaps)return;n.createUniformMaps=!1;const i=e.gltf,a=e._sourceTechniques,r=e._uniformMaps,o=e._rendererResources.textures,s=e._defaultTexture;J["a"].material(i,(function(n,i){const c=e._runtime.materialsById[i],u=a[c._technique],l=c._values,d=Vt(e,n,u,l,t,o,s),h=r[i];if(h.uniformMap=d.map,h.values=d.values,h.jointMatrixUniformName=d.jointMatrixUniformName,h.morphWeightsUniformName=d.morphWeightsUniformName,Object(f["a"])(u.attributes.a_outlineCoordinates)){const n=be["a"].createTexture(e,t);h.uniformMap.u_outlineTexture=function(){return n}}}))}function Ht(e){return xe["a"].createUniformsForDracoQuantizedAttributes(e.attributes)}function Gt(e,t){const n=gt(e,t),i=e._quantizedUniforms[n];return xe["a"].createUniformsForQuantizedAttributes(e.gltf,t,i)}function Wt(e){return function(){return e}}function Kt(e){return function(){return e.computedJointMatrices}}function Zt(e){return function(){return e.weights}}function $t(e){return function(){return e.silhouetteColor}}function Jt(e){return function(){return e.silhouetteSize}}function Yt(e){return function(){return e.color}}function Xt(e){return function(){return e._clippingPlanesMatrix}}function Qt(e){return function(){return e._iblReferenceFrameMatrix}}function en(e){return function(){const t=e.clippingPlanes;return Object(f["a"])(t)&&t.enabled?t.texture:e._defaultTexture}}function tn(e){return function(){const t=e.clippingPlanes;if(!Object(f["a"])(t))return c["a"].WHITE.withAlpha(0);const n=c["a"].clone(t.edgeColor);return n.alpha=t.edgeWidth,n}}function nn(e){return function(){return re["a"].getColorBlend(e.colorBlendMode,e.colorBlendAmount)}}function an(e){return function(){return e._imageBasedLighting.imageBasedLightingFactor}}function rn(e){return function(){return e._lightColor}}function on(e){return function(){return e._imageBasedLighting.luminanceAtZenith}}function sn(e){return function(){return e._imageBasedLighting.sphericalHarmonicCoefficients}}function cn(e){return function(){return e._imageBasedLighting.specularEnvironmentMapAtlas.texture}}function un(e){return function(){return e._imageBasedLighting.specularEnvironmentMapAtlas.texture.dimensions}}function ln(e){return function(){return e._imageBasedLighting.specularEnvironmentMapAtlas.maximumMipmapLevel}}function dn(e,t){switch(e.mode){case L["a"].TRIANGLES:return t/3;case L["a"].TRIANGLE_STRIP:case L["a"].TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function hn(e,t,n,r,o){const s=e._nodeCommands,c=e._pickIds,l=e.allowPicking,d=e._runtime.meshesByName,h=e._rendererResources,m=h.vertexArrays,g=h.programs,_=h.renderStates,p=e._uniformMaps,b=e.gltf,x=b.accessors,y=b.meshes,O=t.mesh,S=y[O],R=S.primitives,w=R.length;for(let j=0;j<w;++j){const t=R[j],h=x[t.indices],y=e._runtime.materialsById[t.material],w=y._program,E=e._decodedData[`${O}.primitive.${j}`];let M;const T=t.attributes.POSITION;if(Object(f["a"])(T)){const e=xe["a"].getAccessorMinMax(b,T);M=i["a"].fromCornerPoints(a["a"].fromArray(e.min),a["a"].fromArray(e.max))}const A=m[`${O}.primitive.${j}`];let P,B;if(Object(f["a"])(E))B=E.numberOfIndices,P=0;else if(Object(f["a"])(h))B=h.count,P=h.byteOffset/C["a"].getSizeInBytes(h.componentType);else{const e=x[t.attributes.POSITION];B=e.count,P=0}e._trianglesLength+=dn(t,B),t.mode===L["a"].POINTS&&(e._pointsLength+=B);const I=p[t.material];let N=I.uniformMap;if(Object(f["a"])(I.jointMatrixUniformName)){const e={};e[I.jointMatrixUniformName]=Kt(n),N=Object(u["a"])(N,e)}if(Object(f["a"])(I.morphWeightsUniformName)){const e={};e[I.morphWeightsUniformName]=Zt(n),N=Object(u["a"])(N,e)}N=Object(u["a"])(N,{gltf_color:Yt(e),gltf_colorBlend:nn(e),gltf_clippingPlanes:en(e),gltf_clippingPlanesEdgeStyle:tn(e),gltf_clippingPlanesMatrix:Xt(e),gltf_iblReferenceFrameMatrix:Qt(e),gltf_iblFactor:an(e),gltf_lightColor:rn(e),gltf_sphericalHarmonicCoefficients:sn(e),gltf_specularMap:cn(e),gltf_specularMapSize:un(e),gltf_maxSpecularLOD:ln(e),gltf_luminanceAtZenith:on(e)}),je["a"].addUniforms(e,N),Object(f["a"])(e._uniformMapLoaded)&&(N=e._uniformMapLoaded(N,w,n));let D={};e.extensionsUsed.WEB3D_quantized_attributes?D=Gt(e,t):e._dequantizeInShader&&Object(f["a"])(E)&&(D=Ht(E)),N=Object(u["a"])(N,D);const k=_[t.material],z=k.blending.enabled;let V=e._pickObject;Object(f["a"])(V)||(V={primitive:e,id:e.id,node:n.publicNode,mesh:d[S.name]});const q=Re["a"].castShadows(e._shadows),H=Re["a"].receiveShadows(e._shadows);let G;if(l&&!Object(f["a"])(e._uniformMapLoaded)){G=r.createPickId(V),c.push(G);const e={czm_pickColor:Wt(G.color)};N=Object(u["a"])(N,e)}l&&(G=Object(f["a"])(e._pickIdLoaded)&&Object(f["a"])(e._uniformMapLoaded)?e._pickIdLoaded():"czm_pickColor");const W=new F["a"]({boundingVolume:new i["a"],cull:e.cull,modelMatrix:new v["a"],primitiveType:t.mode,vertexArray:A,count:B,offset:P,shaderProgram:g[w],castShadows:q,receiveShadows:H,uniformMap:N,renderState:k,owner:V,pass:z?U["a"].TRANSLUCENT:e.opaquePass,pickId:G});let K;o||(K=F["a"].shallowClone(W),K.boundingVolume=new i["a"],K.modelMatrix=new v["a"]);const Z={show:!0,boundingSphere:M,command:W,command2D:K,silhouetteModelCommand:void 0,silhouetteModelCommand2D:void 0,silhouetteColorCommand:void 0,silhouetteColorCommand2D:void 0,translucentCommand:void 0,translucentCommand2D:void 0,disableCullingCommand:void 0,disableCullingCommand2D:void 0,programId:w};n.commands.push(Z),s.push(Z)}}function mn(e,t,n){const i=e._loadResources;if(!i.finishedEverythingButTextureCreation())return;if(!i.createRuntimeNodes)return;i.createRuntimeNodes=!1;const r=[],o=e._runtime.nodes,s=e.gltf,c=s.nodes,u=s.scenes[s.scene],l=u.nodes,d=l.length,h=[],m={};for(let g=0;g<d;++g){h.push({parentRuntimeNode:void 0,gltfNode:c[l[g]],id:l[g]});while(h.length>0){const i=h.pop();m[i.id]=!0;const s=i.parentRuntimeNode,u=i.gltfNode,l=o[i.id];if(0===l.parents.length)if(Object(f["a"])(u.matrix))l.matrix=v["a"].fromColumnMajorArray(u.matrix);else{const e=u.rotation;l.translation=a["a"].fromArray(u.translation),l.rotation=A["a"].unpack(e),l.scale=a["a"].fromArray(u.scale)}Object(f["a"])(s)?(s.children.push(l),l.parents.push(s)):r.push(l),Object(f["a"])(u.mesh)&&hn(e,u,l,t,n);const d=u.children;if(Object(f["a"])(d)){const e=d.length;for(let t=0;t<e;t++){const e=d[t];m[e]||h.push({parentRuntimeNode:l,gltfNode:c[e],id:d[t]})}}}}e._runtime.rootNodes=r,e._runtime.nodes=o}function fn(e){let t=0;for(const n in e)e.hasOwnProperty(n)&&(t+=e[n].sizeInBytes);return t}function gn(e){let t=0;for(const n in e)e.hasOwnProperty(n)&&(t+=e[n].sizeInBytes);return t}function _n(e,t){const n=t.context,i=t.scene3DOnly,a=e._quantizedVertexShaders,r=e._sourceTechniques,o=e._sourcePrograms,s=e._rendererResources;let c=s.sourceShaders;e._loadRendererResourcesFromCache&&(c=s.sourceShaders=e._cachedRendererResources.sourceShaders);for(const u in r)if(r.hasOwnProperty(u)){const t=r[u].program,i=o[t];let s=c[i.vertexShader];if(xe["a"].checkSupportedGlExtensions(i.glExtensions,n),e.extensionsUsed.WEB3D_quantized_attributes||e._dequantizeInShader){let n=a[t];Object(f["a"])(n)||(n=_t(s,t,e),a[t]=n),s=n}s=bt(s,t,e._vertexShaderLoaded)}if(e._loadRendererResourcesFromCache){const t=e._cachedRendererResources;s.buffers=t.buffers,s.vertexArrays=t.vertexArrays,s.programs=t.programs,s.silhouettePrograms=t.silhouettePrograms,s.textures=t.textures,s.samplers=t.samplers,s.renderStates=t.renderStates,Object(f["a"])(e._precreatedAttributes)&&Dt(e,n),e._cachedGeometryByteLength+=fn(t.buffers),e._cachedTexturesByteLength+=gn(t.textures)}else ft(e,t),Rt(e,t),Et(e,n),jt(e),Lt(e,t);Bt(e),Nt(e),e._loadRendererResourcesFromCache||(Dt(e,n),Ft(e)),qt(e,n),mn(e,n,i)}function pn(e,t){const n=e.publicNode,i=n.matrix;n.useMatrix&&Object(f["a"])(i)?v["a"].clone(i,t):Object(f["a"])(e.matrix)?v["a"].clone(e.matrix,t):(v["a"].fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t),n.setMatrix(t))}const bn=[],xn=new r["a"],yn=new v["a"];function On(e,t,n,o){const s=e._maxDirtyNumber,c=e._runtime.rootNodes,u=c.length,l=bn;let d=e._computedModelMatrix;if(e._mode!==Ce["a"].SCENE3D&&!e._ignoreCommands){const t=v["a"].getColumn(d,3,xn);if(r["a"].equals(t,r["a"].UNIT_W)){const t=e.boundingSphere.center,n=B["a"].wgs84To2DModelMatrix(o,t,yn);d=v["a"].multiply(n,d,yn),Object(f["a"])(e._rtcCenter)&&(v["a"].setTranslation(d,r["a"].UNIT_W,d),e._rtcCenter=e._rtcCenter2D)}else d=B["a"].basisTo2D(o,d,yn),e._rtcCenter=e._rtcCenter3D}for(let r=0;r<u;++r){let u=c[r];pn(u,u.transformToRoot),l.push(u);while(l.length>0){u=l.pop();const r=u.transformToRoot,c=u.commands;if(u.dirtyNumber===s||t||n){const t=v["a"].multiplyTransformation(d,r,u.computedMatrix),n=c.length;if(n>0)for(let r=0;r<n;++r){const n=c[r];let s=n.command;v["a"].clone(t,s.modelMatrix),i["a"].transform(n.boundingSphere,s.modelMatrix,s.boundingVolume),Object(f["a"])(e._rtcCenter)&&a["a"].add(e._rtcCenter,s.boundingVolume.center,s.boundingVolume.center),s=n.command2D,Object(f["a"])(s)&&e._mode===Ce["a"].SCENE2D&&(v["a"].clone(t,s.modelMatrix),s.modelMatrix[13]-=2*E["a"].sign(s.modelMatrix[13])*E["a"].PI*o.ellipsoid.maximumRadius,i["a"].transform(n.boundingSphere,s.modelMatrix,s.boundingVolume))}}const h=u.children;if(Object(f["a"])(h)){const e=h.length;for(let t=0;t<e;++t){const e=h[t];e.dirtyNumber=Math.max(e.dirtyNumber,u.dirtyNumber),(e.dirtyNumber===s||n)&&(pn(e,e.transformToRoot),v["a"].multiplyTransformation(r,e.transformToRoot,e.transformToRoot)),l.push(e)}}}}++e._maxDirtyNumber}let Sn=new v["a"];function Cn(e){const t=e._runtime.skinnedNodes,n=t.length;for(let i=0;i<n;++i){const e=t[i];Sn=v["a"].inverseTransformation(e.transformToRoot,Sn);const n=e.computedJointMatrices,a=e.joints,r=e.bindShapeMatrix,o=e.inverseBindMatrices,s=o.length;for(let t=0;t<s;++t)Object(f["a"])(n[t])||(n[t]=new v["a"]),n[t]=v["a"].multiplyTransformation(Sn,a[t].transformToRoot,n[t]),n[t]=v["a"].multiplyTransformation(n[t],o[t],n[t]),Object(f["a"])(r)&&(n[t]=v["a"].multiplyTransformation(n[t],r,n[t]))}}function Rn(e){const t=e._runtime.rootNodes,n=t.length,i=bn;for(let a=0;a<n;++a){let e=t[a];e.computedShow=e.publicNode.show,i.push(e);while(i.length>0){e=i.pop();const t=e.computedShow,n=e.commands,a=n.length;for(let e=0;e<a;++e)n[e].show=t;const r=e.children;if(Object(f["a"])(r)){const e=r.length;for(let n=0;n<e;++n){const e=r[n];e.computedShow=t&&e.publicNode.show,i.push(e)}}}}}function wn(e,t){const n=e.id;if(e._id!==n){e._id=n;const t=e._pickIds,i=t.length;for(let e=0;e<i;++e)t[e].object.id=n}}function jn(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;const t=e.debugWireframe?L["a"].LINES:L["a"].TRIANGLES,n=e._nodeCommands,i=n.length;for(let e=0;e<i;++e)n[e].command.primitiveType=t}}function En(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;const t=e.debugShowBoundingVolume,n=e._nodeCommands,i=n.length;for(let e=0;e<i;++e)n[e].command.debugShowBoundingVolume=t}}function Mn(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;const t=Re["a"].castShadows(e.shadows),n=Re["a"].receiveShadows(e.shadows),i=e._nodeCommands,a=i.length;for(let e=0;e<a;e++){const a=i[e];a.command.castShadows=t,a.command.receiveShadows=n}}}function vn(e,t){const n=Object(s["a"])(t,!0);return n.cull.enabled=!1,n.depthTest.enabled=!0,n.depthMask=!1,n.blending=ie["a"].ALPHA_BLEND,e.opaquePass===U["a"].CESIUM_3D_TILE&&(n.stencilTest=Ee["a"].setCesium3DTileBit(),n.stencilMask=Ee["a"].CESIUM_3D_TILE_MASK),k["a"].fromCache(n)}function Tn(e,t){const n=F["a"].shallowClone(t);return n.pass=U["a"].TRANSLUCENT,n.renderState=vn(e,t.renderState),n}function Ln(e,t,n){const i=t.scene3DOnly,a=e.color.alpha;if(a>0&&a<1){const t=e._nodeCommands,a=t.length;if(a>0&&(!Object(f["a"])(t[0].translucentCommand)||n))for(let n=0;n<a;++n){const a=t[n],r=a.command;if(a.translucentCommand=Tn(e,r),!i){const t=a.command2D;a.translucentCommand2D=Tn(e,t)}}}}function An(e){const t=Object(s["a"])(e,!0);return t.cull.enabled=!1,k["a"].fromCache(t)}function Pn(e){const t=F["a"].shallowClone(e);return t.renderState=An(e.renderState),t}function Bn(e,t,n){const i=t.scene3DOnly,a=e.backFaceCulling;if(!a){const t=e._nodeCommands,a=t.length;if(a>0&&(!Object(f["a"])(t[0].disableCullingCommand)||n))for(let e=0;e<a;++e){const n=t[e],a=n.command;if(n.disableCullingCommand=Pn(a),!i){const e=n.command2D;n.disableCullingCommand2D=Pn(e)}}}}function In(e,t){const n=e._rendererResources.programs;for(const i in n)if(n.hasOwnProperty(i)&&n[i]===t)return i}function Nn(e,t,n){let i=t.vertexShaderSource.sources[0];const a=t._attributeLocations,r=e._normalAttributeName;i=q["a"].replaceMain(i,"gltf_silhouette_main"),i+=`uniform float gltf_silhouetteSize; \nvoid main() \n{ \n    gltf_silhouette_main(); \n    vec3 n = normalize(czm_normal3D * ${r}); \n    n.x *= czm_projection[0][0]; \n    n.y *= czm_projection[1][1]; \n    vec4 clip = gl_Position; \n    clip.xy += n.xy * clip.w * gltf_silhouetteSize * czm_pixelRatio / czm_viewport.z; \n    gl_Position = clip; \n}`;const o="uniform vec4 gltf_silhouetteColor; \nvoid main() \n{ \n    gl_FragColor = czm_gammaCorrect(gltf_silhouetteColor); \n}";return V["a"].fromCache({context:n.context,vertexShaderSource:i,fragmentShaderSource:o,attributeLocations:a})}function Dn(e,t){return De(t.context)&&e.silhouetteSize>0&&e.silhouetteColor.alpha>0&&Object(f["a"])(e._normalAttributeName)}function Fn(e){const t=e._nodeCommands,n=t.length;for(let i=0;i<n;++i){const e=t[i],n=e.command;if(n.pass===U["a"].TRANSLUCENT)return!0}return!1}function Un(e){return e.color.alpha>0&&e.color.alpha<1}function kn(e){return 0===e.color.alpha}function zn(e,t){return Math.floor(e)!==Math.floor(t)||Math.ceil(e)!==Math.ceil(t)}let Vn=0;function qn(e,t){const n=++Vn%255,i=Fn(e)||Un(e)||e.silhouetteColor.alpha<1,a=e._rendererResources.silhouettePrograms,r=t.scene3DOnly,o=e._nodeCommands,c=o.length;for(let l=0;l<c;++l){const c=o[l],d=c.command,h=Un(e)?c.translucentCommand:d,m=F["a"].shallowClone(h);let g=Object(s["a"])(h.renderState);g.stencilTest={enabled:!0,frontFunction:I["a"].ALWAYS,backFunction:I["a"].ALWAYS,reference:n,mask:-1,frontOperation:{fail:I["a"].KEEP,zFail:I["a"].KEEP,zPass:I["a"].REPLACE},backOperation:{fail:I["a"].KEEP,zFail:I["a"].KEEP,zPass:I["a"].REPLACE}},kn(e)&&(g.colorMask={red:!1,green:!1,blue:!1,alpha:!1},g.depthMask=!1),g=k["a"].fromCache(g),m.renderState=g,c.silhouetteModelCommand=m;const _=F["a"].shallowClone(d);g=Object(s["a"])(d.renderState,!0),g.depthTest.enabled=!0,g.cull.enabled=!1,i&&(_.pass=U["a"].TRANSLUCENT,g.depthMask=!1,g.blending=ie["a"].ALPHA_BLEND),g.stencilTest={enabled:!0,frontFunction:I["a"].NOTEQUAL,backFunction:I["a"].NOTEQUAL,reference:n,mask:-1,frontOperation:{fail:I["a"].KEEP,zFail:I["a"].KEEP,zPass:I["a"].KEEP},backOperation:{fail:I["a"].KEEP,zFail:I["a"].KEEP,zPass:I["a"].KEEP}},g=k["a"].fromCache(g);const p=d.shaderProgram,b=In(e,p);let x=a[b];Object(f["a"])(x)||(x=Nn(e,p,t),a[b]=x);const y=Object(u["a"])(d.uniformMap,{gltf_silhouetteColor:$t(e),gltf_silhouetteSize:Jt(e)});if(_.renderState=g,_.shaderProgram=x,_.uniformMap=y,_.castShadows=!1,_.receiveShadows=!1,c.silhouetteColorCommand=_,!r){const e=c.command2D,t=F["a"].shallowClone(m);t.boundingVolume=e.boundingVolume,t.modelMatrix=e.modelMatrix,c.silhouetteModelCommand2D=t;const n=F["a"].shallowClone(_);t.boundingVolume=e.boundingVolume,t.modelMatrix=e.modelMatrix,c.silhouetteColorCommand2D=n}}}function Hn(e,t,n){return e=q["a"].replaceMain(e,"gltf_clip_main"),e+=Ne._getClippingFunction(t,n)+"\n",e+=`uniform highp sampler2D gltf_clippingPlanes; \nuniform mat4 gltf_clippingPlanesMatrix; \nuniform vec4 gltf_clippingPlanesEdgeStyle; \nvoid main() \n{ \n    gltf_clip_main(); \n${Object(ce["a"])("gltf_clippingPlanes","gltf_clippingPlanesMatrix","gltf_clippingPlanesEdgeStyle")}} \n`,e}function Gn(e,t,n){if(!Dn(e,t))return;const i=e._nodeCommands,a=i.length>0&&(zn(e.color.alpha,e._colorPreviousAlpha)||zn(e.silhouetteColor.alpha,e._silhouetteColorPreviousAlpha)||!Object(f["a"])(i[0].silhouetteModelCommand));e._colorPreviousAlpha=e.color.alpha,e._silhouetteColorPreviousAlpha=e.silhouetteColor.alpha,(a||n)&&qn(e,t)}function Wn(e,t){const n=e._clippingPlanes;Object(f["a"])(n)&&n.owner===e&&n.enabled&&n.update(t)}const Kn=new i["a"];function Zn(e,t,n){return Kn.center=e,Kn.radius=t,n.camera.getPixelSize(Kn,n.context.drawingBufferWidth,n.context.drawingBufferHeight)}const $n=new a["a"],Jn=new o["a"];function Yn(e,t){let n=e.scale;if(0!==e.minimumPixelSize){const i=t.context,r=Math.max(i.drawingBufferWidth,i.drawingBufferHeight),o=Object(f["a"])(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;if($n.x=o[12],$n.y=o[13],$n.z=o[14],Object(f["a"])(e._rtcCenter)&&a["a"].add(e._rtcCenter,$n,$n),e._mode!==Ce["a"].SCENE3D){const e=t.mapProjection,n=e.ellipsoid.cartesianToCartographic($n,Jn);e.project(n,$n),a["a"].fromElements($n.z,$n.x,$n.y,$n)}const s=e.boundingSphere.radius,c=Zn($n,s,t),u=1/c,l=Math.min(u*(2*s),r);l<e.minimumPixelSize&&(n=e.minimumPixelSize*c/(2*e._initialRadius))}return Object(f["a"])(e.maximumScale)?Math.min(e.maximumScale,n):n}function Xn(e){Object(f["a"])(e._cacheKey)&&Object(f["a"])(e._cachedGltf)&&0===--e._cachedGltf.count&&delete Be[e._cacheKey],e._cachedGltf=void 0}function Qn(e,t){this.buffers=void 0,this.vertexArrays=void 0,this.programs=void 0,this.sourceShaders=void 0,this.silhouettePrograms=void 0,this.textures=void 0,this.samplers=void 0,this.renderStates=void 0,this.ready=!1,this.context=e,this.cacheKey=t,this.count=0}function ei(e){for(const t in e)e.hasOwnProperty(t)&&e[t].destroy()}function ti(e){ei(e.buffers),ei(e.vertexArrays),ei(e.programs),ei(e.silhouettePrograms),ei(e.textures)}function ni(e,t,n){return function(i){if(e.heightReference===le["a"].RELATIVE_TO_GROUND){const e=t.cartesianToCartographic(i,Jn);e.height+=n.height,t.cartographicToCartesian(e,i)}const a=e._clampedModelMatrix;v["a"].clone(e.modelMatrix,a),a[12]=i.x,a[13]=i.y,a[14]=i.z,e._heightChanged=!0}}function ii(e){Object(f["a"])(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);const t=e._scene;if(!Object(f["a"])(t)||!Object(f["a"])(t.globe)||e.heightReference===le["a"].NONE)return void(e._clampedModelMatrix=void 0);const n=t.globe,i=n.ellipsoid,a=e.modelMatrix;$n.x=a[12],$n.y=a[13],$n.z=a[14];const r=i.cartesianToCartographic($n);Object(f["a"])(e._clampedModelMatrix)||(e._clampedModelMatrix=v["a"].clone(a,new v["a"]));const s=n._surface;e._removeUpdateHeightCallback=s.updateHeight(r,ni(e,i,r));const c=n.getHeight(r);if(Object(f["a"])(c)){const t=ni(e,i,r);o["a"].clone(r,Jn),Jn.height=c,i.cartographicToCartesian(Jn,$n),t($n)}}Qn.prototype.release=function(){if(0===--this.count)return Object(f["a"])(this.cacheKey)&&delete this.context.cache.modelRendererResourceCache[this.cacheKey],ti(this),Object(_["a"])(this)};const ai=new a["a"],ri=new o["a"];function oi(e,t){let n;const i=e.distanceDisplayCondition,r=i.near*i.near,o=i.far*i.far;if(t.mode===Ce["a"].SCENE2D){const e=t.camera.frustum.right-t.camera.frustum.left;n=.5*e,n*=n}else{let i=v["a"].getTranslation(e.modelMatrix,ai);if(t.mode===Ce["a"].COLUMBUS_VIEW){const e=t.mapProjection,n=e.ellipsoid,r=n.cartesianToCartographic(i,ri);i=e.project(r,i),a["a"].fromElements(i.z,i.x,i.y,i)}n=a["a"].distanceSquared(i,t.camera.positionWC)}return n>=r&&n<=o}const si=new v["a"],ci=new M["a"],ui=new v["a"];function li(e,t){e.programs!==t.programs&&ei(e.programs),e.silhouettePrograms!==t.silhouettePrograms&&ei(e.silhouettePrograms)}function di(e,t){const n=e._rendererResources,i=e._cachedRendererResources;let a;if(li(n,i),Ue(e)||Fe(e)||e.splitDirection!==we["a"].NONE||e._shouldRegenerateShaders){e._shouldRegenerateShaders=!1,n.programs={},n.silhouettePrograms={};const i={},r=e._sourceTechniques;let o;for(const n in r)r.hasOwnProperty(n)&&(o=r[n],a=o.program,i[a]||(i[a]=!0,Ot({programId:a,techniqueId:n},e,t.context)))}else n.programs=i.programs,n.silhouettePrograms=i.silhouettePrograms;const r=n.programs,o=e._nodeCommands,s=o.length;for(let c=0;c<s;++c){const e=o[c];a=e.programId;const t=r[a];e.command.shaderProgram=t,Object(f["a"])(e.command2D)&&(e.command2D.shaderProgram=t)}Ln(e,t,!0),Bn(e,t,!0),Gn(e,t,!0)}Ne.prototype.update=function(e){if(e.mode===Ce["a"].MORPHING)return;if(!b["a"].supportsWebP.initialized)return void b["a"].supportsWebP.initialize();const t=e.context;this._defaultTexture=t.defaultTexture;const n=b["a"].supportsWebP();if(this._state===ve.NEEDS_LOAD&&Object(f["a"])(this.gltf)){let n;const i=this.cacheKey;if(Object(f["a"])(i)){t.cache.modelRendererResourceCache=Object(h["a"])(t.cache.modelRendererResourceCache,{});const e=t.cache.modelRendererResourceCache;if(n=e[this.cacheKey],Object(f["a"])(n)){if(!n.ready)return;++n.count,this._loadRendererResourcesFromCache=!0}else n=new Qn(t,i),n.count=1,e[this.cacheKey]=n;this._cachedRendererResources=n}else n=new Qn(t),n.count=1,this._cachedRendererResources=n;if(this._state=ve.LOADING,this._state!==ve.FAILED){const t=this.gltf.extensions;if(Object(f["a"])(t)&&Object(f["a"])(t.CESIUM_RTC)){const n=a["a"].fromArray(t.CESIUM_RTC.center);if(!a["a"].equals(n,a["a"].ZERO)){this._rtcCenter3D=n;const t=e.mapProjection,i=t.ellipsoid,r=i.cartesianToCartographic(this._rtcCenter3D),o=t.project(r);a["a"].fromElements(o.z,o.x,o.y,o),this._rtcCenter2D=o,this._rtcCenterEye=new a["a"],this._rtcCenter=this._rtcCenter3D}}Object($["a"])(this.gltf),this._loadResources=new fe["a"],this._loadRendererResourcesFromCache||xe["a"].parseBuffers(this,Ke)}}const i=this._loadResources,r=this._incrementallyLoadTextures;let o=!1;if(this._state===ve.LOADING){if(0===i.pendingBufferLoads){if(!i.initialized){if(e.brdfLutGenerator.update(e),xe["a"].checkSupportedExtensions(this.extensionsRequired,n),xe["a"].updateForwardAxis(this),!Object(f["a"])(this.gltf.extras.sourceVersion)){const e=this.gltf;e.extras.sourceVersion=xe["a"].getAssetVersion(e),e.extras.sourceKHRTechniquesWebGL=Object(f["a"])(xe["a"].getUsedExtensions(e).KHR_techniques_webgl),this._sourceVersion=e.extras.sourceVersion,this._sourceKHRTechniquesWebGL=e.extras.sourceKHRTechniquesWebGL,Object(te["a"])(e),Object(Z["a"])(e);const t={addBatchIdToGeneratedShaders:this._addBatchIdToGeneratedShaders};Object(Oe["a"])(e,t),Object(Se["a"])(e,t)}this._sourceVersion=this.gltf.extras.sourceVersion,this._sourceKHRTechniquesWebGL=this.gltf.extras.sourceKHRTechniquesWebGL,this._dequantizeInShader=this._dequantizeInShader&&se["a"].hasExtension(this),We(this),Qe(this),$e(this),this._loadRendererResourcesFromCache||(Ze(this),Ye(this),Xe(this),nt(this,t,n)),rt(this),ot(this),at(this),st(this),se["a"].parse(this,t),i.initialized=!0}i.finishedDecoding()||se["a"].decodeModel(this,t).catch(xe["a"].getFailedLoadFunction(this,"model",this.basePath)),i.finishedDecoding()&&!i.resourcesParsed&&(this._boundingSphere=xe["a"].computeBoundingSphere(this),this._initialRadius=this._boundingSphere.radius,se["a"].cacheDataForModel(this),i.resourcesParsed=!0),i.resourcesParsed&&0===i.pendingShaderLoads&&(this.showOutline&&be["a"].outlinePrimitives(this),_n(this,e))}(i.finished()||r&&i.finishedEverythingButTextureCreation())&&(this._state=ve.LOADED,o=!0)}if(Object(f["a"])(i)&&this._state===ve.LOADED&&(r&&!o&&_n(this,e),i.finished())){this._loadResources=void 0;const e=this._rendererResources,t=this._cachedRendererResources;t.buffers=e.buffers,t.vertexArrays=e.vertexArrays,t.programs=e.programs,t.sourceShaders=e.sourceShaders,t.silhouettePrograms=e.silhouettePrograms,t.textures=e.textures,t.samplers=e.samplers,t.renderStates=e.renderStates,t.ready=!0,this._normalAttributeName=xe["a"].getAttributeOrUniformBySemantic(this.gltf,"NORMAL"),Object(f["a"])(this._precreatedAttributes)&&(t.vertexArrays={}),this.releaseGltfJson&&Xn(this)}const s=Dn(this,e),c=Un(this),u=kn(this),l=this.backFaceCulling,d=!Object(f["a"])(this.distanceDisplayCondition)||oi(this,e),m=this.show&&d&&0!==this.scale&&(!u||s);if(this._imageBasedLighting.update(e),m&&this._state===ve.LOADED||o){const n=this.activeAnimations.update(e)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=!1,this._dirty=!1;let i=this.modelMatrix;const a=e.mode!==this._mode;this._mode=e.mode;const r=!v["a"].equals(this._modelMatrix,i)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||0!==this.minimumPixelSize||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||a;if(r||o){v["a"].clone(i,this._modelMatrix),ii(this),Object(f["a"])(this._clampedModelMatrix)&&(i=this._clampedModelMatrix),this._scale=this.scale,this._minimumPixelSize=this.minimumPixelSize,this._maximumScale=this.maximumScale,this._heightReference=this.heightReference,this._heightChanged=!1;const t=Yn(this,e),n=this._computedModelMatrix;v["a"].multiplyByUniformScale(i,t,n),this._upAxis===ne["a"].Y?v["a"].multiplyTransformation(n,ne["a"].Y_UP_TO_Z_UP,n):this._upAxis===ne["a"].X&&v["a"].multiplyTransformation(n,ne["a"].X_UP_TO_Z_UP,n),this.forwardAxis===ne["a"].Z&&v["a"].multiplyTransformation(n,ne["a"].Z_UP_TO_X_UP,n)}(n||r||o)&&(On(this,r,o,e.mapProjection),this._dirty=!0,(n||o)&&Cn(this)),this._perNodeShowDirty&&(this._perNodeShowDirty=!1,Rn(this)),wn(this,t),jn(this),En(this),Mn(this),Wn(this,e);const s=this._clippingPlanes;let c=0;const u=Object(h["a"])(this.referenceMatrix,i);if(this._imageBasedLighting.useSphericalHarmonicCoefficients||this._imageBasedLighting.useSpecularEnvironmentMaps){let e=ci,n=si;n=v["a"].multiply(t.uniformState.view3D,u,n),e=v["a"].getMatrix3(n,e),e=M["a"].getRotation(e,e),this._iblReferenceFrameMatrix=M["a"].transpose(e,this._iblReferenceFrameMatrix)}if(this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._imageBasedLighting.shouldRegenerateShaders,Ue(this)){let e=ui;e=v["a"].multiply(t.uniformState.view3D,u,e),e=v["a"].multiply(e,s.modelMatrix,e),this._clippingPlanesMatrix=v["a"].inverseTranspose(e,this._clippingPlanesMatrix),c=s.clippingPlanesState}this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._clippingPlanesState!==c,this._clippingPlanesState=c;const l=Fe(this);l!==this._colorShadingEnabled&&(this._colorShadingEnabled=l,this._shouldRegenerateShaders=!0);const d=this.splitDirection!==we["a"].NONE;this._splittingEnabled!==d&&(this._splittingEnabled=d,this._shouldRegenerateShaders=!0),this._shouldRegenerateShaders?di(this,e):(Ln(this,e,!1),Bn(this,e,!1),Gn(this,e,!1))}if(o){const t=this;return void e.afterRender.push((function(){t._ready=!0,t._readyPromise.resolve(t)}))}if(m&&!this._ignoreCommands){const t=e.commandList,n=e.passes,i=this._nodeCommands,a=i.length;let r,o;const u=e.mapProjection.ellipsoid.maximumRadius*E["a"].PI;let d;if(n.render||n.pick&&this.allowPicking){for(r=0;r<a;++r)if(o=i[r],o.show){let n=o.command;if(s?n=o.silhouetteModelCommand:c?n=o.translucentCommand:l||(n=o.disableCullingCommand),t.push(n),d=o.command.boundingVolume,e.mode===Ce["a"].SCENE2D&&(d.center.y+d.radius>u||d.center.y-d.radius<u)){let e=o.command2D;s?e=o.silhouetteModelCommand2D:c?e=o.translucentCommand2D:l||(e=o.disableCullingCommand2D),t.push(e)}}if(s&&!n.pick)for(r=0;r<a;++r)o=i[r],o.show&&(t.push(o.silhouetteColorCommand),d=o.command.boundingVolume,e.mode===Ce["a"].SCENE2D&&(d.center.y+d.radius>u||d.center.y-d.radius<u)&&t.push(o.silhouetteColorCommand2D))}}const g=this._credit;Object(f["a"])(g)&&e.creditDisplay.addCredit(g);const _=this._resourceCredits,p=_.length;for(let a=0;a<p;a++)e.creditDisplay.addCredit(_[a]);const x=this._gltfCredits,y=x.length;for(let a=0;a<y;a++)e.creditDisplay.addCredit(x[a])},Ne.prototype.isDestroyed=function(){return!1},Ne.prototype.destroy=function(){Object(f["a"])(this._precreatedAttributes)&&ei(this._rendererResources.vertexArrays),Object(f["a"])(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),Object(f["a"])(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0),Object(f["a"])(this._cachedRendererResources)&&li(this._rendererResources,this._cachedRendererResources),this._rendererResources=void 0,this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release(),se["a"].destroyCachedDataForModel(this);const e=this._pickIds,t=e.length;for(let i=0;i<t;++i)e[i].destroy();Xn(this),this._quantizedVertexShaders=void 0;const n=this._clippingPlanes;return Object(f["a"])(n)&&!n.isDestroyed()&&n.owner===this&&n.destroy(),this._clippingPlanes=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,Object(_["a"])(this)},Ne._getClippingFunction=ue["a"],Ne._modifyShaderForColor=pt,t["a"]=Ne}}]);